<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Darknet: nightmare.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Darknet
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">nightmare.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../d9/d94/network_8h_source.html">network.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d36/parser_8h_source.html">parser.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/df1/blas_8h_source.html">blas.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../df/d08/region__layer_8h_source.html">region_layer.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for nightmare.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d7d/nightmare_8c__incl.png" border="0" usemap="#nightmare_8c" alt=""/></div>
<map name="nightmare_8c" id="nightmare_8c">
<area shape="rect" id="node2" href="../../d9/d94/network_8h.html" title="network.h" alt="" coords="404,152,483,177"/>
<area shape="rect" id="node19" href="../../d5/d36/parser_8h.html" title="parser.h" alt="" coords="337,79,407,104"/>
<area shape="rect" id="node20" href="../../d8/df1/blas_8h.html" title="blas.h" alt="" coords="659,79,716,104"/>
<area shape="rect" id="node21" href="../../d5/d60/utils_8h.html" title="utils.h" alt="" coords="681,225,737,251"/>
<area shape="rect" id="node23" href="../../df/d08/region__layer_8h.html" title="region_layer.h" alt="" coords="481,79,586,104"/>
<area shape="rect" id="node3" href="../../d5/db2/image_8h.html" title="image.h" alt="" coords="129,299,198,324"/>
<area shape="rect" id="node10" href="../../d3/d3b/layer_8h.html" title="layer.h" alt="" coords="501,225,562,251"/>
<area shape="rect" id="node14" href="../../d3/d09/tree_8h.html" title="tree.h" alt="" coords="417,299,473,324"/>
<area shape="rect" id="node15" href="../../d2/dbd/data_8h.html" title="data.h" alt="" coords="337,225,396,251"/>
<area shape="rect" id="node9" href="../../dc/d19/box_8h.html" title="box.h" alt="" coords="263,372,317,397"/>
<area shape="rect" id="node11" href="../../de/d92/activations_8h.html" title="activations.h" alt="" coords="663,299,758,324"/>
<area shape="rect" id="node12" href="../../dc/d57/cuda_8h.html" title="cuda.h" alt="" coords="680,372,741,397"/>
<area shape="rect" id="node17" href="../../dd/df4/matrix_8h.html" title="matrix.h" alt="" coords="223,299,291,324"/>
<area shape="rect" id="node18" href="../../da/d23/list_8h.html" title="list.h" alt="" coords="590,299,639,324"/>
</map>
</div>
</div>
<p><a href="../../dd/d03/nightmare_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7b31dd04a1194f79427ee06b8bd1498b"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d03/nightmare_8c.html#a7b31dd04a1194f79427ee06b8bd1498b">abs_mean</a> (float *x, int n)</td></tr>
<tr class="separator:a7b31dd04a1194f79427ee06b8bd1498b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a561eaf6bb47290c5cddb9ba6b5c66f48"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d03/nightmare_8c.html#a561eaf6bb47290c5cddb9ba6b5c66f48">calculate_loss</a> (float *output, float *delta, int n, float thresh)</td></tr>
<tr class="separator:a561eaf6bb47290c5cddb9ba6b5c66f48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fa2a59e61282c0b9a673497b0e5b1f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d03/nightmare_8c.html#a3fa2a59e61282c0b9a673497b0e5b1f0">optimize_picture</a> (<a class="el" href="../../de/d45/structnetwork.html">network</a> *net, <a class="el" href="../../de/d68/structimage.html">image</a> orig, int max_layer, float scale, float rate, float thresh, int norm)</td></tr>
<tr class="separator:a3fa2a59e61282c0b9a673497b0e5b1f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd159186e193428cba70578a92bafed2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d03/nightmare_8c.html#acd159186e193428cba70578a92bafed2">smooth</a> (<a class="el" href="../../de/d68/structimage.html">image</a> recon, <a class="el" href="../../de/d68/structimage.html">image</a> update, float lambda, int num)</td></tr>
<tr class="separator:acd159186e193428cba70578a92bafed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0ea896e371131528c89aa21d403d6ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d03/nightmare_8c.html#ad0ea896e371131528c89aa21d403d6ae">reconstruct_picture</a> (<a class="el" href="../../de/d45/structnetwork.html">network</a> net, float *features, <a class="el" href="../../de/d68/structimage.html">image</a> recon, <a class="el" href="../../de/d68/structimage.html">image</a> update, float rate, float momentum, float lambda, int smooth_size, int iters)</td></tr>
<tr class="separator:ad0ea896e371131528c89aa21d403d6ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaefb0ed0f5bd621bb9e131e2bc1b4852"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d03/nightmare_8c.html#aaefb0ed0f5bd621bb9e131e2bc1b4852">run_nightmare</a> (int argc, char **argv)</td></tr>
<tr class="separator:aaefb0ed0f5bd621bb9e131e2bc1b4852"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7b31dd04a1194f79427ee06b8bd1498b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b31dd04a1194f79427ee06b8bd1498b">&#9670;&nbsp;</a></span>abs_mean()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float abs_mean </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d03/nightmare_8c_source.html#l00009">9</a> of file <a class="el" href="../../dd/d03/nightmare_8c_source.html">nightmare.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordtype">float</span> sum = 0;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; n; ++i){</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        sum += fabs(x[i]);</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    }</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordflow">return</span> sum/n;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a561eaf6bb47290c5cddb9ba6b5c66f48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a561eaf6bb47290c5cddb9ba6b5c66f48">&#9670;&nbsp;</a></span>calculate_loss()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_loss </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>thresh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d03/nightmare_8c_source.html#l00019">19</a> of file <a class="el" href="../../dd/d03/nightmare_8c_source.html">nightmare.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d91/utils_8c_source.html#l00432">mean_array()</a>, and <a class="el" href="../../d3/d91/utils_8c_source.html#l00459">variance_array()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d03/nightmare_8c_source.html#l00030">optimize_picture()</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordtype">float</span> mean = <a class="code" href="../../d3/d91/utils_8c.html#a2098fae653a82f4bcc9c339229663285">mean_array</a>(output, n); </div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">float</span> var = <a class="code" href="../../d3/d91/utils_8c.html#acb8ffd5403deb84ad16360ab0bf87cfa">variance_array</a>(output, n);</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; n; ++i){</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="keywordflow">if</span>(delta[i] &gt; mean + thresh*sqrt(var)) delta[i] = output[i];</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="keywordflow">else</span> delta[i] = 0;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    }</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;}</div><div class="ttc" id="utils_8c_html_a2098fae653a82f4bcc9c339229663285"><div class="ttname"><a href="../../d3/d91/utils_8c.html#a2098fae653a82f4bcc9c339229663285">mean_array</a></div><div class="ttdeci">float mean_array(float *a, int n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00432">utils.c:432</a></div></div>
<div class="ttc" id="utils_8c_html_acb8ffd5403deb84ad16360ab0bf87cfa"><div class="ttname"><a href="../../d3/d91/utils_8c.html#acb8ffd5403deb84ad16360ab0bf87cfa">variance_array</a></div><div class="ttdeci">float variance_array(float *a, int n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00459">utils.c:459</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d03/nightmare_8c_a561eaf6bb47290c5cddb9ba6b5c66f48_cgraph.png" border="0" usemap="#dd/d03/nightmare_8c_a561eaf6bb47290c5cddb9ba6b5c66f48_cgraph" alt=""/></div>
<map name="dd/d03/nightmare_8c_a561eaf6bb47290c5cddb9ba6b5c66f48_cgraph" id="dd/d03/nightmare_8c_a561eaf6bb47290c5cddb9ba6b5c66f48_cgraph">
<area shape="rect" id="node2" href="../../d3/d91/utils_8c.html#a2098fae653a82f4bcc9c339229663285" title="mean_array" alt="" coords="316,5,408,31"/>
<area shape="rect" id="node4" href="../../d3/d91/utils_8c.html#acb8ffd5403deb84ad16360ab0bf87cfa" title="variance_array" alt="" coords="158,31,268,56"/>
<area shape="rect" id="node3" href="../../d3/d91/utils_8c.html#abedfeccc4fae6ebb143af6a646658b35" title="sum_array" alt="" coords="456,5,541,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d03/nightmare_8c_a561eaf6bb47290c5cddb9ba6b5c66f48_icgraph.png" border="0" usemap="#dd/d03/nightmare_8c_a561eaf6bb47290c5cddb9ba6b5c66f48_icgraph" alt=""/></div>
<map name="dd/d03/nightmare_8c_a561eaf6bb47290c5cddb9ba6b5c66f48_icgraph" id="dd/d03/nightmare_8c_a561eaf6bb47290c5cddb9ba6b5c66f48_icgraph">
<area shape="rect" id="node2" href="../../dd/d03/nightmare_8c.html#a3fa2a59e61282c0b9a673497b0e5b1f0" title="optimize_picture" alt="" coords="158,5,277,31"/>
<area shape="rect" id="node3" href="../../dd/d03/nightmare_8c.html#aaefb0ed0f5bd621bb9e131e2bc1b4852" title="run_nightmare" alt="" coords="325,5,432,31"/>
<area shape="rect" id="node4" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="480,5,530,31"/>
</map>
</div>

</div>
</div>
<a id="a3fa2a59e61282c0b9a673497b0e5b1f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fa2a59e61282c0b9a673497b0e5b1f0">&#9670;&nbsp;</a></span>optimize_picture()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void optimize_picture </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d45/structnetwork.html">network</a> *&#160;</td>
          <td class="paramname"><em>net</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d68/structimage.html">image</a>&#160;</td>
          <td class="paramname"><em>orig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>norm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d03/nightmare_8c_source.html#l00030">30</a> of file <a class="el" href="../../dd/d03/nightmare_8c_source.html">nightmare.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d50/blas_8c_source.html#l00146">axpy_cpu()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00222">backward_network()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00025">image::c</a>, <a class="el" href="../../dd/d03/nightmare_8c_source.html#l00019">calculate_loss()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00340">constrain_image()</a>, <a class="el" href="../../dc/d50/blas_8c_source.html#l00164">copy_cpu()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00741">crop_image()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00026">image::data</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00064">network::delta</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00162">layer::delta</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00262">flip_image()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00172">forward_network()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l01523">free_image()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00023">image::h</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00062">network::input</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00043">network::inputs</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00022">network::layers</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00636">make_image()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00015">network::n</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00499">normalize_array()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00163">layer::output</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00061">layer::outputs</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l01233">resize_image()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00299">resize_network()</a>, and <a class="el" href="../../d5/db2/image_8h_source.html#l00024">image::w</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d03/nightmare_8c_source.html#l00285">run_nightmare()</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">//scale_image(orig, 2);</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">//translate_image(orig, -1);</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    net-&gt;<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a> = max_layer + 1;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">int</span> dx = rand()%16 - 8;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">int</span> dy = rand()%16 - 8;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">int</span> flip = rand()%2;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="../../de/d68/structimage.html">image</a> crop = <a class="code" href="../../d3/d10/image_8c.html#ad323458860dbdb7a2af97b9b35ad91bf">crop_image</a>(orig, dx, dy, orig.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>, orig.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="../../de/d68/structimage.html">image</a> im = <a class="code" href="../../d3/d10/image_8c.html#a583d43a007a97bb92fcbac12b8394c72">resize_image</a>(crop, (<span class="keywordtype">int</span>)(orig.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a> * scale), (<span class="keywordtype">int</span>)(orig.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a> * scale));</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span>(flip) <a class="code" href="../../d3/d10/image_8c.html#ac226109dbae019db599ceb71d5f6aca8">flip_image</a>(im);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a6ae710d2d9ad32cfdec1f925f48c2b50">resize_network</a>(net, im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>, im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="../../d4/db8/structlayer.html">layer</a> last = net-&gt;<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[net-&gt;<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a>-1];</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">//net-&gt;layers[net-&gt;n - 1].activation = LINEAR;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="../../de/d68/structimage.html">image</a> delta = <a class="code" href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1">make_image</a>(im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>, im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>, im.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#ifdef GPU</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    net-&gt;delta_gpu = cuda_make_array(delta.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*im.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    cuda_push_array(net-&gt;input_gpu, im.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, net-&gt;<a class="code" href="../../de/d45/structnetwork.html#a529a36505548232d049abcb84fdcf389">inputs</a>);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    forward_network_gpu(*net);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    copy_ongpu(last.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>, last.output_gpu, 1, last.delta_gpu, 1);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    cuda_pull_array(last.delta_gpu, last.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, last.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="../../dd/d03/nightmare_8c.html#a561eaf6bb47290c5cddb9ba6b5c66f48">calculate_loss</a>(last.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, last.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, last.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>, thresh);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    cuda_push_array(last.delta_gpu, last.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, last.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    backward_network_gpu(*net);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    cuda_pull_array(net-&gt;delta_gpu, delta.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*im.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    cuda_free(net-&gt;delta_gpu);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    net-&gt;delta_gpu = 0;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    net-&gt;<a class="code" href="../../de/d45/structnetwork.html#a8f391155a3ceb60caf07d0ee6c6a93f2">input</a> = im.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    net-&gt;<a class="code" href="../../de/d45/structnetwork.html#a7787a7dde0eea2d91b208c23cdba6286">delta</a> = delta.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#affc7ba2c94d58f52043a19d4c8151daa">forward_network</a>(*net);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="../../dc/d50/blas_8c.html#a22f6b03dd54e2d4b249e53a0ca14434c">copy_cpu</a>(last.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>, last.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, 1, last.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, 1);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="../../dd/d03/nightmare_8c.html#a561eaf6bb47290c5cddb9ba6b5c66f48">calculate_loss</a>(last.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, last.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, last.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>, thresh);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#af218830ea9b2a8a582c3b362abc74ca4">backward_network</a>(*net);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">if</span>(flip) <a class="code" href="../../d3/d10/image_8c.html#ac226109dbae019db599ceb71d5f6aca8">flip_image</a>(delta);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">//normalize_array(delta.data, delta.w*delta.h*delta.c);</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="../../de/d68/structimage.html">image</a> resized = <a class="code" href="../../d3/d10/image_8c.html#a583d43a007a97bb92fcbac12b8394c72">resize_image</a>(delta, orig.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>, orig.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="../../de/d68/structimage.html">image</a> out = <a class="code" href="../../d3/d10/image_8c.html#ad323458860dbdb7a2af97b9b35ad91bf">crop_image</a>(resized, -dx, -dy, orig.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>, orig.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">       image g = grayscale_image(out);</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">       free_image(out);</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">       out = g;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">//rate = rate / abs_mean(out.data, out.w*out.h*out.c);</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span>(norm) <a class="code" href="../../d3/d91/utils_8c.html#af0d493fdef09c062d7c28c10401beed0">normalize_array</a>(out.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, out.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*out.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*out.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="../../dc/d50/blas_8c.html#a1af2064b6d091c8bf5565327745534fc">axpy_cpu</a>(orig.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*orig.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*orig.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>, rate, out.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, 1, orig.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, 1);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">       normalize_array(orig.data, orig.w*orig.h*orig.c);</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">       scale_image(orig, sqrt(var));</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">       translate_image(orig, mean);</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">//translate_image(orig, 1);</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">//scale_image(orig, .5);</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">//normalize_image(orig);</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="../../d3/d10/image_8c.html#ae8ec59e2e5d3166e688d80a0e2869e80">constrain_image</a>(orig);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(crop);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(im);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(delta);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(resized);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(out);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div><div class="ttc" id="image_8c_html_ae8ec59e2e5d3166e688d80a0e2869e80"><div class="ttname"><a href="../../d3/d10/image_8c.html#ae8ec59e2e5d3166e688d80a0e2869e80">constrain_image</a></div><div class="ttdeci">void constrain_image(image im)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00340">image.c:340</a></div></div>
<div class="ttc" id="network_8c_html_af218830ea9b2a8a582c3b362abc74ca4"><div class="ttname"><a href="../../d6/d6e/network_8c.html#af218830ea9b2a8a582c3b362abc74ca4">backward_network</a></div><div class="ttdeci">void backward_network(network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00222">network.c:222</a></div></div>
<div class="ttc" id="blas_8c_html_a1af2064b6d091c8bf5565327745534fc"><div class="ttname"><a href="../../dc/d50/blas_8c.html#a1af2064b6d091c8bf5565327745534fc">axpy_cpu</a></div><div class="ttdeci">void axpy_cpu(int N, float ALPHA, float *X, int INCX, float *Y, int INCY)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/blas_8c_source.html#l00146">blas.c:146</a></div></div>
<div class="ttc" id="network_8c_html_affc7ba2c94d58f52043a19d4c8151daa"><div class="ttname"><a href="../../d6/d6e/network_8c.html#affc7ba2c94d58f52043a19d4c8151daa">forward_network</a></div><div class="ttdeci">void forward_network(network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00172">network.c:172</a></div></div>
<div class="ttc" id="structimage_html"><div class="ttname"><a href="../../de/d68/structimage.html">image</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00022">image.h:22</a></div></div>
<div class="ttc" id="structnetwork_html_a7787a7dde0eea2d91b208c23cdba6286"><div class="ttname"><a href="../../de/d45/structnetwork.html#a7787a7dde0eea2d91b208c23cdba6286">network::delta</a></div><div class="ttdeci">float * delta</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00064">network.h:64</a></div></div>
<div class="ttc" id="structimage_html_a30e2caee481a59608823b3bcec8a139f"><div class="ttname"><a href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">image::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00023">image.h:23</a></div></div>
<div class="ttc" id="network_8c_html_a6ae710d2d9ad32cfdec1f925f48c2b50"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a6ae710d2d9ad32cfdec1f925f48c2b50">resize_network</a></div><div class="ttdeci">int resize_network(network *net, int w, int h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00299">network.c:299</a></div></div>
<div class="ttc" id="image_8c_html_ac226109dbae019db599ceb71d5f6aca8"><div class="ttname"><a href="../../d3/d10/image_8c.html#ac226109dbae019db599ceb71d5f6aca8">flip_image</a></div><div class="ttdeci">void flip_image(image a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00262">image.c:262</a></div></div>
<div class="ttc" id="image_8c_html_a726c30d7f0779c46f9ba5b8a3c2f94a1"><div class="ttname"><a href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1">make_image</a></div><div class="ttdeci">image make_image(int w, int h, int c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00636">image.c:636</a></div></div>
<div class="ttc" id="structnetwork_html_a9770423f88b722bafc9d1fd3c6091d75"><div class="ttname"><a href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">network::layers</a></div><div class="ttdeci">layer * layers</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00022">network.h:22</a></div></div>
<div class="ttc" id="structlayer_html_a1360cf3c28df067cc6f3af139fa95d3a"><div class="ttname"><a href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">layer::delta</a></div><div class="ttdeci">float * delta</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00162">layer.h:162</a></div></div>
<div class="ttc" id="image_8c_html_a1b35e408b961d58f7e29ec146be91160"><div class="ttname"><a href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a></div><div class="ttdeci">void free_image(image m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l01523">image.c:1523</a></div></div>
<div class="ttc" id="structlayer_html_a04d23c71428242b3153eda588f844eb3"><div class="ttname"><a href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">layer::output</a></div><div class="ttdeci">float * output</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00163">layer.h:163</a></div></div>
<div class="ttc" id="nightmare_8c_html_a561eaf6bb47290c5cddb9ba6b5c66f48"><div class="ttname"><a href="../../dd/d03/nightmare_8c.html#a561eaf6bb47290c5cddb9ba6b5c66f48">calculate_loss</a></div><div class="ttdeci">void calculate_loss(float *output, float *delta, int n, float thresh)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d03/nightmare_8c_source.html#l00019">nightmare.c:19</a></div></div>
<div class="ttc" id="structimage_html_aa67d2491c4d17dd240453d69dfc99482"><div class="ttname"><a href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">image::c</a></div><div class="ttdeci">int c</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00025">image.h:25</a></div></div>
<div class="ttc" id="structimage_html_aa6480e4024a0d5ca8d36b4145b3ceb43"><div class="ttname"><a href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">image::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00024">image.h:24</a></div></div>
<div class="ttc" id="image_8c_html_a583d43a007a97bb92fcbac12b8394c72"><div class="ttname"><a href="../../d3/d10/image_8c.html#a583d43a007a97bb92fcbac12b8394c72">resize_image</a></div><div class="ttdeci">image resize_image(image im, int w, int h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l01233">image.c:1233</a></div></div>
<div class="ttc" id="structnetwork_html_a8f391155a3ceb60caf07d0ee6c6a93f2"><div class="ttname"><a href="../../de/d45/structnetwork.html#a8f391155a3ceb60caf07d0ee6c6a93f2">network::input</a></div><div class="ttdeci">float * input</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00062">network.h:62</a></div></div>
<div class="ttc" id="utils_8c_html_af0d493fdef09c062d7c28c10401beed0"><div class="ttname"><a href="../../d3/d91/utils_8c.html#af0d493fdef09c062d7c28c10401beed0">normalize_array</a></div><div class="ttdeci">void normalize_array(float *a, int n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00499">utils.c:499</a></div></div>
<div class="ttc" id="blas_8c_html_a22f6b03dd54e2d4b249e53a0ca14434c"><div class="ttname"><a href="../../dc/d50/blas_8c.html#a22f6b03dd54e2d4b249e53a0ca14434c">copy_cpu</a></div><div class="ttdeci">void copy_cpu(int N, float *X, int INCX, float *Y, int INCY)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/blas_8c_source.html#l00164">blas.c:164</a></div></div>
<div class="ttc" id="structnetwork_html_a1c7625720955322d05924a075d013877"><div class="ttname"><a href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">network::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00015">network.h:15</a></div></div>
<div class="ttc" id="structlayer_html_a0874fab782ae0e8f1075cc99d776478b"><div class="ttname"><a href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">layer::outputs</a></div><div class="ttdeci">int outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00061">layer.h:61</a></div></div>
<div class="ttc" id="image_8c_html_ad323458860dbdb7a2af97b9b35ad91bf"><div class="ttname"><a href="../../d3/d10/image_8c.html#ad323458860dbdb7a2af97b9b35ad91bf">crop_image</a></div><div class="ttdeci">image crop_image(image im, int dx, int dy, int w, int h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00741">image.c:741</a></div></div>
<div class="ttc" id="structnetwork_html_a529a36505548232d049abcb84fdcf389"><div class="ttname"><a href="../../de/d45/structnetwork.html#a529a36505548232d049abcb84fdcf389">network::inputs</a></div><div class="ttdeci">int inputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00043">network.h:43</a></div></div>
<div class="ttc" id="structlayer_html"><div class="ttname"><a href="../../d4/db8/structlayer.html">layer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00045">layer.h:45</a></div></div>
<div class="ttc" id="structimage_html_aed7e0704080213b735419d6661251a0a"><div class="ttname"><a href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">image::data</a></div><div class="ttdeci">float * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00026">image.h:26</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d03/nightmare_8c_a3fa2a59e61282c0b9a673497b0e5b1f0_cgraph.png" border="0" usemap="#dd/d03/nightmare_8c_a3fa2a59e61282c0b9a673497b0e5b1f0_cgraph" alt=""/></div>
<map name="dd/d03/nightmare_8c_a3fa2a59e61282c0b9a673497b0e5b1f0_cgraph" id="dd/d03/nightmare_8c_a3fa2a59e61282c0b9a673497b0e5b1f0_cgraph">
<area shape="rect" id="node2" href="../../dc/d50/blas_8c.html#a1af2064b6d091c8bf5565327745534fc" title="axpy_cpu" alt="" coords="199,5,277,31"/>
<area shape="rect" id="node3" href="../../d6/d6e/network_8c.html#af218830ea9b2a8a582c3b362abc74ca4" title="backward_network" alt="" coords="172,55,304,80"/>
<area shape="rect" id="node4" href="../../dd/d03/nightmare_8c.html#a561eaf6bb47290c5cddb9ba6b5c66f48" title="calculate_loss" alt="" coords="185,153,291,179"/>
<area shape="rect" id="node8" href="../../d3/d10/image_8c.html#ae8ec59e2e5d3166e688d80a0e2869e80" title="constrain_image" alt="" coords="178,203,298,228"/>
<area shape="rect" id="node9" href="../../dc/d50/blas_8c.html#a22f6b03dd54e2d4b249e53a0ca14434c" title="copy_cpu" alt="" coords="199,252,277,277"/>
<area shape="rect" id="node10" href="../../d3/d10/image_8c.html#ad323458860dbdb7a2af97b9b35ad91bf" title="crop_image" alt="" coords="192,353,284,379"/>
<area shape="rect" id="node13" href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1" title="make_image" alt="" coords="379,255,477,280"/>
<area shape="rect" id="node16" href="../../d3/d10/image_8c.html#ac226109dbae019db599ceb71d5f6aca8" title="flip_image" alt="" coords="197,504,279,529"/>
<area shape="rect" id="node17" href="../../d6/d6e/network_8c.html#affc7ba2c94d58f52043a19d4c8151daa" title="forward_network" alt="" coords="178,553,298,579"/>
<area shape="rect" id="node20" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160" title="free_image" alt="" coords="384,501,472,527"/>
<area shape="rect" id="node21" href="../../d3/d91/utils_8c.html#af0d493fdef09c062d7c28c10401beed0" title="normalize_array" alt="" coords="180,104,296,129"/>
<area shape="rect" id="node22" href="../../d3/d10/image_8c.html#a583d43a007a97bb92fcbac12b8394c72" title="resize_image" alt="" coords="188,403,288,428"/>
<area shape="rect" id="node24" href="../../d6/d6e/network_8c.html#a6ae710d2d9ad32cfdec1f925f48c2b50" title="resize_network" alt="" coords="182,897,294,923"/>
<area shape="rect" id="node5" href="../../d3/d91/utils_8c.html#a2098fae653a82f4bcc9c339229663285" title="mean_array" alt="" coords="589,129,682,155"/>
<area shape="rect" id="node7" href="../../d3/d91/utils_8c.html#acb8ffd5403deb84ad16360ab0bf87cfa" title="variance_array" alt="" coords="373,129,483,155"/>
<area shape="rect" id="node6" href="../../d3/d91/utils_8c.html#abedfeccc4fae6ebb143af6a646658b35" title="sum_array" alt="" coords="768,129,852,155"/>
<area shape="rect" id="node11" href="../../d3/d91/utils_8c.html#a5402a85f04198ed74b0ac1172b673a14" title="constrain_int" alt="" coords="379,304,476,329"/>
<area shape="rect" id="node12" href="../../d3/d10/image_8c.html#ab2ddb4ea0bc935f26ce71a731a3241d9" title="get_pixel" alt="" coords="390,353,465,379"/>
<area shape="rect" id="node15" href="../../d3/d10/image_8c.html#a566c2d016eb920d2fee7d3bb055a720b" title="set_pixel" alt="" coords="391,403,465,428"/>
<area shape="rect" id="node14" href="../../d3/d10/image_8c.html#a28bb9f835989b2f7e908386421c52837" title="make_empty_image" alt="" coords="565,255,706,280"/>
<area shape="rect" id="node18" href="../../d6/d6e/network_8c.html#a580b7921ad9619b4b41009bcdc486e1c" title="calc_network_cost" alt="" coords="362,551,493,576"/>
<area shape="rect" id="node19" href="../../dc/d50/blas_8c.html#a0e56f560dd08e165d6b5439ce93c7859" title="fill_cpu" alt="" coords="396,600,459,625"/>
<area shape="rect" id="node23" href="../../d3/d10/image_8c.html#a0f7cf32ab3f9dfa21ac055a467c7c1fb" title="add_pixel" alt="" coords="389,452,467,477"/>
<area shape="rect" id="node25" href="../../d3/d91/utils_8c.html#a6c317cffefb9737fb2260da73688f275" title="error" alt="" coords="403,649,453,675"/>
<area shape="rect" id="node26" href="../../d6/d6e/network_8c.html#ae04b6dc422751023fd98b9cca4dce93e" title="get_network_output\l_layer" alt="" coords="359,699,497,737"/>
<area shape="rect" id="node27" href="../../d3/db0/avgpool__layer_8c.html#aa34eb4c52cfe95d539cbbcdd37e4d711" title="resize_avgpool_layer" alt="" coords="354,761,501,787"/>
<area shape="rect" id="node28" href="../../d8/de4/convolutional__layer_8c.html#ab4e8bb8b50e2058d861892bed77238de" title="resize_convolutional\l_layer" alt="" coords="357,811,499,849"/>
<area shape="rect" id="node32" href="../../df/dfc/cost__layer_8c.html#aa47c87d0d7e2b9f5be07ee2962698483" title="resize_cost_layer" alt="" coords="365,873,490,899"/>
<area shape="rect" id="node33" href="../../d4/da6/crop__layer_8c.html#a7ff2df8313ba1720524d0ea88bafb0d7" title="resize_crop_layer" alt="" coords="364,923,491,948"/>
<area shape="rect" id="node34" href="../../dc/dcd/maxpool__layer_8c.html#a46551094c5c40c7e88aec13f5dbd80e8" title="resize_maxpool_layer" alt="" coords="352,972,503,997"/>
<area shape="rect" id="node35" href="../../d7/d0a/normalization__layer_8c.html#ae1d304da9d6dc40df88bbc0126adaa29" title="resize_normalization\l_layer" alt="" coords="356,1021,500,1060"/>
<area shape="rect" id="node36" href="../../d3/d74/region__layer_8c.html#a882147a796b341f5ec5989f0e71b7797" title="resize_region_layer" alt="" coords="359,1084,497,1109"/>
<area shape="rect" id="node37" href="../../d9/d30/reorg__layer_8c.html#a20ccb8cc9b99dbc11971376d960880ed" title="resize_reorg_layer" alt="" coords="362,1133,494,1159"/>
<area shape="rect" id="node38" href="../../d7/d1d/route__layer_8c.html#a2a40d999a04e0a45314f3ddcb1f0eb92" title="resize_route_layer" alt="" coords="362,1183,493,1208"/>
<area shape="rect" id="node29" href="../../d8/de4/convolutional__layer_8c.html#a4e3f4ec3fb327f0072ae7feec101e20d" title="convolutional_out_height" alt="" coords="551,768,720,793"/>
<area shape="rect" id="node30" href="../../d8/de4/convolutional__layer_8c.html#a8dd3db32f1bca91f42f9b755ab05810a" title="convolutional_out_width" alt="" coords="554,817,718,843"/>
<area shape="rect" id="node31" href="../../d8/de4/convolutional__layer_8c.html#a563ec10207abd4e18c926daafe00d97c" title="get_workspace_size" alt="" coords="565,867,707,892"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d03/nightmare_8c_a3fa2a59e61282c0b9a673497b0e5b1f0_icgraph.png" border="0" usemap="#dd/d03/nightmare_8c_a3fa2a59e61282c0b9a673497b0e5b1f0_icgraph" alt=""/></div>
<map name="dd/d03/nightmare_8c_a3fa2a59e61282c0b9a673497b0e5b1f0_icgraph" id="dd/d03/nightmare_8c_a3fa2a59e61282c0b9a673497b0e5b1f0_icgraph">
<area shape="rect" id="node2" href="../../dd/d03/nightmare_8c.html#aaefb0ed0f5bd621bb9e131e2bc1b4852" title="run_nightmare" alt="" coords="172,5,279,31"/>
<area shape="rect" id="node3" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="327,5,377,31"/>
</map>
</div>

</div>
</div>
<a id="ad0ea896e371131528c89aa21d403d6ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0ea896e371131528c89aa21d403d6ae">&#9670;&nbsp;</a></span>reconstruct_picture()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reconstruct_picture </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d45/structnetwork.html">network</a>&#160;</td>
          <td class="paramname"><em>net</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d68/structimage.html">image</a>&#160;</td>
          <td class="paramname"><em>recon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d68/structimage.html">image</a>&#160;</td>
          <td class="paramname"><em>update</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>momentum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>smooth_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d03/nightmare_8c_source.html#l00132">132</a> of file <a class="el" href="../../dd/d03/nightmare_8c_source.html">nightmare.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d50/blas_8c_source.html#l00146">axpy_cpu()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00222">backward_network()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00025">image::c</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00340">constrain_image()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00026">image::data</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00064">network::delta</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00172">forward_network()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l01523">free_image()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00550">get_network_output_layer()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00023">image::h</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00062">network::input</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00519">mag_array()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00636">make_image()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00061">layer::outputs</a>, <a class="el" href="../../dc/d50/blas_8c_source.html#l00152">scal_cpu()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00063">network::truth</a>, and <a class="el" href="../../d5/db2/image_8h_source.html#l00024">image::w</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d03/nightmare_8c_source.html#l00285">run_nightmare()</a>.</p>
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">int</span> iter = 0;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="../../d4/db8/structlayer.html">layer</a> l = <a class="code" href="../../d6/d6e/network_8c.html#ae04b6dc422751023fd98b9cca4dce93e">get_network_output_layer</a>(net);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">for</span> (iter = 0; iter &lt; iters; ++iter) {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <a class="code" href="../../de/d68/structimage.html">image</a> delta = <a class="code" href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1">make_image</a>(recon.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>, recon.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>, recon.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#ifdef GPU</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        cuda_push_array(net.input_gpu, recon.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, recon.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*recon.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*recon.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">//cuda_push_array(net.truth_gpu, features, net.truths);</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        net.delta_gpu = cuda_make_array(delta.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, delta.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*delta.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*delta.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        forward_network_gpu(net);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        cuda_push_array(l.delta_gpu, features, l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        axpy_ongpu(l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>, -1, l.output_gpu, 1, l.delta_gpu, 1);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        backward_network_gpu(net);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        cuda_pull_array(net.delta_gpu, delta.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, delta.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*delta.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*delta.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        cuda_free(net.delta_gpu);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        net.<a class="code" href="../../de/d45/structnetwork.html#a8f391155a3ceb60caf07d0ee6c6a93f2">input</a> = recon.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        net.<a class="code" href="../../de/d45/structnetwork.html#a7787a7dde0eea2d91b208c23cdba6286">delta</a> = delta.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a> = features;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="../../d6/d6e/network_8c.html#affc7ba2c94d58f52043a19d4c8151daa">forward_network</a>(net);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="../../d6/d6e/network_8c.html#af218830ea9b2a8a582c3b362abc74ca4">backward_network</a>(net);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="comment">//normalize_array(delta.data, delta.w*delta.h*delta.c);</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="../../dc/d50/blas_8c.html#a1af2064b6d091c8bf5565327745534fc">axpy_cpu</a>(recon.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*recon.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*recon.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>, 1, delta.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, 1, update.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, 1);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="comment">//smooth(recon, update, lambda, smooth_size);</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="../../dc/d50/blas_8c.html#a1af2064b6d091c8bf5565327745534fc">axpy_cpu</a>(recon.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*recon.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*recon.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>, rate, update.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, 1, recon.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, 1);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="../../dc/d50/blas_8c.html#a34c9f6d7710be70c85c343b9840981d8">scal_cpu</a>(recon.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*recon.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*recon.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>, momentum, update.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, 1);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordtype">float</span> mag = <a class="code" href="../../d3/d91/utils_8c.html#ab29ce45fa5e3847d0125e2e7f2e2cb44">mag_array</a>(delta.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>, recon.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*recon.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*recon.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        printf(<span class="stringliteral">&quot;mag: %f\n&quot;</span>, mag);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="comment">//scal_cpu(recon.w*recon.h*recon.c, 600/mag, recon.data, 1);</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#ae8ec59e2e5d3166e688d80a0e2869e80">constrain_image</a>(recon);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(delta);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div><div class="ttc" id="image_8c_html_ae8ec59e2e5d3166e688d80a0e2869e80"><div class="ttname"><a href="../../d3/d10/image_8c.html#ae8ec59e2e5d3166e688d80a0e2869e80">constrain_image</a></div><div class="ttdeci">void constrain_image(image im)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00340">image.c:340</a></div></div>
<div class="ttc" id="network_8c_html_af218830ea9b2a8a582c3b362abc74ca4"><div class="ttname"><a href="../../d6/d6e/network_8c.html#af218830ea9b2a8a582c3b362abc74ca4">backward_network</a></div><div class="ttdeci">void backward_network(network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00222">network.c:222</a></div></div>
<div class="ttc" id="blas_8c_html_a1af2064b6d091c8bf5565327745534fc"><div class="ttname"><a href="../../dc/d50/blas_8c.html#a1af2064b6d091c8bf5565327745534fc">axpy_cpu</a></div><div class="ttdeci">void axpy_cpu(int N, float ALPHA, float *X, int INCX, float *Y, int INCY)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/blas_8c_source.html#l00146">blas.c:146</a></div></div>
<div class="ttc" id="network_8c_html_affc7ba2c94d58f52043a19d4c8151daa"><div class="ttname"><a href="../../d6/d6e/network_8c.html#affc7ba2c94d58f52043a19d4c8151daa">forward_network</a></div><div class="ttdeci">void forward_network(network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00172">network.c:172</a></div></div>
<div class="ttc" id="structnetwork_html_a1453c2cf9a735bde55a281d698797a05"><div class="ttname"><a href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">network::truth</a></div><div class="ttdeci">float * truth</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00063">network.h:63</a></div></div>
<div class="ttc" id="blas_8c_html_a34c9f6d7710be70c85c343b9840981d8"><div class="ttname"><a href="../../dc/d50/blas_8c.html#a34c9f6d7710be70c85c343b9840981d8">scal_cpu</a></div><div class="ttdeci">void scal_cpu(int N, float ALPHA, float *X, int INCX)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/blas_8c_source.html#l00152">blas.c:152</a></div></div>
<div class="ttc" id="structimage_html"><div class="ttname"><a href="../../de/d68/structimage.html">image</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00022">image.h:22</a></div></div>
<div class="ttc" id="structnetwork_html_a7787a7dde0eea2d91b208c23cdba6286"><div class="ttname"><a href="../../de/d45/structnetwork.html#a7787a7dde0eea2d91b208c23cdba6286">network::delta</a></div><div class="ttdeci">float * delta</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00064">network.h:64</a></div></div>
<div class="ttc" id="structimage_html_a30e2caee481a59608823b3bcec8a139f"><div class="ttname"><a href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">image::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00023">image.h:23</a></div></div>
<div class="ttc" id="image_8c_html_a726c30d7f0779c46f9ba5b8a3c2f94a1"><div class="ttname"><a href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1">make_image</a></div><div class="ttdeci">image make_image(int w, int h, int c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00636">image.c:636</a></div></div>
<div class="ttc" id="network_8c_html_ae04b6dc422751023fd98b9cca4dce93e"><div class="ttname"><a href="../../d6/d6e/network_8c.html#ae04b6dc422751023fd98b9cca4dce93e">get_network_output_layer</a></div><div class="ttdeci">layer get_network_output_layer(network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00550">network.c:550</a></div></div>
<div class="ttc" id="image_8c_html_a1b35e408b961d58f7e29ec146be91160"><div class="ttname"><a href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a></div><div class="ttdeci">void free_image(image m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l01523">image.c:1523</a></div></div>
<div class="ttc" id="structimage_html_aa67d2491c4d17dd240453d69dfc99482"><div class="ttname"><a href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">image::c</a></div><div class="ttdeci">int c</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00025">image.h:25</a></div></div>
<div class="ttc" id="structimage_html_aa6480e4024a0d5ca8d36b4145b3ceb43"><div class="ttname"><a href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">image::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00024">image.h:24</a></div></div>
<div class="ttc" id="structnetwork_html_a8f391155a3ceb60caf07d0ee6c6a93f2"><div class="ttname"><a href="../../de/d45/structnetwork.html#a8f391155a3ceb60caf07d0ee6c6a93f2">network::input</a></div><div class="ttdeci">float * input</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00062">network.h:62</a></div></div>
<div class="ttc" id="utils_8c_html_ab29ce45fa5e3847d0125e2e7f2e2cb44"><div class="ttname"><a href="../../d3/d91/utils_8c.html#ab29ce45fa5e3847d0125e2e7f2e2cb44">mag_array</a></div><div class="ttdeci">float mag_array(float *a, int n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00519">utils.c:519</a></div></div>
<div class="ttc" id="structlayer_html_a0874fab782ae0e8f1075cc99d776478b"><div class="ttname"><a href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">layer::outputs</a></div><div class="ttdeci">int outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00061">layer.h:61</a></div></div>
<div class="ttc" id="structlayer_html"><div class="ttname"><a href="../../d4/db8/structlayer.html">layer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00045">layer.h:45</a></div></div>
<div class="ttc" id="structimage_html_aed7e0704080213b735419d6661251a0a"><div class="ttname"><a href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">image::data</a></div><div class="ttdeci">float * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00026">image.h:26</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d03/nightmare_8c_ad0ea896e371131528c89aa21d403d6ae_cgraph.png" border="0" usemap="#dd/d03/nightmare_8c_ad0ea896e371131528c89aa21d403d6ae_cgraph" alt=""/></div>
<map name="dd/d03/nightmare_8c_ad0ea896e371131528c89aa21d403d6ae_cgraph" id="dd/d03/nightmare_8c_ad0ea896e371131528c89aa21d403d6ae_cgraph">
<area shape="rect" id="node2" href="../../dc/d50/blas_8c.html#a1af2064b6d091c8bf5565327745534fc" title="axpy_cpu" alt="" coords="218,5,296,31"/>
<area shape="rect" id="node3" href="../../d6/d6e/network_8c.html#af218830ea9b2a8a582c3b362abc74ca4" title="backward_network" alt="" coords="191,55,324,80"/>
<area shape="rect" id="node4" href="../../d3/d10/image_8c.html#ae8ec59e2e5d3166e688d80a0e2869e80" title="constrain_image" alt="" coords="198,104,317,129"/>
<area shape="rect" id="node5" href="../../d6/d6e/network_8c.html#affc7ba2c94d58f52043a19d4c8151daa" title="forward_network" alt="" coords="197,153,317,179"/>
<area shape="rect" id="node8" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160" title="free_image" alt="" coords="213,203,301,228"/>
<area shape="rect" id="node9" href="../../d6/d6e/network_8c.html#ae04b6dc422751023fd98b9cca4dce93e" title="get_network_output\l_layer" alt="" coords="188,252,327,291"/>
<area shape="rect" id="node10" href="../../d3/d91/utils_8c.html#ab29ce45fa5e3847d0125e2e7f2e2cb44" title="mag_array" alt="" coords="215,315,300,340"/>
<area shape="rect" id="node11" href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1" title="make_image" alt="" coords="208,364,306,389"/>
<area shape="rect" id="node13" href="../../dc/d50/blas_8c.html#a34c9f6d7710be70c85c343b9840981d8" title="scal_cpu" alt="" coords="220,413,294,439"/>
<area shape="rect" id="node6" href="../../d6/d6e/network_8c.html#a580b7921ad9619b4b41009bcdc486e1c" title="calc_network_cost" alt="" coords="380,129,511,155"/>
<area shape="rect" id="node7" href="../../dc/d50/blas_8c.html#a0e56f560dd08e165d6b5439ce93c7859" title="fill_cpu" alt="" coords="414,179,477,204"/>
<area shape="rect" id="node12" href="../../d3/d10/image_8c.html#a28bb9f835989b2f7e908386421c52837" title="make_empty_image" alt="" coords="375,364,516,389"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d03/nightmare_8c_ad0ea896e371131528c89aa21d403d6ae_icgraph.png" border="0" usemap="#dd/d03/nightmare_8c_ad0ea896e371131528c89aa21d403d6ae_icgraph" alt=""/></div>
<map name="dd/d03/nightmare_8c_ad0ea896e371131528c89aa21d403d6ae_icgraph" id="dd/d03/nightmare_8c_ad0ea896e371131528c89aa21d403d6ae_icgraph">
<area shape="rect" id="node2" href="../../dd/d03/nightmare_8c.html#aaefb0ed0f5bd621bb9e131e2bc1b4852" title="run_nightmare" alt="" coords="188,5,295,31"/>
<area shape="rect" id="node3" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="343,5,394,31"/>
</map>
</div>

</div>
</div>
<a id="aaefb0ed0f5bd621bb9e131e2bc1b4852"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaefb0ed0f5bd621bb9e131e2bc1b4852">&#9670;&nbsp;</a></span>run_nightmare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void run_nightmare </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d03/nightmare_8c_source.html#l00285">285</a> of file <a class="el" href="../../dd/d03/nightmare_8c_source.html">nightmare.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d91/utils_8c_source.html#l00139">basecfg()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00025">image::c</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00403">copy_image()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00741">crop_image()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00026">image::data</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00080">find_arg()</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00123">find_char_arg()</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00108">find_float_arg()</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00093">find_int_arg()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l01523">free_image()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00398">get_network_image()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l01079">grayscale_image()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00023">image::h</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00047">network::h</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00022">network::layers</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00844">letterbox_image()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l01368">load_image_color()</a>, <a class="el" href="../../d2/d72/parser_8c_source.html#l01127">load_weights()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00636">make_image()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00015">network::n</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00429">network_predict()</a>, <a class="el" href="../../dd/d03/nightmare_8c_source.html#l00030">optimize_picture()</a>, <a class="el" href="../../d2/d72/parser_8c_source.html#l00618">parse_network_cfg()</a>, <a class="el" href="../../dd/d03/nightmare_8c_source.html#l00132">reconstruct_picture()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00036">REGION</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l01233">resize_image()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00704">rotate_image()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00597">save_image()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00285">set_batch_network()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00459">show_image()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00046">layer::type</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00024">image::w</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00047">network::w</a>, and <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00490">zero_objectness()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/df8/darknet_8c_source.html#l00389">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;{</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    srand(0);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span>(argc &lt; 4){</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;usage: %s %s [cfg] [weights] [image] [layer] [options! (optional)]\n&quot;</span>, argv[0], argv[1]);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordtype">char</span> *cfg = argv[2];</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordtype">char</span> *weights = argv[3];</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">char</span> *input = argv[4];</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">int</span> max_layer = atoi(argv[5]);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">int</span> range = <a class="code" href="../../d3/d91/utils_8c.html#a6c1259f0b709a2411c0375db749440a2">find_int_arg</a>(argc, argv, <span class="stringliteral">&quot;-range&quot;</span>, 1);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordtype">int</span> norm = <a class="code" href="../../d3/d91/utils_8c.html#a6c1259f0b709a2411c0375db749440a2">find_int_arg</a>(argc, argv, <span class="stringliteral">&quot;-norm&quot;</span>, 1);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordtype">int</span> rounds = <a class="code" href="../../d3/d91/utils_8c.html#a6c1259f0b709a2411c0375db749440a2">find_int_arg</a>(argc, argv, <span class="stringliteral">&quot;-rounds&quot;</span>, 1);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">int</span> iters = <a class="code" href="../../d3/d91/utils_8c.html#a6c1259f0b709a2411c0375db749440a2">find_int_arg</a>(argc, argv, <span class="stringliteral">&quot;-iters&quot;</span>, 10);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">int</span> octaves = <a class="code" href="../../d3/d91/utils_8c.html#a6c1259f0b709a2411c0375db749440a2">find_int_arg</a>(argc, argv, <span class="stringliteral">&quot;-octaves&quot;</span>, 4);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">float</span> zoom = <a class="code" href="../../d3/d91/utils_8c.html#af7e57f4e7e4fda1770fbeee64d9443b0">find_float_arg</a>(argc, argv, <span class="stringliteral">&quot;-zoom&quot;</span>, 1.);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">float</span> rate = <a class="code" href="../../d3/d91/utils_8c.html#af7e57f4e7e4fda1770fbeee64d9443b0">find_float_arg</a>(argc, argv, <span class="stringliteral">&quot;-rate&quot;</span>, .04);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">float</span> thresh = <a class="code" href="../../d3/d91/utils_8c.html#af7e57f4e7e4fda1770fbeee64d9443b0">find_float_arg</a>(argc, argv, <span class="stringliteral">&quot;-thresh&quot;</span>, 1.);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordtype">float</span> rotate = <a class="code" href="../../d3/d91/utils_8c.html#af7e57f4e7e4fda1770fbeee64d9443b0">find_float_arg</a>(argc, argv, <span class="stringliteral">&quot;-rotate&quot;</span>, 0);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">float</span> momentum = <a class="code" href="../../d3/d91/utils_8c.html#af7e57f4e7e4fda1770fbeee64d9443b0">find_float_arg</a>(argc, argv, <span class="stringliteral">&quot;-momentum&quot;</span>, .9);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">float</span> lambda = <a class="code" href="../../d3/d91/utils_8c.html#af7e57f4e7e4fda1770fbeee64d9443b0">find_float_arg</a>(argc, argv, <span class="stringliteral">&quot;-lambda&quot;</span>, .01);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">char</span> *prefix = <a class="code" href="../../d3/d91/utils_8c.html#a22c33a506b0842cadb2a5530a25ca7bf">find_char_arg</a>(argc, argv, <span class="stringliteral">&quot;-prefix&quot;</span>, 0);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">int</span> reconstruct = <a class="code" href="../../d3/d91/utils_8c.html#a845f7b956fcb9711346b8189e18d3846">find_arg</a>(argc, argv, <span class="stringliteral">&quot;-reconstruct&quot;</span>);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordtype">int</span> smooth_size = <a class="code" href="../../d3/d91/utils_8c.html#a6c1259f0b709a2411c0375db749440a2">find_int_arg</a>(argc, argv, <span class="stringliteral">&quot;-smooth&quot;</span>, 1);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="../../de/d45/structnetwork.html">network</a> net = <a class="code" href="../../d2/d72/parser_8c.html#abb6f2aa1c5d5bf340faae09be6538c56">parse_network_cfg</a>(cfg);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="../../d2/d72/parser_8c.html#a60957f4d236ea8e417999b1778ec3d55">load_weights</a>(&amp;net, weights);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordtype">char</span> *cfgbase = <a class="code" href="../../d3/d91/utils_8c.html#afe996fdc7e45995e94f02d55845e163b">basecfg</a>(cfg);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordtype">char</span> *imbase = <a class="code" href="../../d3/d91/utils_8c.html#afe996fdc7e45995e94f02d55845e163b">basecfg</a>(input);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a0cf39a1104b8f0415c56796b54a3670a">set_batch_network</a>(&amp;net, 1);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="../../de/d68/structimage.html">image</a> im = <a class="code" href="../../d3/d10/image_8c.html#a233b57091bac94f82d8aa0d8a5c1f070">load_image_color</a>(input, 0, 0);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span>(0){</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordtype">float</span> scale = 1;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">if</span>(im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a> &gt; 512 || im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a> &gt; 512){</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">if</span>(im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a> &gt; im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>) scale = 512.0/im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <span class="keywordflow">else</span> scale = 512.0/im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="../../de/d68/structimage.html">image</a> resized = <a class="code" href="../../d3/d10/image_8c.html#a583d43a007a97bb92fcbac12b8394c72">resize_image</a>(im, scale*im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>, scale*im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(im);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        im = resized;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">//im = letterbox_image(im, net.w, net.h);</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordtype">float</span> *features = 0;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="../../de/d68/structimage.html">image</a> update;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span> (reconstruct){</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        net.<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a> = max_layer;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        im = <a class="code" href="../../d3/d10/image_8c.html#a24b1468a82ce3e5fe9f912bda5507d87">letterbox_image</a>(im, net.<a class="code" href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">w</a>, net.<a class="code" href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">h</a>);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment">//resize_network(&amp;net, im.w, im.h);</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <a class="code" href="../../d6/d6e/network_8c.html#a40ea1072011345fcf25951b4a5d429a6">network_predict</a>(net, im.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">if</span>(net.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[net.<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a>-1].<a class="code" href="../../d4/db8/structlayer.html#af00e36adaf6e404a3e5234843c723714">type</a> == <a class="code" href="../../d3/d3b/layer_8h.html#a5f7e99058765b058df158c099200b154a3bfda0bdc93e66e77b2242a9ce4cd804">REGION</a>){</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            printf(<span class="stringliteral">&quot;region!\n&quot;</span>);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <a class="code" href="../../d3/d74/region__layer_8c.html#a482d1347c52a7651d858f842518c705e">zero_objectness</a>(net.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[net.<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a>-1]);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <a class="code" href="../../de/d68/structimage.html">image</a> out_im = <a class="code" href="../../d3/d10/image_8c.html#a26b84c1b61a038d1a010b8495eaa2a6d">copy_image</a>(<a class="code" href="../../d6/d6e/network_8c.html#a565138b1e47b93ded561ae9bc4a1ed10">get_network_image</a>(net));</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">           image crop = crop_image(out_im, zz, zz, out_im.w-2*zz, out_im.h-2*zz);</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">        //flip_image(crop);</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">        image f_im = resize_image(crop, out_im.w, out_im.h);</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">        free_image(crop);</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        printf(<span class="stringliteral">&quot;%d features\n&quot;</span>, out_im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*out_im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*out_im.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        features = out_im.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">        int i;</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">           for(i = 0; i &lt; 14*14*512; ++i){</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">        //features[i] += rand_uniform(-.19, .19);</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">        }</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">        free_image(im);</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">        im = make_random_image(im.w, im.h, im.c);</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        update = <a class="code" href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1">make_image</a>(im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>, im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>, im.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordtype">int</span> e;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordtype">int</span> n;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">for</span>(e = 0; e &lt; rounds; ++e){</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;Iteration: &quot;</span>);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        fflush(stderr);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">for</span>(n = 0; n &lt; iters; ++n){  </div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            fprintf(stderr, <span class="stringliteral">&quot;%d, &quot;</span>, n);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            fflush(stderr);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <span class="keywordflow">if</span>(reconstruct){</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                <a class="code" href="../../dd/d03/nightmare_8c.html#ad0ea896e371131528c89aa21d403d6ae">reconstruct_picture</a>(net, features, im, update, rate, momentum, lambda, smooth_size, 1);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                <span class="comment">//if ((n+1)%30 == 0) rate *= .5;</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                <a class="code" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70">show_image</a>(im, <span class="stringliteral">&quot;reconstruction&quot;</span>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">#ifdef OPENCV</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                cvWaitKey(10);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="../../d4/db8/structlayer.html">layer</a> = max_layer + rand()%range - range/2;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keywordtype">int</span> octave = rand()%octaves;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <a class="code" href="../../dd/d03/nightmare_8c.html#a3fa2a59e61282c0b9a673497b0e5b1f0">optimize_picture</a>(&amp;net, im, layer, 1/pow(1.33333333, octave), rate, thresh, norm);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;done\n&quot;</span>);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">if</span>(0){</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <a class="code" href="../../de/d68/structimage.html">image</a> g = <a class="code" href="../../d3/d10/image_8c.html#afb7687883f6ac9579b395ca5b194916d">grayscale_image</a>(im);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(im);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            im = g;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordtype">char</span> buff[256];</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">if</span> (prefix){</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            sprintf(buff, <span class="stringliteral">&quot;%s/%s_%s_%d_%06d&quot;</span>,prefix, imbase, cfgbase, max_layer, e);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            sprintf(buff, <span class="stringliteral">&quot;%s_%s_%d_%06d&quot;</span>,imbase, cfgbase, max_layer, e);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        printf(<span class="stringliteral">&quot;%d %s\n&quot;</span>, e, buff);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a0c7a63330d7929a012da0a95694eb363">save_image</a>(im, buff);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment">//show_image(im, buff);</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="comment">//cvWaitKey(0);</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">if</span>(rotate){</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <a class="code" href="../../de/d68/structimage.html">image</a> rot = <a class="code" href="../../d3/d10/image_8c.html#ada1ff9897608b861121e8581302a27c3">rotate_image</a>(im, rotate);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(im);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            im = rot;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="../../de/d68/structimage.html">image</a> crop = <a class="code" href="../../d3/d10/image_8c.html#ad323458860dbdb7a2af97b9b35ad91bf">crop_image</a>(im, im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a> * (1. - zoom)/2., im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a> * (1.-zoom)/2., im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*zoom, im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*zoom);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <a class="code" href="../../de/d68/structimage.html">image</a> resized = <a class="code" href="../../d3/d10/image_8c.html#a583d43a007a97bb92fcbac12b8394c72">resize_image</a>(crop, im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>, im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(im);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(crop);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        im = resized;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div><div class="ttc" id="image_8c_html_a24b1468a82ce3e5fe9f912bda5507d87"><div class="ttname"><a href="../../d3/d10/image_8c.html#a24b1468a82ce3e5fe9f912bda5507d87">letterbox_image</a></div><div class="ttdeci">image letterbox_image(image im, int w, int h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00844">image.c:844</a></div></div>
<div class="ttc" id="nightmare_8c_html_a3fa2a59e61282c0b9a673497b0e5b1f0"><div class="ttname"><a href="../../dd/d03/nightmare_8c.html#a3fa2a59e61282c0b9a673497b0e5b1f0">optimize_picture</a></div><div class="ttdeci">void optimize_picture(network *net, image orig, int max_layer, float scale, float rate, float thresh, int norm)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d03/nightmare_8c_source.html#l00030">nightmare.c:30</a></div></div>
<div class="ttc" id="utils_8c_html_a6c1259f0b709a2411c0375db749440a2"><div class="ttname"><a href="../../d3/d91/utils_8c.html#a6c1259f0b709a2411c0375db749440a2">find_int_arg</a></div><div class="ttdeci">int find_int_arg(int argc, char **argv, char *arg, int def)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00093">utils.c:93</a></div></div>
<div class="ttc" id="structimage_html"><div class="ttname"><a href="../../de/d68/structimage.html">image</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00022">image.h:22</a></div></div>
<div class="ttc" id="network_8c_html_a40ea1072011345fcf25951b4a5d429a6"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a40ea1072011345fcf25951b4a5d429a6">network_predict</a></div><div class="ttdeci">float * network_predict(network net, float *input)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00429">network.c:429</a></div></div>
<div class="ttc" id="image_8c_html_ada1ff9897608b861121e8581302a27c3"><div class="ttname"><a href="../../d3/d10/image_8c.html#ada1ff9897608b861121e8581302a27c3">rotate_image</a></div><div class="ttdeci">image rotate_image(image im, float rad)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00704">image.c:704</a></div></div>
<div class="ttc" id="utils_8c_html_afe996fdc7e45995e94f02d55845e163b"><div class="ttname"><a href="../../d3/d91/utils_8c.html#afe996fdc7e45995e94f02d55845e163b">basecfg</a></div><div class="ttdeci">char * basecfg(char *cfgfile)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00139">utils.c:139</a></div></div>
<div class="ttc" id="region__layer_8c_html_a482d1347c52a7651d858f842518c705e"><div class="ttname"><a href="../../d3/d74/region__layer_8c.html#a482d1347c52a7651d858f842518c705e">zero_objectness</a></div><div class="ttdeci">void zero_objectness(layer l)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d74/region__layer_8c_source.html#l00490">region_layer.c:490</a></div></div>
<div class="ttc" id="structimage_html_a30e2caee481a59608823b3bcec8a139f"><div class="ttname"><a href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">image::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00023">image.h:23</a></div></div>
<div class="ttc" id="structnetwork_html"><div class="ttname"><a href="../../de/d45/structnetwork.html">network</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00014">network.h:14</a></div></div>
<div class="ttc" id="network_8c_html_a565138b1e47b93ded561ae9bc4a1ed10"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a565138b1e47b93ded561ae9bc4a1ed10">get_network_image</a></div><div class="ttdeci">image get_network_image(network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00398">network.c:398</a></div></div>
<div class="ttc" id="image_8c_html_afb7687883f6ac9579b395ca5b194916d"><div class="ttname"><a href="../../d3/d10/image_8c.html#afb7687883f6ac9579b395ca5b194916d">grayscale_image</a></div><div class="ttdeci">image grayscale_image(image im)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l01079">image.c:1079</a></div></div>
<div class="ttc" id="image_8c_html_a26b84c1b61a038d1a010b8495eaa2a6d"><div class="ttname"><a href="../../d3/d10/image_8c.html#a26b84c1b61a038d1a010b8495eaa2a6d">copy_image</a></div><div class="ttdeci">image copy_image(image p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00403">image.c:403</a></div></div>
<div class="ttc" id="image_8c_html_a726c30d7f0779c46f9ba5b8a3c2f94a1"><div class="ttname"><a href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1">make_image</a></div><div class="ttdeci">image make_image(int w, int h, int c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00636">image.c:636</a></div></div>
<div class="ttc" id="structnetwork_html_a9770423f88b722bafc9d1fd3c6091d75"><div class="ttname"><a href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">network::layers</a></div><div class="ttdeci">layer * layers</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00022">network.h:22</a></div></div>
<div class="ttc" id="layer_8h_html_a5f7e99058765b058df158c099200b154a3bfda0bdc93e66e77b2242a9ce4cd804"><div class="ttname"><a href="../../d3/d3b/layer_8h.html#a5f7e99058765b058df158c099200b154a3bfda0bdc93e66e77b2242a9ce4cd804">REGION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00036">layer.h:36</a></div></div>
<div class="ttc" id="utils_8c_html_a22c33a506b0842cadb2a5530a25ca7bf"><div class="ttname"><a href="../../d3/d91/utils_8c.html#a22c33a506b0842cadb2a5530a25ca7bf">find_char_arg</a></div><div class="ttdeci">char * find_char_arg(int argc, char **argv, char *arg, char *def)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00123">utils.c:123</a></div></div>
<div class="ttc" id="image_8c_html_a1b35e408b961d58f7e29ec146be91160"><div class="ttname"><a href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a></div><div class="ttdeci">void free_image(image m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l01523">image.c:1523</a></div></div>
<div class="ttc" id="utils_8c_html_af7e57f4e7e4fda1770fbeee64d9443b0"><div class="ttname"><a href="../../d3/d91/utils_8c.html#af7e57f4e7e4fda1770fbeee64d9443b0">find_float_arg</a></div><div class="ttdeci">float find_float_arg(int argc, char **argv, char *arg, float def)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00108">utils.c:108</a></div></div>
<div class="ttc" id="structimage_html_aa67d2491c4d17dd240453d69dfc99482"><div class="ttname"><a href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">image::c</a></div><div class="ttdeci">int c</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00025">image.h:25</a></div></div>
<div class="ttc" id="structimage_html_aa6480e4024a0d5ca8d36b4145b3ceb43"><div class="ttname"><a href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">image::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00024">image.h:24</a></div></div>
<div class="ttc" id="image_8c_html_a233b57091bac94f82d8aa0d8a5c1f070"><div class="ttname"><a href="../../d3/d10/image_8c.html#a233b57091bac94f82d8aa0d8a5c1f070">load_image_color</a></div><div class="ttdeci">image load_image_color(char *filename, int w, int h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l01368">image.c:1368</a></div></div>
<div class="ttc" id="parser_8c_html_abb6f2aa1c5d5bf340faae09be6538c56"><div class="ttname"><a href="../../d2/d72/parser_8c.html#abb6f2aa1c5d5bf340faae09be6538c56">parse_network_cfg</a></div><div class="ttdeci">network parse_network_cfg(char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d72/parser_8c_source.html#l00618">parser.c:618</a></div></div>
<div class="ttc" id="network_8c_html_a0cf39a1104b8f0415c56796b54a3670a"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a0cf39a1104b8f0415c56796b54a3670a">set_batch_network</a></div><div class="ttdeci">void set_batch_network(network *net, int b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00285">network.c:285</a></div></div>
<div class="ttc" id="image_8c_html_a0c7a63330d7929a012da0a95694eb363"><div class="ttname"><a href="../../d3/d10/image_8c.html#a0c7a63330d7929a012da0a95694eb363">save_image</a></div><div class="ttdeci">void save_image(image im, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00597">image.c:597</a></div></div>
<div class="ttc" id="image_8c_html_a5807da5b9392f853749db3e7c727bd70"><div class="ttname"><a href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70">show_image</a></div><div class="ttdeci">void show_image(image p, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00459">image.c:459</a></div></div>
<div class="ttc" id="image_8c_html_a583d43a007a97bb92fcbac12b8394c72"><div class="ttname"><a href="../../d3/d10/image_8c.html#a583d43a007a97bb92fcbac12b8394c72">resize_image</a></div><div class="ttdeci">image resize_image(image im, int w, int h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l01233">image.c:1233</a></div></div>
<div class="ttc" id="structlayer_html_af00e36adaf6e404a3e5234843c723714"><div class="ttname"><a href="../../d4/db8/structlayer.html#af00e36adaf6e404a3e5234843c723714">layer::type</a></div><div class="ttdeci">LAYER_TYPE type</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00046">layer.h:46</a></div></div>
<div class="ttc" id="structnetwork_html_a0e57f4230f8ecb07bba0c97cf8f045c7"><div class="ttname"><a href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">network::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00047">network.h:47</a></div></div>
<div class="ttc" id="structnetwork_html_a1c7625720955322d05924a075d013877"><div class="ttname"><a href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">network::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00015">network.h:15</a></div></div>
<div class="ttc" id="utils_8c_html_a845f7b956fcb9711346b8189e18d3846"><div class="ttname"><a href="../../d3/d91/utils_8c.html#a845f7b956fcb9711346b8189e18d3846">find_arg</a></div><div class="ttdeci">int find_arg(int argc, char *argv[], char *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00080">utils.c:80</a></div></div>
<div class="ttc" id="image_8c_html_ad323458860dbdb7a2af97b9b35ad91bf"><div class="ttname"><a href="../../d3/d10/image_8c.html#ad323458860dbdb7a2af97b9b35ad91bf">crop_image</a></div><div class="ttdeci">image crop_image(image im, int dx, int dy, int w, int h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00741">image.c:741</a></div></div>
<div class="ttc" id="structnetwork_html_a944b83cb20da2454c6092e07b9a1d3e9"><div class="ttname"><a href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">network::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00047">network.h:47</a></div></div>
<div class="ttc" id="parser_8c_html_a60957f4d236ea8e417999b1778ec3d55"><div class="ttname"><a href="../../d2/d72/parser_8c.html#a60957f4d236ea8e417999b1778ec3d55">load_weights</a></div><div class="ttdeci">void load_weights(network *net, char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d72/parser_8c_source.html#l01127">parser.c:1127</a></div></div>
<div class="ttc" id="nightmare_8c_html_ad0ea896e371131528c89aa21d403d6ae"><div class="ttname"><a href="../../dd/d03/nightmare_8c.html#ad0ea896e371131528c89aa21d403d6ae">reconstruct_picture</a></div><div class="ttdeci">void reconstruct_picture(network net, float *features, image recon, image update, float rate, float momentum, float lambda, int smooth_size, int iters)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d03/nightmare_8c_source.html#l00132">nightmare.c:132</a></div></div>
<div class="ttc" id="structlayer_html"><div class="ttname"><a href="../../d4/db8/structlayer.html">layer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00045">layer.h:45</a></div></div>
<div class="ttc" id="structimage_html_aed7e0704080213b735419d6661251a0a"><div class="ttname"><a href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">image::data</a></div><div class="ttdeci">float * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00026">image.h:26</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d03/nightmare_8c_aaefb0ed0f5bd621bb9e131e2bc1b4852_cgraph.png" border="0" usemap="#dd/d03/nightmare_8c_aaefb0ed0f5bd621bb9e131e2bc1b4852_cgraph" alt=""/></div>
<map name="dd/d03/nightmare_8c_aaefb0ed0f5bd621bb9e131e2bc1b4852_cgraph" id="dd/d03/nightmare_8c_aaefb0ed0f5bd621bb9e131e2bc1b4852_cgraph">
<area shape="rect" id="node2" href="../../d3/d91/utils_8c.html#afe996fdc7e45995e94f02d55845e163b" title="basecfg" alt="" coords="195,101,264,127"/>
<area shape="rect" id="node4" href="../../d3/d10/image_8c.html#a26b84c1b61a038d1a010b8495eaa2a6d" title="copy_image" alt="" coords="588,507,681,532"/>
<area shape="rect" id="node5" href="../../d3/d10/image_8c.html#ad323458860dbdb7a2af97b9b35ad91bf" title="crop_image" alt="" coords="589,104,680,129"/>
<area shape="rect" id="node8" href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1" title="make_image" alt="" coords="749,380,847,405"/>
<area shape="rect" id="node11" href="../../d3/d91/utils_8c.html#a845f7b956fcb9711346b8189e18d3846" title="find_arg" alt="" coords="195,1309,264,1335"/>
<area shape="rect" id="node13" href="../../d3/d91/utils_8c.html#a22c33a506b0842cadb2a5530a25ca7bf" title="find_char_arg" alt="" coords="178,1359,281,1384"/>
<area shape="rect" id="node14" href="../../d3/d91/utils_8c.html#af7e57f4e7e4fda1770fbeee64d9443b0" title="find_float_arg" alt="" coords="178,1408,281,1433"/>
<area shape="rect" id="node15" href="../../d3/d91/utils_8c.html#a6c1259f0b709a2411c0375db749440a2" title="find_int_arg" alt="" coords="184,1457,275,1483"/>
<area shape="rect" id="node16" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160" title="free_image" alt="" coords="754,759,842,784"/>
<area shape="rect" id="node17" href="../../d6/d6e/network_8c.html#a565138b1e47b93ded561ae9bc4a1ed10" title="get_network_image" alt="" coords="161,1507,298,1532"/>
<area shape="rect" id="node19" href="../../d3/d10/image_8c.html#afb7687883f6ac9579b395ca5b194916d" title="grayscale_image" alt="" coords="574,153,696,179"/>
<area shape="rect" id="node20" href="../../d3/d10/image_8c.html#a24b1468a82ce3e5fe9f912bda5507d87" title="letterbox_image" alt="" coords="375,304,491,329"/>
<area shape="rect" id="node23" href="../../d3/d10/image_8c.html#a583d43a007a97bb92fcbac12b8394c72" title="resize_image" alt="" coords="584,355,685,380"/>
<area shape="rect" id="node24" href="../../d3/d10/image_8c.html#a233b57091bac94f82d8aa0d8a5c1f070" title="load_image_color" alt="" coords="166,481,293,507"/>
<area shape="rect" id="node26" href="../../d2/d72/parser_8c.html#a60957f4d236ea8e417999b1778ec3d55" title="load_weights" alt="" coords="180,1556,279,1581"/>
<area shape="rect" id="node28" href="../../d6/d6e/network_8c.html#a40ea1072011345fcf25951b4a5d429a6" title="network_predict" alt="" coords="172,1133,287,1159"/>
<area shape="rect" id="node30" href="../../dd/d03/nightmare_8c.html#a3fa2a59e61282c0b9a673497b0e5b1f0" title="optimize_picture" alt="" coords="374,1015,493,1040"/>
<area shape="rect" id="node40" href="../../d2/d72/parser_8c.html#abb6f2aa1c5d5bf340faae09be6538c56" title="parse_network_cfg" alt="" coords="366,1408,500,1433"/>
<area shape="rect" id="node45" href="../../dd/d03/nightmare_8c.html#ad0ea896e371131528c89aa21d403d6ae" title="reconstruct_picture" alt="" coords="366,1256,501,1281"/>
<area shape="rect" id="node46" href="../../d3/d10/image_8c.html#ada1ff9897608b861121e8581302a27c3" title="rotate_image" alt="" coords="585,55,684,80"/>
<area shape="rect" id="node47" href="../../d3/d10/image_8c.html#a0c7a63330d7929a012da0a95694eb363" title="save_image" alt="" coords="588,556,681,581"/>
<area shape="rect" id="node48" href="../../d6/d6e/network_8c.html#a0cf39a1104b8f0415c56796b54a3670a" title="set_batch_network" alt="" coords="163,1605,296,1631"/>
<area shape="rect" id="node49" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70" title="show_image" alt="" coords="385,701,481,727"/>
<area shape="rect" id="node50" href="../../d3/d74/region__layer_8c.html#a482d1347c52a7651d858f842518c705e" title="zero_objectness" alt="" coords="170,1655,289,1680"/>
<area shape="rect" id="node3" href="../../d3/d91/utils_8c.html#a4d27da4f6ddad5146c9190badd121a39" title="copy_string" alt="" coords="389,101,478,127"/>
<area shape="rect" id="node6" href="../../d3/d91/utils_8c.html#a5402a85f04198ed74b0ac1172b673a14" title="constrain_int" alt="" coords="749,104,846,129"/>
<area shape="rect" id="node7" href="../../d3/d10/image_8c.html#ab2ddb4ea0bc935f26ce71a731a3241d9" title="get_pixel" alt="" coords="760,153,835,179"/>
<area shape="rect" id="node10" href="../../d3/d10/image_8c.html#a566c2d016eb920d2fee7d3bb055a720b" title="set_pixel" alt="" coords="761,55,835,80"/>
<area shape="rect" id="node9" href="../../d3/d10/image_8c.html#a28bb9f835989b2f7e908386421c52837" title="make_empty_image" alt="" coords="895,544,1036,569"/>
<area shape="rect" id="node12" href="../../d3/d91/utils_8c.html#ae8f911d0e43e2013b752049d7fd8aa48" title="del_arg" alt="" coords="400,1457,466,1483"/>
<area shape="rect" id="node18" href="../../d6/d6e/network_8c.html#a5bb83a6363a3ed2358ce290c69be0d06" title="get_network_image_layer" alt="" coords="346,1507,520,1532"/>
<area shape="rect" id="node21" href="../../d3/d10/image_8c.html#a0320f25f8508fb74f62f151f2ffb0e73" title="embed_image" alt="" coords="582,5,688,31"/>
<area shape="rect" id="node22" href="../../d3/d10/image_8c.html#a2d0eeff2d38a63a515251874fa0451c9" title="fill_image" alt="" coords="596,203,673,228"/>
<area shape="rect" id="node25" href="../../d3/d10/image_8c.html#a4eec265642aa18081a3e8795c5a78afb" title="load_image" alt="" coords="388,456,478,481"/>
<area shape="rect" id="node27" href="../../d2/d72/parser_8c.html#abb17f71fa3838540cc5eff6492cce5e6" title="load_weights_upto" alt="" coords="367,1556,500,1581"/>
<area shape="rect" id="node29" href="../../d6/d6e/network_8c.html#affc7ba2c94d58f52043a19d4c8151daa" title="forward_network" alt="" coords="575,1308,695,1333"/>
<area shape="rect" id="node31" href="../../dc/d50/blas_8c.html#a1af2064b6d091c8bf5565327745534fc" title="axpy_cpu" alt="" coords="595,1209,674,1235"/>
<area shape="rect" id="node32" href="../../d6/d6e/network_8c.html#af218830ea9b2a8a582c3b362abc74ca4" title="backward_network" alt="" coords="568,1259,701,1284"/>
<area shape="rect" id="node33" href="../../dd/d03/nightmare_8c.html#a561eaf6bb47290c5cddb9ba6b5c66f48" title="calculate_loss" alt="" coords="582,911,687,936"/>
<area shape="rect" id="node34" href="../../d3/d10/image_8c.html#ae8ec59e2e5d3166e688d80a0e2869e80" title="constrain_image" alt="" coords="575,809,694,835"/>
<area shape="rect" id="node35" href="../../dc/d50/blas_8c.html#a22f6b03dd54e2d4b249e53a0ca14434c" title="copy_cpu" alt="" coords="595,960,674,985"/>
<area shape="rect" id="node36" href="../../d3/d10/image_8c.html#ac226109dbae019db599ceb71d5f6aca8" title="flip_image" alt="" coords="594,1009,676,1035"/>
<area shape="rect" id="node37" href="../../d3/d91/utils_8c.html#af0d493fdef09c062d7c28c10401beed0" title="normalize_array" alt="" coords="576,1059,693,1084"/>
<area shape="rect" id="node38" href="../../d6/d6e/network_8c.html#a6ae710d2d9ad32cfdec1f925f48c2b50" title="resize_network" alt="" coords="579,1160,690,1185"/>
<area shape="rect" id="node39" href="../../d3/d91/utils_8c.html#a6c317cffefb9737fb2260da73688f275" title="error" alt="" coords="773,1511,822,1536"/>
<area shape="rect" id="node41" href="../../d2/d72/parser_8c.html#a3275ec64d90febff7c0b69c9c5253893" title="read_cfg" alt="" coords="598,1611,671,1636"/>
<area shape="rect" id="node42" href="../../d6/d6e/network_8c.html#ad2dcde69603d71857d11484ae99bd8fe" title="make_network" alt="" coords="581,1660,689,1685"/>
<area shape="rect" id="node43" href="../../d2/d72/parser_8c.html#ad1828ac8171ebfd2b0810efb68a892d8" title="is_network" alt="" coords="592,1709,677,1735"/>
<area shape="rect" id="node44" href="../../d2/d72/parser_8c.html#a21c6f7046fcd48a8cfd74c23fcf944ca" title="parse_net_options" alt="" coords="569,1561,700,1587"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d03/nightmare_8c_aaefb0ed0f5bd621bb9e131e2bc1b4852_icgraph.png" border="0" usemap="#dd/d03/nightmare_8c_aaefb0ed0f5bd621bb9e131e2bc1b4852_icgraph" alt=""/></div>
<map name="dd/d03/nightmare_8c_aaefb0ed0f5bd621bb9e131e2bc1b4852_icgraph" id="dd/d03/nightmare_8c_aaefb0ed0f5bd621bb9e131e2bc1b4852_icgraph">
<area shape="rect" id="node2" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="161,5,211,31"/>
</map>
</div>

</div>
</div>
<a id="acd159186e193428cba70578a92bafed2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd159186e193428cba70578a92bafed2">&#9670;&nbsp;</a></span>smooth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void smooth </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d68/structimage.html">image</a>&#160;</td>
          <td class="paramname"><em>recon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d68/structimage.html">image</a>&#160;</td>
          <td class="paramname"><em>update</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d03/nightmare_8c_source.html#l00111">111</a> of file <a class="el" href="../../dd/d03/nightmare_8c_source.html">nightmare.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/db2/image_8h_source.html#l00025">image::c</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00026">image::data</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00023">image::h</a>, and <a class="el" href="../../d5/db2/image_8h_source.html#l00024">image::w</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">int</span> i, j, k;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">int</span> ii, jj;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">for</span>(k = 0; k &lt; recon.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>; ++k){</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">for</span>(j = 0; j &lt; recon.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>; ++j){</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">for</span>(i = 0; i &lt; recon.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>; ++i){</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keywordtype">int</span> out_index = i + recon.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*(j + recon.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*k);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                <span class="keywordflow">for</span>(jj = j-num; jj &lt;= j + num &amp;&amp; jj &lt; recon.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>; ++jj){</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    <span class="keywordflow">if</span> (jj &lt; 0) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    <span class="keywordflow">for</span>(ii = i-num; ii &lt;= i + num &amp;&amp; ii &lt; recon.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>; ++ii){</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                        <span class="keywordflow">if</span> (ii &lt; 0) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                        <span class="keywordtype">int</span> in_index = ii + recon.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*(jj + recon.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*k);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                        update.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>[out_index] += lambda * (recon.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>[in_index] - recon.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>[out_index]);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div><div class="ttc" id="structimage_html_a30e2caee481a59608823b3bcec8a139f"><div class="ttname"><a href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">image::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00023">image.h:23</a></div></div>
<div class="ttc" id="structimage_html_aa67d2491c4d17dd240453d69dfc99482"><div class="ttname"><a href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">image::c</a></div><div class="ttdeci">int c</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00025">image.h:25</a></div></div>
<div class="ttc" id="structimage_html_aa6480e4024a0d5ca8d36b4145b3ceb43"><div class="ttname"><a href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">image::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00024">image.h:24</a></div></div>
<div class="ttc" id="structimage_html_aed7e0704080213b735419d6661251a0a"><div class="ttname"><a href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">image::data</a></div><div class="ttdeci">float * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00026">image.h:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat May 27 2017 01:13:33 for Darknet by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
