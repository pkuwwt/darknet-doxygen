<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Darknet: detection_layer.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Darknet
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">detection_layer.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../d9/df7/detection__layer_8h_source.html">detection_layer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d92/activations_8h_source.html">activations.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d80/softmax__layer_8h_source.html">softmax_layer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/df1/blas_8h_source.html">blas.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dc/d19/box_8h_source.html">box.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dc/d57/cuda_8h_source.html">cuda.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">utils.h</a>&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for detection_layer.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/dd8/detection__layer_8c__incl.png" border="0" usemap="#detection__layer_8c" alt=""/></div>
<map name="detection__layer_8c" id="detection__layer_8c">
<area shape="rect" id="node2" href="../../d9/df7/detection__layer_8h.html" title="detection_layer.h" alt="" coords="490,79,612,104"/>
<area shape="rect" id="node4" href="../../de/d92/activations_8h.html" title="activations.h" alt="" coords="94,299,189,324"/>
<area shape="rect" id="node5" href="../../dc/d57/cuda_8h.html" title="cuda.h" alt="" coords="43,372,104,397"/>
<area shape="rect" id="node15" href="../../dc/d19/box_8h.html" title="box.h" alt="" coords="938,372,992,397"/>
<area shape="rect" id="node20" href="../../d8/d80/softmax__layer_8h.html" title="softmax_layer.h" alt="" coords="351,79,465,104"/>
<area shape="rect" id="node21" href="../../d8/df1/blas_8h.html" title="blas.h" alt="" coords="1032,79,1088,104"/>
<area shape="rect" id="node22" href="../../d5/d60/utils_8h.html" title="utils.h" alt="" coords="765,225,821,251"/>
<area shape="rect" id="node3" href="../../d3/d3b/layer_8h.html" title="layer.h" alt="" coords="322,225,382,251"/>
<area shape="rect" id="node9" href="../../d9/d94/network_8h.html" title="network.h" alt="" coords="452,152,532,177"/>
<area shape="rect" id="node8" href="../../d3/d09/tree_8h.html" title="tree.h" alt="" coords="307,299,362,324"/>
<area shape="rect" id="node10" href="../../d5/db2/image_8h.html" title="image.h" alt="" coords="582,299,650,324"/>
<area shape="rect" id="node16" href="../../d2/dbd/data_8h.html" title="data.h" alt="" coords="465,225,524,251"/>
<area shape="rect" id="node18" href="../../dd/df4/matrix_8h.html" title="matrix.h" alt="" coords="488,299,557,324"/>
<area shape="rect" id="node19" href="../../da/d23/list_8h.html" title="list.h" alt="" coords="725,299,774,324"/>
</map>
</div>
</div>
<p><a href="../../d7/dbd/detection__layer_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7e20e8df14e9db1f8dd7f3c0b9aa1bc9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/df7/detection__layer_8h.html#a3a5018a4d1685b278fc2586711a3a976">detection_layer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dbd/detection__layer_8c.html#a7e20e8df14e9db1f8dd7f3c0b9aa1bc9">make_detection_layer</a> (int batch, int inputs, int n, int side, int classes, int coords, int rescore)</td></tr>
<tr class="separator:a7e20e8df14e9db1f8dd7f3c0b9aa1bc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9160e6deb288c256697c0b3d3d3a7909"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dbd/detection__layer_8c.html#a9160e6deb288c256697c0b3d3d3a7909">forward_detection_layer</a> (const <a class="el" href="../../d9/df7/detection__layer_8h.html#a3a5018a4d1685b278fc2586711a3a976">detection_layer</a> l, <a class="el" href="../../de/d45/structnetwork.html">network</a> net)</td></tr>
<tr class="separator:a9160e6deb288c256697c0b3d3d3a7909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46eff38e5007c73bf4de33f2b0adbd61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dbd/detection__layer_8c.html#a46eff38e5007c73bf4de33f2b0adbd61">backward_detection_layer</a> (const <a class="el" href="../../d9/df7/detection__layer_8h.html#a3a5018a4d1685b278fc2586711a3a976">detection_layer</a> l, <a class="el" href="../../de/d45/structnetwork.html">network</a> net)</td></tr>
<tr class="separator:a46eff38e5007c73bf4de33f2b0adbd61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2d2b9d1d0ab7d8e8d69ebb468fbc475"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dbd/detection__layer_8c.html#aa2d2b9d1d0ab7d8e8d69ebb468fbc475">get_detection_boxes</a> (<a class="el" href="../../d4/db8/structlayer.html">layer</a> l, int w, int h, float thresh, float **probs, <a class="el" href="../../d8/dae/structbox.html">box</a> *boxes, int only_objectness)</td></tr>
<tr class="separator:aa2d2b9d1d0ab7d8e8d69ebb468fbc475"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a46eff38e5007c73bf4de33f2b0adbd61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46eff38e5007c73bf4de33f2b0adbd61">&#9670;&nbsp;</a></span>backward_detection_layer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void backward_detection_layer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d9/df7/detection__layer_8h.html#a3a5018a4d1685b278fc2586711a3a976">detection_layer</a>&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d45/structnetwork.html">network</a>&#160;</td>
          <td class="paramname"><em>net</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/dbd/detection__layer_8c_source.html#l00219">219</a> of file <a class="el" href="../../d7/dbd/detection__layer_8c_source.html">detection_layer.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d50/blas_8c_source.html#l00146">axpy_cpu()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00057">layer::batch</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00064">network::delta</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00162">layer::delta</a>, and <a class="el" href="../../d3/d3b/layer_8h_source.html#l00060">layer::inputs</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/dbd/detection__layer_8c_source.html#l00013">make_detection_layer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;{</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="../../dc/d50/blas_8c.html#a1af2064b6d091c8bf5565327745534fc">axpy_cpu</a>(l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">inputs</a>, 1, l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, 1, net.<a class="code" href="../../de/d45/structnetwork.html#a7787a7dde0eea2d91b208c23cdba6286">delta</a>, 1);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div><div class="ttc" id="blas_8c_html_a1af2064b6d091c8bf5565327745534fc"><div class="ttname"><a href="../../dc/d50/blas_8c.html#a1af2064b6d091c8bf5565327745534fc">axpy_cpu</a></div><div class="ttdeci">void axpy_cpu(int N, float ALPHA, float *X, int INCX, float *Y, int INCY)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/blas_8c_source.html#l00146">blas.c:146</a></div></div>
<div class="ttc" id="structnetwork_html_a7787a7dde0eea2d91b208c23cdba6286"><div class="ttname"><a href="../../de/d45/structnetwork.html#a7787a7dde0eea2d91b208c23cdba6286">network::delta</a></div><div class="ttdeci">float * delta</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00064">network.h:64</a></div></div>
<div class="ttc" id="structlayer_html_a1360cf3c28df067cc6f3af139fa95d3a"><div class="ttname"><a href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">layer::delta</a></div><div class="ttdeci">float * delta</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00162">layer.h:162</a></div></div>
<div class="ttc" id="structlayer_html_a3fac583bf31e18ca679d195b1485b316"><div class="ttname"><a href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">layer::inputs</a></div><div class="ttdeci">int inputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00060">layer.h:60</a></div></div>
<div class="ttc" id="structlayer_html_aff6bd99e74d13cccca4c492dd3e8de9c"><div class="ttname"><a href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">layer::batch</a></div><div class="ttdeci">int batch</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00057">layer.h:57</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/dbd/detection__layer_8c_a46eff38e5007c73bf4de33f2b0adbd61_cgraph.png" border="0" usemap="#d7/dbd/detection__layer_8c_a46eff38e5007c73bf4de33f2b0adbd61_cgraph" alt=""/></div>
<map name="d7/dbd/detection__layer_8c_a46eff38e5007c73bf4de33f2b0adbd61_cgraph" id="d7/dbd/detection__layer_8c_a46eff38e5007c73bf4de33f2b0adbd61_cgraph">
<area shape="rect" id="node2" href="../../dc/d50/blas_8c.html#a1af2064b6d091c8bf5565327745534fc" title="axpy_cpu" alt="" coords="193,12,272,37"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/dbd/detection__layer_8c_a46eff38e5007c73bf4de33f2b0adbd61_icgraph.png" border="0" usemap="#d7/dbd/detection__layer_8c_a46eff38e5007c73bf4de33f2b0adbd61_icgraph" alt=""/></div>
<map name="d7/dbd/detection__layer_8c_a46eff38e5007c73bf4de33f2b0adbd61_icgraph" id="d7/dbd/detection__layer_8c_a46eff38e5007c73bf4de33f2b0adbd61_icgraph">
<area shape="rect" id="node2" href="../../d9/df7/detection__layer_8h.html#abd42da178aad193f61e7e829c34be483" title="make_detection_layer" alt="" coords="193,1143,345,1168"/>
<area shape="rect" id="node3" href="../../d2/d72/parser_8c.html#ab5cfcdcccf8d8f3fa5f46d4528a70cab" title="parse_detection" alt="" coords="393,1143,509,1168"/>
<area shape="rect" id="node4" href="../../d5/d36/parser_8h.html#abb6f2aa1c5d5bf340faae09be6538c56" title="parse_network_cfg" alt="" coords="557,1143,691,1168"/>
<area shape="rect" id="node5" href="../../d0/d8d/art_8c.html#a4e3a9eebb42ddebed7f9b187a48a2ffd" title="demo_art" alt="" coords="785,5,863,31"/>
<area shape="rect" id="node6" href="../../d4/d8c/captcha_8c.html#aec7b557b2068b30c22b46051b5057769" title="train_captcha" alt="" coords="773,55,875,80"/>
<area shape="rect" id="node7" href="../../d4/d8c/captcha_8c.html#af9f9a5158ed6aa89db115092fd4f79f0" title="test_captcha" alt="" coords="776,104,872,129"/>
<area shape="rect" id="node8" href="../../d4/d8c/captcha_8c.html#ae7536d1632cea9c3c5cd6198920e1422" title="valid_captcha" alt="" coords="773,153,875,179"/>
<area shape="rect" id="node9" href="../../da/d91/cifar_8c.html#a2bbe2cb4f41dbb42ce2f808f7c173138" title="train_cifar" alt="" coords="784,203,864,228"/>
<area shape="rect" id="node10" href="../../da/d91/cifar_8c.html#a05c4dceae0b08fbc5e9be8dec9da81a4" title="train_cifar_distill" alt="" coords="766,252,882,277"/>
<area shape="rect" id="node11" href="../../da/d91/cifar_8c.html#ae17739385f812a6432492853b42cc113" title="test_cifar_multi" alt="" coords="769,301,880,327"/>
<area shape="rect" id="node12" href="../../da/d91/cifar_8c.html#a957192525193e2b1c2e49623efbf886b" title="test_cifar" alt="" coords="786,351,862,376"/>
<area shape="rect" id="node13" href="../../da/d91/cifar_8c.html#aafb9c1ab47e6aab1e91add0fa8274df2" title="test_cifar_csv" alt="" coords="773,400,875,425"/>
<area shape="rect" id="node14" href="../../da/d91/cifar_8c.html#a9f53222883b68025e04ab97d10308c94" title="test_cifar_csvtrain" alt="" coords="760,449,888,475"/>
<area shape="rect" id="node15" href="../../d0/db9/classifier_8c.html#ad875e8ecf86a386ce16c7142484f3efb" title="train_classifier" alt="" coords="771,499,877,524"/>
<area shape="rect" id="node16" href="../../d0/db9/classifier_8c.html#a636dccf9308a3ae0dbd8660f29db4e02" title="validate_classifier_crop" alt="" coords="744,548,904,573"/>
<area shape="rect" id="node17" href="../../d0/db9/classifier_8c.html#ae6830ebfccd79c255f5cac844aa5454b" title="validate_classifier_10" alt="" coords="750,597,898,623"/>
<area shape="rect" id="node18" href="../../d0/db9/classifier_8c.html#aeae387d13aac40e2eb3aff9584f03a8b" title="validate_classifier_full" alt="" coords="749,647,900,672"/>
<area shape="rect" id="node19" href="../../d0/db9/classifier_8c.html#a654da2bb707e0b4538d2193e6d8f55d1" title="validate_classifier\l_single" alt="" coords="761,696,887,735"/>
<area shape="rect" id="node20" href="../../d0/db9/classifier_8c.html#a4b863efd1e5f3105ed4843963b8d8412" title="validate_classifier\l_multi" alt="" coords="761,759,887,797"/>
<area shape="rect" id="node21" href="../../d0/db9/classifier_8c.html#a894dd692d95f8f8a8da05dae07e60138" title="try_classifier" alt="" coords="776,821,872,847"/>
<area shape="rect" id="node22" href="../../dd/df8/darknet_8c.html#aa8603edf5e9da49cdee89b35d6bc5b42" title="predict_classifier" alt="" coords="764,871,884,896"/>
<area shape="rect" id="node23" href="../../d0/db9/classifier_8c.html#a9ae475089952950f04778d56a5dd0f8e" title="label_classifier" alt="" coords="770,920,878,945"/>
<area shape="rect" id="node24" href="../../d0/db9/classifier_8c.html#aceccf5b6380cf57e56df5655b85fb52e" title="test_classifier" alt="" coords="773,969,875,995"/>
<area shape="rect" id="node25" href="../../d0/db9/classifier_8c.html#ab770e80d03219ab55ec93fdd0237f13b" title="threat_classifier" alt="" coords="767,1019,881,1044"/>
<area shape="rect" id="node26" href="../../d0/db9/classifier_8c.html#a8901a041f50c430e093fddb249d78d2f" title="gun_classifier" alt="" coords="773,1068,875,1093"/>
<area shape="rect" id="node27" href="../../d0/db9/classifier_8c.html#ac5e746c237b87dfa56d2ac1a5db9f3b9" title="demo_classifier" alt="" coords="767,1117,881,1143"/>
<area shape="rect" id="node28" href="../../d9/d90/coco_8c.html#a7d54248e7cab4c15d780458837482861" title="train_coco" alt="" coords="783,1167,865,1192"/>
<area shape="rect" id="node29" href="../../d9/d90/coco_8c.html#ac7595c589698e072c1f587df1c9d083f" title="validate_coco" alt="" coords="773,1216,875,1241"/>
<area shape="rect" id="node30" href="../../d9/d90/coco_8c.html#a75e914b5963bbd97ca7ab9b2d61235e4" title="validate_coco_recall" alt="" coords="753,1265,895,1291"/>
<area shape="rect" id="node31" href="../../d9/d90/coco_8c.html#a3750d7559afe9fbdcc98dfb5383275a7" title="test_coco" alt="" coords="785,1315,863,1340"/>
<area shape="rect" id="node32" href="../../de/da9/compare_8c.html#aa03abf85168fca74fa66b2545bb99131" title="train_compare" alt="" coords="771,1364,877,1389"/>
<area shape="rect" id="node33" href="../../de/da9/compare_8c.html#adb3488c9a05c95cd2a6f750418122506" title="validate_compare" alt="" coords="761,1413,887,1439"/>
<area shape="rect" id="node34" href="../../de/da9/compare_8c.html#acd74ba2c82e46517734c88f503f0c012" title="SortMaster3000" alt="" coords="766,1463,882,1488"/>
<area shape="rect" id="node35" href="../../de/da9/compare_8c.html#a6cd0266d812f6bfc1892f11aa20e1ad9" title="BattleRoyaleWithCheese" alt="" coords="739,1512,909,1537"/>
<area shape="rect" id="node36" href="../../dd/df8/darknet_8c.html#a7dfa7e733fd4cb2475215182772ba1bf" title="average" alt="" coords="789,1561,859,1587"/>
<area shape="rect" id="node37" href="../../dd/df8/darknet_8c.html#a4c45f1bb571fe1f3c52c4f7b7d858f8d" title="speed" alt="" coords="795,1611,853,1636"/>
<area shape="rect" id="node38" href="../../dd/df8/darknet_8c.html#ac61af9d7b12e2d1ac431925614a3b819" title="operations" alt="" coords="782,1660,866,1685"/>
<area shape="rect" id="node39" href="../../dd/df8/darknet_8c.html#ab5a20c1c9997af0dec519e992b9400b9" title="oneoff" alt="" coords="795,1709,853,1735"/>
<area shape="rect" id="node40" href="../../dd/df8/darknet_8c.html#a40cc02a08590681209ce323ff9e22042" title="oneoff2" alt="" coords="791,1759,857,1784"/>
<area shape="rect" id="node41" href="../../dd/df8/darknet_8c.html#a4663de4fa674346c82a366077969fd4b" title="partial" alt="" coords="795,1808,853,1833"/>
<area shape="rect" id="node42" href="../../dd/df8/darknet_8c.html#a83ca859f15e1369a5e569df1a7486ebe" title="rescale_net" alt="" coords="779,1857,869,1883"/>
<area shape="rect" id="node43" href="../../dd/df8/darknet_8c.html#a2bc7b77a09e6cfe48e3511ff39990af4" title="rgbgr_net" alt="" coords="785,1907,863,1932"/>
<area shape="rect" id="node44" href="../../dd/df8/darknet_8c.html#a69898d896e1117395eae539fa27b4eee" title="reset_normalize_net" alt="" coords="753,1956,895,1981"/>
<area shape="rect" id="node45" href="../../dd/df8/darknet_8c.html#a6a824943f20fa1121776a2a4fd6f1b03" title="normalize_net" alt="" coords="771,2005,877,2031"/>
<area shape="rect" id="node46" href="../../dd/df8/darknet_8c.html#ab619dcce0bf0acf8db3db0d86dfa83de" title="statistics_net" alt="" coords="775,2055,873,2080"/>
<area shape="rect" id="node47" href="../../dd/df8/darknet_8c.html#a59310cd440b860b5f21bd6e3ffef65d0" title="denormalize_net" alt="" coords="764,2104,884,2129"/>
<area shape="rect" id="node48" href="../../dd/df8/darknet_8c.html#a2b74a3332b1c442875e900ee9254649c" title="visualize" alt="" coords="788,2153,860,2179"/>
<area shape="rect" id="node49" href="../../df/d09/detector_8c.html#ae007089ceccb49a69ffa696a4f8dd78a" title="train_detector" alt="" coords="773,2203,875,2228"/>
<area shape="rect" id="node50" href="../../df/d09/detector_8c.html#a8e19e1fdfb2b82b5ce3b72bc8580d8e3" title="validate_detector_flip" alt="" coords="750,2252,898,2277"/>
</map>
</div>

</div>
</div>
<a id="a9160e6deb288c256697c0b3d3d3a7909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9160e6deb288c256697c0b3d3d3a7909">&#9670;&nbsp;</a></span>forward_detection_layer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void forward_detection_layer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d9/df7/detection__layer_8h.html#a3a5018a4d1685b278fc2586711a3a976">detection_layer</a>&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d45/structnetwork.html">network</a>&#160;</td>
          <td class="paramname"><em>net</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/dbd/detection__layer_8c_source.html#l00049">49</a> of file <a class="el" href="../../d7/dbd/detection__layer_8c_source.html">detection_layer.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d3b/layer_8h_source.html#l00057">layer::batch</a>, <a class="el" href="../../d2/dd1/box_8c_source.html#l00094">box_iou()</a>, <a class="el" href="../../d2/dd1/box_8c_source.html#l00099">box_rmse()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00119">layer::class_scale</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00095">layer::classes</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00116">layer::coord_scale</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00096">layer::coords</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00141">layer::cost</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00162">layer::delta</a>, <a class="el" href="../../d2/dd1/box_8c_source.html#l00006">float_to_box()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00058">layer::forced</a>, <a class="el" href="../../dc/d19/box_8h_source.html#l00005">box::h</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00062">network::input</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00060">layer::inputs</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00519">mag_array()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00068">layer::n</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00118">layer::noobject_scale</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00117">layer::object_scale</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00163">layer::output</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00061">layer::outputs</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00121">layer::random</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00098">layer::rescore</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00017">network::seen</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00072">layer::side</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00094">layer::softmax</a>, <a class="el" href="../../dc/d50/blas_8c_source.html#l00215">softmax()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00077">layer::sqrt</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00197">top_k()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00066">network::train</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00063">network::truth</a>, <a class="el" href="../../dc/d19/box_8h_source.html#l00005">box::w</a>, <a class="el" href="../../dc/d19/box_8h_source.html#l00005">box::x</a>, and <a class="el" href="../../dc/d19/box_8h_source.html#l00005">box::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/dbd/detection__layer_8c_source.html#l00224">get_detection_boxes()</a>, and <a class="el" href="../../d7/dbd/detection__layer_8c_source.html#l00013">make_detection_layer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordtype">int</span> locations = l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">int</span> i,j;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    memcpy(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, net.<a class="code" href="../../de/d45/structnetwork.html#a8f391155a3ceb60caf07d0ee6c6a93f2">input</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">//if(l.reorg) reorg(l.output, l.w*l.h, size*l.n, l.batch, 1);</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">int</span> b;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/db8/structlayer.html#a7b07ddac3afad25586ff7c18956ba9a9">softmax</a>){</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">for</span>(b = 0; b &lt; l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>; ++b){</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <span class="keywordtype">int</span> index = b*l.<a class="code" href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">inputs</a>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; locations; ++i) {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                <span class="keywordtype">int</span> offset = i*l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                <a class="code" href="../../dc/d50/blas_8c.html#a31c4f0273f3c5639ae7734d24e11274a">softmax</a>(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> + index + offset, l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>, 1, 1,</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                        l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> + index + offset);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span>(net.<a class="code" href="../../de/d45/structnetwork.html#a32e7b55fe8dfa07391b6cdce17b4a2c1">train</a>){</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordtype">float</span> avg_iou = 0;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordtype">float</span> avg_cat = 0;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordtype">float</span> avg_allcat = 0;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordtype">float</span> avg_obj = 0;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordtype">float</span> avg_anyobj = 0;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordtype">int</span> count = 0;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        *(l.<a class="code" href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">cost</a>) = 0;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../d1/d09/structload__args.html#a57fbd5eb4f1b223ad19b5324fa01b184">size</a> = l.<a class="code" href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">inputs</a> * l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        memset(l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, 0, size * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">for</span> (b = 0; b &lt; l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>; ++b){</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="keywordtype">int</span> index = b*l.<a class="code" href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">inputs</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; locations; ++i) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                <span class="keywordtype">int</span> truth_index = (b*locations + i)*(1+l.<a class="code" href="../../d4/db8/structlayer.html#a6b8636464bcea5dea2c2235ee133af29">coords</a>+l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                <span class="keywordtype">int</span> is_obj = net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a>[truth_index];</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                <span class="keywordflow">for</span> (j = 0; j &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>; ++j) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                    <span class="keywordtype">int</span> p_index = index + locations*l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a> + i*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + j;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[p_index] = l.<a class="code" href="../../d4/db8/structlayer.html#ad10b4f2f32b1991c3cd8e66d138c5eaa">noobject_scale</a>*(0 - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[p_index]);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                    *(l.<a class="code" href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">cost</a>) += l.<a class="code" href="../../d4/db8/structlayer.html#ad10b4f2f32b1991c3cd8e66d138c5eaa">noobject_scale</a>*pow(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[p_index], 2);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                    avg_anyobj += l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[p_index];</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                <span class="keywordtype">int</span> best_index = -1;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                <span class="keywordtype">float</span> best_iou = 0;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                <span class="keywordtype">float</span> best_rmse = 20;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <span class="keywordflow">if</span> (!is_obj){</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                <span class="keywordtype">int</span> class_index = index + i*l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                <span class="keywordflow">for</span>(j = 0; j &lt; l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>; ++j) {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                    l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[class_index+j] = l.<a class="code" href="../../d4/db8/structlayer.html#a7175af778d4be5a066ccc212421617b7">class_scale</a> * (net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a>[truth_index+1+j] - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[class_index+j]);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    *(l.<a class="code" href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">cost</a>) += l.<a class="code" href="../../d4/db8/structlayer.html#a7175af778d4be5a066ccc212421617b7">class_scale</a> * pow(net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a>[truth_index+1+j] - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[class_index+j], 2);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                    <span class="keywordflow">if</span>(net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a>[truth_index + 1 + j]) avg_cat += l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[class_index+j];</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                    avg_allcat += l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[class_index+j];</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <a class="code" href="../../d8/dae/structbox.html">box</a> truth = <a class="code" href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35">float_to_box</a>(net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a> + truth_index + 1 + l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>, 1);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                truth.<a class="code" href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">x</a> /= l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                truth.<a class="code" href="../../d8/dae/structbox.html#ab25e5389fd474ccd83c7dfcf0b1f9957">y</a> /= l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="keywordflow">for</span>(j = 0; j &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>; ++j){</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    <span class="keywordtype">int</span> box_index = index + locations*(l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a> + l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>) + (i*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + j) * l.<a class="code" href="../../d4/db8/structlayer.html#a6b8636464bcea5dea2c2235ee133af29">coords</a>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    <a class="code" href="../../d8/dae/structbox.html">box</a> out = <a class="code" href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35">float_to_box</a>(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> + box_index, 1);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    out.<a class="code" href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">x</a> /= l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    out.<a class="code" href="../../d8/dae/structbox.html#ab25e5389fd474ccd83c7dfcf0b1f9957">y</a> /= l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                    <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/db8/structlayer.html#a30e95ebb753b16822e759bd903ca8f1a">sqrt</a>){</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                        out.<a class="code" href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">w</a> = out.<a class="code" href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">w</a>*out.<a class="code" href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">w</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                        out.<a class="code" href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">h</a> = out.<a class="code" href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">h</a>*out.<a class="code" href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">h</a>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                    }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    <span class="keywordtype">float</span> iou  = <a class="code" href="../../d2/dd1/box_8c.html#ae14a614fc4d26ebb552d23615dfea313">box_iou</a>(out, truth);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    <span class="comment">//iou = 0;</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    <span class="keywordtype">float</span> rmse = <a class="code" href="../../d2/dd1/box_8c.html#a6ac422ecf58a8311afa95c9bbd701ac8">box_rmse</a>(out, truth);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    <span class="keywordflow">if</span>(best_iou &gt; 0 || iou &gt; 0){</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                        <span class="keywordflow">if</span>(iou &gt; best_iou){</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                            best_iou = iou;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                            best_index = j;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                        }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                        <span class="keywordflow">if</span>(rmse &lt; best_rmse){</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                            best_rmse = rmse;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                            best_index = j;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                        }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                    }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                <span class="keywordflow">if</span>(l.<a class="code" href="../../d4/db8/structlayer.html#acf386a1f7b93955cc5d04513bb4e4649">forced</a>){</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                    <span class="keywordflow">if</span>(truth.<a class="code" href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">w</a>*truth.<a class="code" href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">h</a> &lt; .1){</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        best_index = 1;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                    }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                        best_index = 0;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                <span class="keywordflow">if</span>(l.<a class="code" href="../../d4/db8/structlayer.html#a411feca89284377c83dd97141540dd83">random</a> &amp;&amp; *(net.<a class="code" href="../../de/d45/structnetwork.html#ad1b060aa7e1bfd54e25448f1783733d6">seen</a>) &lt; 64000){</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                    best_index = rand()%l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                <span class="keywordtype">int</span> box_index = index + locations*(l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a> + l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>) + (i*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + best_index) * l.<a class="code" href="../../d4/db8/structlayer.html#a6b8636464bcea5dea2c2235ee133af29">coords</a>;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="keywordtype">int</span> tbox_index = truth_index + 1 + l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <a class="code" href="../../d8/dae/structbox.html">box</a> out = <a class="code" href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35">float_to_box</a>(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> + box_index, 1);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                out.<a class="code" href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">x</a> /= l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                out.<a class="code" href="../../d8/dae/structbox.html#ab25e5389fd474ccd83c7dfcf0b1f9957">y</a> /= l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/db8/structlayer.html#a30e95ebb753b16822e759bd903ca8f1a">sqrt</a>) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    out.<a class="code" href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">w</a> = out.<a class="code" href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">w</a>*out.<a class="code" href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">w</a>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    out.<a class="code" href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">h</a> = out.<a class="code" href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">h</a>*out.<a class="code" href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">h</a>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <span class="keywordtype">float</span> iou  = <a class="code" href="../../d2/dd1/box_8c.html#ae14a614fc4d26ebb552d23615dfea313">box_iou</a>(out, truth);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <span class="comment">//printf(&quot;%d,&quot;, best_index);</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keywordtype">int</span> p_index = index + locations*l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a> + i*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + best_index;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                *(l.<a class="code" href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">cost</a>) -= l.<a class="code" href="../../d4/db8/structlayer.html#ad10b4f2f32b1991c3cd8e66d138c5eaa">noobject_scale</a> * pow(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[p_index], 2);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                *(l.<a class="code" href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">cost</a>) += l.<a class="code" href="../../d4/db8/structlayer.html#a502c7f71d253c01f1724adbe8bc585fc">object_scale</a> * pow(1-l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[p_index], 2);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                avg_obj += l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[p_index];</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[p_index] = l.<a class="code" href="../../d4/db8/structlayer.html#a502c7f71d253c01f1724adbe8bc585fc">object_scale</a> * (1.-l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[p_index]);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                <span class="keywordflow">if</span>(l.<a class="code" href="../../d4/db8/structlayer.html#a662867ba4218e923a302fd215dab2ddd">rescore</a>){</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[p_index] = l.<a class="code" href="../../d4/db8/structlayer.html#a502c7f71d253c01f1724adbe8bc585fc">object_scale</a> * (iou - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[p_index]);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[box_index+0] = l.<a class="code" href="../../d4/db8/structlayer.html#a4cb681c94203182c328d7818bcb39de8">coord_scale</a>*(net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a>[tbox_index + 0] - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[box_index + 0]);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[box_index+1] = l.<a class="code" href="../../d4/db8/structlayer.html#a4cb681c94203182c328d7818bcb39de8">coord_scale</a>*(net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a>[tbox_index + 1] - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[box_index + 1]);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[box_index+2] = l.<a class="code" href="../../d4/db8/structlayer.html#a4cb681c94203182c328d7818bcb39de8">coord_scale</a>*(net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a>[tbox_index + 2] - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[box_index + 2]);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[box_index+3] = l.<a class="code" href="../../d4/db8/structlayer.html#a4cb681c94203182c328d7818bcb39de8">coord_scale</a>*(net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a>[tbox_index + 3] - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[box_index + 3]);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <span class="keywordflow">if</span>(l.<a class="code" href="../../d4/db8/structlayer.html#a30e95ebb753b16822e759bd903ca8f1a">sqrt</a>){</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[box_index+2] = l.<a class="code" href="../../d4/db8/structlayer.html#a4cb681c94203182c328d7818bcb39de8">coord_scale</a>*(sqrt(net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a>[tbox_index + 2]) - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[box_index + 2]);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                    l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[box_index+3] = l.<a class="code" href="../../d4/db8/structlayer.html#a4cb681c94203182c328d7818bcb39de8">coord_scale</a>*(sqrt(net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a>[tbox_index + 3]) - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[box_index + 3]);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                *(l.<a class="code" href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">cost</a>) += pow(1-iou, 2);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                avg_iou += iou;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                ++count;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">if</span>(0){</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keywordtype">float</span> *costs = calloc(l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>*locations*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keywordflow">for</span> (b = 0; b &lt; l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>; ++b) {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                <span class="keywordtype">int</span> index = b*l.<a class="code" href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">inputs</a>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                <span class="keywordflow">for</span> (i = 0; i &lt; locations; ++i) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    <span class="keywordflow">for</span> (j = 0; j &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>; ++j) {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                        <span class="keywordtype">int</span> p_index = index + locations*l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a> + i*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + j;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                        costs[b*locations*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + i*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + j] = l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[p_index]*l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[p_index];</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                    }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordtype">int</span> indexes[100];</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <a class="code" href="../../d3/d91/utils_8c.html#aafc3b7bab809d8bc77b7353fd43f731b">top_k</a>(costs, l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>*locations*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>, 100, indexes);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="keywordtype">float</span> cutoff = costs[indexes[99]];</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="keywordflow">for</span> (b = 0; b &lt; l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>; ++b) {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                <span class="keywordtype">int</span> index = b*l.<a class="code" href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">inputs</a>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                <span class="keywordflow">for</span> (i = 0; i &lt; locations; ++i) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                    <span class="keywordflow">for</span> (j = 0; j &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>; ++j) {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                        <span class="keywordtype">int</span> p_index = index + locations*l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a> + i*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + j;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                        <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[p_index]*l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[p_index] &lt; cutoff) l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[p_index] = 0;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            free(costs);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        *(l.<a class="code" href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">cost</a>) = pow(<a class="code" href="../../d3/d91/utils_8c.html#ab29ce45fa5e3847d0125e2e7f2e2cb44">mag_array</a>(l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a> * l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>), 2);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        printf(<span class="stringliteral">&quot;Detection Avg IOU: %f, Pos Cat: %f, All Cat: %f, Pos Obj: %f, Any Obj: %f, count: %d\n&quot;</span>, avg_iou/count, avg_cat/count, avg_allcat/(count*l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>), avg_obj/count, avg_anyobj/(l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>*locations*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>), count);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment">//if(l.reorg) reorg(l.delta, l.w*l.h, size*l.n, l.batch, 0);</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div><div class="ttc" id="structnetwork_html_ad1b060aa7e1bfd54e25448f1783733d6"><div class="ttname"><a href="../../de/d45/structnetwork.html#ad1b060aa7e1bfd54e25448f1783733d6">network::seen</a></div><div class="ttdeci">int * seen</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00017">network.h:17</a></div></div>
<div class="ttc" id="structlayer_html_a502c7f71d253c01f1724adbe8bc585fc"><div class="ttname"><a href="../../d4/db8/structlayer.html#a502c7f71d253c01f1724adbe8bc585fc">layer::object_scale</a></div><div class="ttdeci">float object_scale</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00117">layer.h:117</a></div></div>
<div class="ttc" id="box_8c_html_a3a91c383316adfc6dfc023e2168d0f35"><div class="ttname"><a href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35">float_to_box</a></div><div class="ttdeci">box float_to_box(float *f, int stride)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dd1/box_8c_source.html#l00006">box.c:6</a></div></div>
<div class="ttc" id="structlayer_html_a454b8980d0186eb0095a25aadef41744"><div class="ttname"><a href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">layer::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00068">layer.h:68</a></div></div>
<div class="ttc" id="structlayer_html_a662867ba4218e923a302fd215dab2ddd"><div class="ttname"><a href="../../d4/db8/structlayer.html#a662867ba4218e923a302fd215dab2ddd">layer::rescore</a></div><div class="ttdeci">int rescore</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00098">layer.h:98</a></div></div>
<div class="ttc" id="structbox_html_a56959fa604cfb411d0c001be7c444d05"><div class="ttname"><a href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">box::h</a></div><div class="ttdeci">float h</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00005">box.h:5</a></div></div>
<div class="ttc" id="structnetwork_html_a1453c2cf9a735bde55a281d698797a05"><div class="ttname"><a href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">network::truth</a></div><div class="ttdeci">float * truth</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00063">network.h:63</a></div></div>
<div class="ttc" id="structload__args_html_a57fbd5eb4f1b223ad19b5324fa01b184"><div class="ttname"><a href="../../d1/d09/structload__args.html#a57fbd5eb4f1b223ad19b5324fa01b184">load_args::size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00048">data.h:48</a></div></div>
<div class="ttc" id="structlayer_html_a0286d4acb9afd3c080b0158bf6ef3ca1"><div class="ttname"><a href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">layer::side</a></div><div class="ttdeci">int side</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00072">layer.h:72</a></div></div>
<div class="ttc" id="structlayer_html_a7175af778d4be5a066ccc212421617b7"><div class="ttname"><a href="../../d4/db8/structlayer.html#a7175af778d4be5a066ccc212421617b7">layer::class_scale</a></div><div class="ttdeci">float class_scale</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00119">layer.h:119</a></div></div>
<div class="ttc" id="structbox_html_abd9b0191e52f22befa76bcf37b9e6477"><div class="ttname"><a href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">box::w</a></div><div class="ttdeci">float w</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00005">box.h:5</a></div></div>
<div class="ttc" id="utils_8c_html_aafc3b7bab809d8bc77b7353fd43f731b"><div class="ttname"><a href="../../d3/d91/utils_8c.html#aafc3b7bab809d8bc77b7353fd43f731b">top_k</a></div><div class="ttdeci">void top_k(float *a, int n, int k, int *index)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00197">utils.c:197</a></div></div>
<div class="ttc" id="blas_8c_html_a31c4f0273f3c5639ae7734d24e11274a"><div class="ttname"><a href="../../dc/d50/blas_8c.html#a31c4f0273f3c5639ae7734d24e11274a">softmax</a></div><div class="ttdeci">void softmax(float *input, int n, float temp, int stride, float *output)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/blas_8c_source.html#l00215">blas.c:215</a></div></div>
<div class="ttc" id="box_8c_html_a6ac422ecf58a8311afa95c9bbd701ac8"><div class="ttname"><a href="../../d2/dd1/box_8c.html#a6ac422ecf58a8311afa95c9bbd701ac8">box_rmse</a></div><div class="ttdeci">float box_rmse(box a, box b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dd1/box_8c_source.html#l00099">box.c:99</a></div></div>
<div class="ttc" id="structbox_html_a26adb5cfaf492245aba926b2f212b712"><div class="ttname"><a href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">box::x</a></div><div class="ttdeci">float x</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00005">box.h:5</a></div></div>
<div class="ttc" id="structnetwork_html_a32e7b55fe8dfa07391b6cdce17b4a2c1"><div class="ttname"><a href="../../de/d45/structnetwork.html#a32e7b55fe8dfa07391b6cdce17b4a2c1">network::train</a></div><div class="ttdeci">int train</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00066">network.h:66</a></div></div>
<div class="ttc" id="structlayer_html_a1360cf3c28df067cc6f3af139fa95d3a"><div class="ttname"><a href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">layer::delta</a></div><div class="ttdeci">float * delta</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00162">layer.h:162</a></div></div>
<div class="ttc" id="structlayer_html_a3fac583bf31e18ca679d195b1485b316"><div class="ttname"><a href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">layer::inputs</a></div><div class="ttdeci">int inputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00060">layer.h:60</a></div></div>
<div class="ttc" id="structlayer_html_aff6bd99e74d13cccca4c492dd3e8de9c"><div class="ttname"><a href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">layer::batch</a></div><div class="ttdeci">int batch</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00057">layer.h:57</a></div></div>
<div class="ttc" id="structlayer_html_a04d23c71428242b3153eda588f844eb3"><div class="ttname"><a href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">layer::output</a></div><div class="ttdeci">float * output</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00163">layer.h:163</a></div></div>
<div class="ttc" id="structlayer_html_a30e95ebb753b16822e759bd903ca8f1a"><div class="ttname"><a href="../../d4/db8/structlayer.html#a30e95ebb753b16822e759bd903ca8f1a">layer::sqrt</a></div><div class="ttdeci">int sqrt</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00077">layer.h:77</a></div></div>
<div class="ttc" id="structlayer_html_acf386a1f7b93955cc5d04513bb4e4649"><div class="ttname"><a href="../../d4/db8/structlayer.html#acf386a1f7b93955cc5d04513bb4e4649">layer::forced</a></div><div class="ttdeci">int forced</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00058">layer.h:58</a></div></div>
<div class="ttc" id="box_8c_html_ae14a614fc4d26ebb552d23615dfea313"><div class="ttname"><a href="../../d2/dd1/box_8c.html#ae14a614fc4d26ebb552d23615dfea313">box_iou</a></div><div class="ttdeci">float box_iou(box a, box b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dd1/box_8c_source.html#l00094">box.c:94</a></div></div>
<div class="ttc" id="structlayer_html_a6b8636464bcea5dea2c2235ee133af29"><div class="ttname"><a href="../../d4/db8/structlayer.html#a6b8636464bcea5dea2c2235ee133af29">layer::coords</a></div><div class="ttdeci">int coords</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00096">layer.h:96</a></div></div>
<div class="ttc" id="structlayer_html_a411feca89284377c83dd97141540dd83"><div class="ttname"><a href="../../d4/db8/structlayer.html#a411feca89284377c83dd97141540dd83">layer::random</a></div><div class="ttdeci">int random</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00121">layer.h:121</a></div></div>
<div class="ttc" id="structlayer_html_af8d01e54a44d8682c38d431c32faed45"><div class="ttname"><a href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">layer::classes</a></div><div class="ttdeci">int classes</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00095">layer.h:95</a></div></div>
<div class="ttc" id="structlayer_html_a7b07ddac3afad25586ff7c18956ba9a9"><div class="ttname"><a href="../../d4/db8/structlayer.html#a7b07ddac3afad25586ff7c18956ba9a9">layer::softmax</a></div><div class="ttdeci">int softmax</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00094">layer.h:94</a></div></div>
<div class="ttc" id="structnetwork_html_a8f391155a3ceb60caf07d0ee6c6a93f2"><div class="ttname"><a href="../../de/d45/structnetwork.html#a8f391155a3ceb60caf07d0ee6c6a93f2">network::input</a></div><div class="ttdeci">float * input</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00062">network.h:62</a></div></div>
<div class="ttc" id="structbox_html_ab25e5389fd474ccd83c7dfcf0b1f9957"><div class="ttname"><a href="../../d8/dae/structbox.html#ab25e5389fd474ccd83c7dfcf0b1f9957">box::y</a></div><div class="ttdeci">float y</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00005">box.h:5</a></div></div>
<div class="ttc" id="utils_8c_html_ab29ce45fa5e3847d0125e2e7f2e2cb44"><div class="ttname"><a href="../../d3/d91/utils_8c.html#ab29ce45fa5e3847d0125e2e7f2e2cb44">mag_array</a></div><div class="ttdeci">float mag_array(float *a, int n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00519">utils.c:519</a></div></div>
<div class="ttc" id="structlayer_html_a0874fab782ae0e8f1075cc99d776478b"><div class="ttname"><a href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">layer::outputs</a></div><div class="ttdeci">int outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00061">layer.h:61</a></div></div>
<div class="ttc" id="structlayer_html_a4cb681c94203182c328d7818bcb39de8"><div class="ttname"><a href="../../d4/db8/structlayer.html#a4cb681c94203182c328d7818bcb39de8">layer::coord_scale</a></div><div class="ttdeci">float coord_scale</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00116">layer.h:116</a></div></div>
<div class="ttc" id="structlayer_html_a9a71dbf0ad70f63a10787d8217633776"><div class="ttname"><a href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">layer::cost</a></div><div class="ttdeci">float * cost</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00141">layer.h:141</a></div></div>
<div class="ttc" id="structlayer_html_ad10b4f2f32b1991c3cd8e66d138c5eaa"><div class="ttname"><a href="../../d4/db8/structlayer.html#ad10b4f2f32b1991c3cd8e66d138c5eaa">layer::noobject_scale</a></div><div class="ttdeci">float noobject_scale</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00118">layer.h:118</a></div></div>
<div class="ttc" id="structbox_html"><div class="ttname"><a href="../../d8/dae/structbox.html">box</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00004">box.h:4</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/dbd/detection__layer_8c_a9160e6deb288c256697c0b3d3d3a7909_cgraph.png" border="0" usemap="#d7/dbd/detection__layer_8c_a9160e6deb288c256697c0b3d3d3a7909_cgraph" alt=""/></div>
<map name="d7/dbd/detection__layer_8c_a9160e6deb288c256697c0b3d3d3a7909_cgraph" id="d7/dbd/detection__layer_8c_a9160e6deb288c256697c0b3d3d3a7909_cgraph">
<area shape="rect" id="node2" href="../../d2/dd1/box_8c.html#ae14a614fc4d26ebb552d23615dfea313" title="box_iou" alt="" coords="230,5,298,31"/>
<area shape="rect" id="node6" href="../../d2/dd1/box_8c.html#a6ac422ecf58a8311afa95c9bbd701ac8" title="box_rmse" alt="" coords="224,55,304,80"/>
<area shape="rect" id="node7" href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35" title="float_to_box" alt="" coords="217,104,311,129"/>
<area shape="rect" id="node8" href="../../d3/d91/utils_8c.html#ab29ce45fa5e3847d0125e2e7f2e2cb44" title="mag_array" alt="" coords="221,153,306,179"/>
<area shape="rect" id="node9" href="../../dc/d50/blas_8c.html#a31c4f0273f3c5639ae7734d24e11274a" title="softmax" alt="" coords="230,203,298,228"/>
<area shape="rect" id="node10" href="../../d3/d91/utils_8c.html#aafc3b7bab809d8bc77b7353fd43f731b" title="top_k" alt="" coords="237,252,291,277"/>
<area shape="rect" id="node3" href="../../d2/dd1/box_8c.html#a306e7943e82df234b6f9d9c70def621c" title="box_intersection" alt="" coords="490,5,608,31"/>
<area shape="rect" id="node5" href="../../d2/dd1/box_8c.html#a6f5e94eb9c925d29647fd649799b8066" title="box_union" alt="" coords="359,31,442,56"/>
<area shape="rect" id="node4" href="../../d2/dd1/box_8c.html#a49bbaf2c74dad0f7bbca22c9e41286ca" title="overlap" alt="" coords="656,5,721,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/dbd/detection__layer_8c_a9160e6deb288c256697c0b3d3d3a7909_icgraph.png" border="0" usemap="#d7/dbd/detection__layer_8c_a9160e6deb288c256697c0b3d3d3a7909_icgraph" alt=""/></div>
<map name="d7/dbd/detection__layer_8c_a9160e6deb288c256697c0b3d3d3a7909_icgraph" id="d7/dbd/detection__layer_8c_a9160e6deb288c256697c0b3d3d3a7909_icgraph">
<area shape="rect" id="node2" href="../../d9/df7/detection__layer_8h.html#aa2d2b9d1d0ab7d8e8d69ebb468fbc475" title="get_detection_boxes" alt="" coords="581,153,725,179"/>
<area shape="rect" id="node12" href="../../d9/df7/detection__layer_8h.html#abd42da178aad193f61e7e829c34be483" title="make_detection_layer" alt="" coords="217,712,369,737"/>
<area shape="rect" id="node3" href="../../d9/d90/coco_8c.html#ac7595c589698e072c1f587df1c9d083f" title="validate_coco" alt="" coords="807,5,910,31"/>
<area shape="rect" id="node6" href="../../d9/d90/coco_8c.html#a75e914b5963bbd97ca7ab9b2d61235e4" title="validate_coco_recall" alt="" coords="787,55,929,80"/>
<area shape="rect" id="node7" href="../../d9/d90/coco_8c.html#a3750d7559afe9fbdcc98dfb5383275a7" title="test_coco" alt="" coords="819,104,897,129"/>
<area shape="rect" id="node8" href="../../d5/d37/yolo_8c.html#aa370134e19dcbef76ef234c1ab7c6065" title="validate_yolo" alt="" coords="809,153,908,179"/>
<area shape="rect" id="node10" href="../../d5/d37/yolo_8c.html#ac6827c4a08385eddc23249beab6c2893" title="validate_yolo_recall" alt="" coords="789,252,927,277"/>
<area shape="rect" id="node11" href="../../d5/d37/yolo_8c.html#ac1d1d478258afdb0266722f4a8571587" title="test_yolo" alt="" coords="821,301,895,327"/>
<area shape="rect" id="node4" href="../../dd/df8/darknet_8c.html#a9a2e98f86cd2b185650f4ec039d38b03" title="run_coco" alt="" coords="1013,104,1089,129"/>
<area shape="rect" id="node5" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1160,1419,1210,1444"/>
<area shape="rect" id="node9" href="../../d5/d37/yolo_8c.html#ae2af4814947b728e7cfafec8c446050e" title="run_yolo" alt="" coords="1015,277,1087,303"/>
<area shape="rect" id="node13" href="../../d2/d72/parser_8c.html#ab5cfcdcccf8d8f3fa5f46d4528a70cab" title="parse_detection" alt="" coords="417,815,533,840"/>
<area shape="rect" id="node14" href="../../d5/d36/parser_8h.html#abb6f2aa1c5d5bf340faae09be6538c56" title="parse_network_cfg" alt="" coords="586,1019,720,1044"/>
<area shape="rect" id="node15" href="../../d0/d8d/art_8c.html#a4e3a9eebb42ddebed7f9b187a48a2ffd" title="demo_art" alt="" coords="819,1723,897,1748"/>
<area shape="rect" id="node16" href="../../d4/d8c/captcha_8c.html#aec7b557b2068b30c22b46051b5057769" title="train_captcha" alt="" coords="807,1772,909,1797"/>
<area shape="rect" id="node17" href="../../d4/d8c/captcha_8c.html#af9f9a5158ed6aa89db115092fd4f79f0" title="test_captcha" alt="" coords="810,1821,907,1847"/>
<area shape="rect" id="node18" href="../../d4/d8c/captcha_8c.html#ae7536d1632cea9c3c5cd6198920e1422" title="valid_captcha" alt="" coords="807,1871,910,1896"/>
<area shape="rect" id="node19" href="../../da/d91/cifar_8c.html#a2bbe2cb4f41dbb42ce2f808f7c173138" title="train_cifar" alt="" coords="818,1920,898,1945"/>
<area shape="rect" id="node20" href="../../da/d91/cifar_8c.html#a05c4dceae0b08fbc5e9be8dec9da81a4" title="train_cifar_distill" alt="" coords="800,1969,917,1995"/>
<area shape="rect" id="node21" href="../../da/d91/cifar_8c.html#ae17739385f812a6432492853b42cc113" title="test_cifar_multi" alt="" coords="803,2019,914,2044"/>
<area shape="rect" id="node22" href="../../da/d91/cifar_8c.html#a957192525193e2b1c2e49623efbf886b" title="test_cifar" alt="" coords="820,2068,896,2093"/>
<area shape="rect" id="node23" href="../../da/d91/cifar_8c.html#aafb9c1ab47e6aab1e91add0fa8274df2" title="test_cifar_csv" alt="" coords="807,351,910,376"/>
<area shape="rect" id="node24" href="../../da/d91/cifar_8c.html#a9f53222883b68025e04ab97d10308c94" title="test_cifar_csvtrain" alt="" coords="794,400,923,425"/>
<area shape="rect" id="node25" href="../../d0/db9/classifier_8c.html#ad875e8ecf86a386ce16c7142484f3efb" title="train_classifier" alt="" coords="805,449,911,475"/>
<area shape="rect" id="node26" href="../../d0/db9/classifier_8c.html#a636dccf9308a3ae0dbd8660f29db4e02" title="validate_classifier_crop" alt="" coords="778,499,938,524"/>
<area shape="rect" id="node27" href="../../d0/db9/classifier_8c.html#ae6830ebfccd79c255f5cac844aa5454b" title="validate_classifier_10" alt="" coords="784,548,933,573"/>
<area shape="rect" id="node28" href="../../d0/db9/classifier_8c.html#aeae387d13aac40e2eb3aff9584f03a8b" title="validate_classifier_full" alt="" coords="783,597,934,623"/>
<area shape="rect" id="node29" href="../../d0/db9/classifier_8c.html#a654da2bb707e0b4538d2193e6d8f55d1" title="validate_classifier\l_single" alt="" coords="795,647,921,685"/>
<area shape="rect" id="node30" href="../../d0/db9/classifier_8c.html#a4b863efd1e5f3105ed4843963b8d8412" title="validate_classifier\l_multi" alt="" coords="795,709,921,748"/>
<area shape="rect" id="node31" href="../../d0/db9/classifier_8c.html#a894dd692d95f8f8a8da05dae07e60138" title="try_classifier" alt="" coords="810,772,906,797"/>
<area shape="rect" id="node32" href="../../dd/df8/darknet_8c.html#aa8603edf5e9da49cdee89b35d6bc5b42" title="predict_classifier" alt="" coords="991,1267,1112,1292"/>
<area shape="rect" id="node33" href="../../d0/db9/classifier_8c.html#a9ae475089952950f04778d56a5dd0f8e" title="label_classifier" alt="" coords="804,821,913,847"/>
<area shape="rect" id="node34" href="../../d0/db9/classifier_8c.html#aceccf5b6380cf57e56df5655b85fb52e" title="test_classifier" alt="" coords="807,871,909,896"/>
<area shape="rect" id="node35" href="../../d0/db9/classifier_8c.html#ab770e80d03219ab55ec93fdd0237f13b" title="threat_classifier" alt="" coords="801,920,915,945"/>
<area shape="rect" id="node36" href="../../d0/db9/classifier_8c.html#a8901a041f50c430e093fddb249d78d2f" title="gun_classifier" alt="" coords="807,969,910,995"/>
<area shape="rect" id="node37" href="../../d0/db9/classifier_8c.html#ac5e746c237b87dfa56d2ac1a5db9f3b9" title="demo_classifier" alt="" coords="801,1019,915,1044"/>
<area shape="rect" id="node38" href="../../d9/d90/coco_8c.html#a7d54248e7cab4c15d780458837482861" title="train_coco" alt="" coords="817,203,900,228"/>
<area shape="rect" id="node39" href="../../de/da9/compare_8c.html#aa03abf85168fca74fa66b2545bb99131" title="train_compare" alt="" coords="805,1068,911,1093"/>
<area shape="rect" id="node40" href="../../de/da9/compare_8c.html#adb3488c9a05c95cd2a6f750418122506" title="validate_compare" alt="" coords="795,1117,921,1143"/>
<area shape="rect" id="node41" href="../../de/da9/compare_8c.html#acd74ba2c82e46517734c88f503f0c012" title="SortMaster3000" alt="" coords="800,1167,916,1192"/>
<area shape="rect" id="node42" href="../../de/da9/compare_8c.html#a6cd0266d812f6bfc1892f11aa20e1ad9" title="BattleRoyaleWithCheese" alt="" coords="773,1216,943,1241"/>
<area shape="rect" id="node43" href="../../dd/df8/darknet_8c.html#a7dfa7e733fd4cb2475215182772ba1bf" title="average" alt="" coords="1016,1317,1086,1343"/>
<area shape="rect" id="node44" href="../../dd/df8/darknet_8c.html#a4c45f1bb571fe1f3c52c4f7b7d858f8d" title="speed" alt="" coords="1022,1368,1080,1393"/>
<area shape="rect" id="node45" href="../../dd/df8/darknet_8c.html#ac61af9d7b12e2d1ac431925614a3b819" title="operations" alt="" coords="1009,1419,1093,1444"/>
<area shape="rect" id="node46" href="../../dd/df8/darknet_8c.html#ab5a20c1c9997af0dec519e992b9400b9" title="oneoff" alt="" coords="1022,1468,1080,1493"/>
<area shape="rect" id="node47" href="../../dd/df8/darknet_8c.html#a40cc02a08590681209ce323ff9e22042" title="oneoff2" alt="" coords="1018,1517,1084,1543"/>
<area shape="rect" id="node48" href="../../dd/df8/darknet_8c.html#a4663de4fa674346c82a366077969fd4b" title="partial" alt="" coords="1022,1568,1080,1593"/>
<area shape="rect" id="node49" href="../../dd/df8/darknet_8c.html#a83ca859f15e1369a5e569df1a7486ebe" title="rescale_net" alt="" coords="1006,1619,1096,1644"/>
<area shape="rect" id="node50" href="../../dd/df8/darknet_8c.html#a2bc7b77a09e6cfe48e3511ff39990af4" title="rgbgr_net" alt="" coords="1012,1671,1090,1696"/>
</map>
</div>

</div>
</div>
<a id="aa2d2b9d1d0ab7d8e8d69ebb468fbc475"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2d2b9d1d0ab7d8e8d69ebb468fbc475">&#9670;&nbsp;</a></span>get_detection_boxes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_detection_boxes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/db8/structlayer.html">layer</a>&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>probs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dae/structbox.html">box</a> *&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>only_objectness</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/dbd/detection__layer_8c_source.html#l00224">224</a> of file <a class="el" href="../../d7/dbd/detection__layer_8c_source.html">detection_layer.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d3b/layer_8h_source.html#l00057">layer::batch</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00095">layer::classes</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00162">layer::delta</a>, <a class="el" href="../../d7/dbd/detection__layer_8c_source.html#l00049">forward_detection_layer()</a>, <a class="el" href="../../dc/d19/box_8h_source.html#l00005">box::h</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00060">layer::inputs</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00068">layer::n</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00163">layer::output</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00061">layer::outputs</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00072">layer::side</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00077">layer::sqrt</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00066">network::train</a>, <a class="el" href="../../dc/d19/box_8h_source.html#l00005">box::w</a>, <a class="el" href="../../dc/d19/box_8h_source.html#l00005">box::x</a>, and <a class="el" href="../../dc/d19/box_8h_source.html#l00005">box::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d90/coco_8c_source.html#l00315">test_coco()</a>, <a class="el" href="../../d5/d37/yolo_8c_source.html#l00281">test_yolo()</a>, <a class="el" href="../../d9/d90/coco_8c_source.html#l00137">validate_coco()</a>, <a class="el" href="../../d9/d90/coco_8c_source.html#l00228">validate_coco_recall()</a>, <a class="el" href="../../d5/d37/yolo_8c_source.html#l00107">validate_yolo()</a>, and <a class="el" href="../../d5/d37/yolo_8c_source.html#l00195">validate_yolo_recall()</a>.</p>
<div class="fragment"><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;{</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">int</span> i,j,<a class="code" href="../../d1/d09/structload__args.html#a46de5db87a3c8c05130d5b23a2cdea2f">n</a>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">float</span> *predictions = l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">//int per_cell = 5*num+classes;</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>; ++i){</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordtype">int</span> row = i / l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordtype">int</span> col = i % l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">for</span>(n = 0; n &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>; ++<a class="code" href="../../d1/d09/structload__args.html#a46de5db87a3c8c05130d5b23a2cdea2f">n</a>){</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="keywordtype">int</span> index = i*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + <a class="code" href="../../d1/d09/structload__args.html#a46de5db87a3c8c05130d5b23a2cdea2f">n</a>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordtype">int</span> p_index = l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>*l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a> + i*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + <a class="code" href="../../d1/d09/structload__args.html#a46de5db87a3c8c05130d5b23a2cdea2f">n</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordtype">float</span> <a class="code" href="../../d1/d09/structload__args.html#a27932099db4ddca9b7ca717f92891a44">scale</a> = predictions[p_index];</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordtype">int</span> box_index = l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>*(l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a> + l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>) + (i*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + n)*4;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            boxes[index].<a class="code" href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">x</a> = (predictions[box_index + 0] + col) / l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a> * <a class="code" href="../../d1/d09/structload__args.html#a936232a911399499924e00ba80ad16bf">w</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            boxes[index].<a class="code" href="../../d8/dae/structbox.html#ab25e5389fd474ccd83c7dfcf0b1f9957">y</a> = (predictions[box_index + 1] + row) / l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a> * <a class="code" href="../../d1/d09/structload__args.html#a9cc50b164512ec4db097288e9d569729">h</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            boxes[index].<a class="code" href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">w</a> = pow(predictions[box_index + 2], (l.<a class="code" href="../../d4/db8/structlayer.html#a30e95ebb753b16822e759bd903ca8f1a">sqrt</a>?2:1)) * <a class="code" href="../../d1/d09/structload__args.html#a936232a911399499924e00ba80ad16bf">w</a>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            boxes[index].<a class="code" href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">h</a> = pow(predictions[box_index + 3], (l.<a class="code" href="../../d4/db8/structlayer.html#a30e95ebb753b16822e759bd903ca8f1a">sqrt</a>?2:1)) * <a class="code" href="../../d1/d09/structload__args.html#a9cc50b164512ec4db097288e9d569729">h</a>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">for</span>(j = 0; j &lt; l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>; ++j){</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="keywordtype">int</span> class_index = i*l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                <span class="keywordtype">float</span> prob = scale*predictions[class_index+j];</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                probs[index][j] = (prob &gt; thresh) ? prob : 0;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="keywordflow">if</span>(only_objectness){</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                probs[index][0] = <a class="code" href="../../d1/d09/structload__args.html#a27932099db4ddca9b7ca717f92891a44">scale</a>;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div><div class="ttc" id="structlayer_html_a454b8980d0186eb0095a25aadef41744"><div class="ttname"><a href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">layer::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00068">layer.h:68</a></div></div>
<div class="ttc" id="structload__args_html_a936232a911399499924e00ba80ad16bf"><div class="ttname"><a href="../../d1/d09/structload__args.html#a936232a911399499924e00ba80ad16bf">load_args::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00042">data.h:42</a></div></div>
<div class="ttc" id="structbox_html_a56959fa604cfb411d0c001be7c444d05"><div class="ttname"><a href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">box::h</a></div><div class="ttdeci">float h</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00005">box.h:5</a></div></div>
<div class="ttc" id="structload__args_html_a9cc50b164512ec4db097288e9d569729"><div class="ttname"><a href="../../d1/d09/structload__args.html#a9cc50b164512ec4db097288e9d569729">load_args::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00041">data.h:41</a></div></div>
<div class="ttc" id="structlayer_html_a0286d4acb9afd3c080b0158bf6ef3ca1"><div class="ttname"><a href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">layer::side</a></div><div class="ttdeci">int side</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00072">layer.h:72</a></div></div>
<div class="ttc" id="structbox_html_abd9b0191e52f22befa76bcf37b9e6477"><div class="ttname"><a href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">box::w</a></div><div class="ttdeci">float w</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00005">box.h:5</a></div></div>
<div class="ttc" id="structbox_html_a26adb5cfaf492245aba926b2f212b712"><div class="ttname"><a href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">box::x</a></div><div class="ttdeci">float x</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00005">box.h:5</a></div></div>
<div class="ttc" id="structlayer_html_a04d23c71428242b3153eda588f844eb3"><div class="ttname"><a href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">layer::output</a></div><div class="ttdeci">float * output</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00163">layer.h:163</a></div></div>
<div class="ttc" id="structload__args_html_a27932099db4ddca9b7ca717f92891a44"><div class="ttname"><a href="../../d1/d09/structload__args.html#a27932099db4ddca9b7ca717f92891a44">load_args::scale</a></div><div class="ttdeci">int scale</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00051">data.h:51</a></div></div>
<div class="ttc" id="structload__args_html_a46de5db87a3c8c05130d5b23a2cdea2f"><div class="ttname"><a href="../../d1/d09/structload__args.html#a46de5db87a3c8c05130d5b23a2cdea2f">load_args::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00038">data.h:38</a></div></div>
<div class="ttc" id="structlayer_html_a30e95ebb753b16822e759bd903ca8f1a"><div class="ttname"><a href="../../d4/db8/structlayer.html#a30e95ebb753b16822e759bd903ca8f1a">layer::sqrt</a></div><div class="ttdeci">int sqrt</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00077">layer.h:77</a></div></div>
<div class="ttc" id="structlayer_html_af8d01e54a44d8682c38d431c32faed45"><div class="ttname"><a href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">layer::classes</a></div><div class="ttdeci">int classes</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00095">layer.h:95</a></div></div>
<div class="ttc" id="structbox_html_ab25e5389fd474ccd83c7dfcf0b1f9957"><div class="ttname"><a href="../../d8/dae/structbox.html#ab25e5389fd474ccd83c7dfcf0b1f9957">box::y</a></div><div class="ttdeci">float y</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00005">box.h:5</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/dbd/detection__layer_8c_aa2d2b9d1d0ab7d8e8d69ebb468fbc475_cgraph.png" border="0" usemap="#d7/dbd/detection__layer_8c_aa2d2b9d1d0ab7d8e8d69ebb468fbc475_cgraph" alt=""/></div>
<map name="d7/dbd/detection__layer_8c_aa2d2b9d1d0ab7d8e8d69ebb468fbc475_cgraph" id="d7/dbd/detection__layer_8c_aa2d2b9d1d0ab7d8e8d69ebb468fbc475_cgraph">
<area shape="rect" id="node2" href="../../d7/dbd/detection__layer_8c.html#a9160e6deb288c256697c0b3d3d3a7909" title="forward_detection_layer" alt="" coords="198,129,361,155"/>
<area shape="rect" id="node3" href="../../d2/dd1/box_8c.html#ae14a614fc4d26ebb552d23615dfea313" title="box_iou" alt="" coords="422,5,490,31"/>
<area shape="rect" id="node7" href="../../d2/dd1/box_8c.html#a6ac422ecf58a8311afa95c9bbd701ac8" title="box_rmse" alt="" coords="416,55,496,80"/>
<area shape="rect" id="node8" href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35" title="float_to_box" alt="" coords="409,104,503,129"/>
<area shape="rect" id="node9" href="../../d3/d91/utils_8c.html#ab29ce45fa5e3847d0125e2e7f2e2cb44" title="mag_array" alt="" coords="414,153,499,179"/>
<area shape="rect" id="node10" href="../../dc/d50/blas_8c.html#a31c4f0273f3c5639ae7734d24e11274a" title="softmax" alt="" coords="422,203,490,228"/>
<area shape="rect" id="node11" href="../../d3/d91/utils_8c.html#aafc3b7bab809d8bc77b7353fd43f731b" title="top_k" alt="" coords="429,252,483,277"/>
<area shape="rect" id="node4" href="../../d2/dd1/box_8c.html#a306e7943e82df234b6f9d9c70def621c" title="box_intersection" alt="" coords="682,5,801,31"/>
<area shape="rect" id="node6" href="../../d2/dd1/box_8c.html#a6f5e94eb9c925d29647fd649799b8066" title="box_union" alt="" coords="551,31,634,56"/>
<area shape="rect" id="node5" href="../../d2/dd1/box_8c.html#a49bbaf2c74dad0f7bbca22c9e41286ca" title="overlap" alt="" coords="849,5,914,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/dbd/detection__layer_8c_aa2d2b9d1d0ab7d8e8d69ebb468fbc475_icgraph.png" border="0" usemap="#d7/dbd/detection__layer_8c_aa2d2b9d1d0ab7d8e8d69ebb468fbc475_icgraph" alt=""/></div>
<map name="d7/dbd/detection__layer_8c_aa2d2b9d1d0ab7d8e8d69ebb468fbc475_icgraph" id="d7/dbd/detection__layer_8c_aa2d2b9d1d0ab7d8e8d69ebb468fbc475_icgraph">
<area shape="rect" id="node2" href="../../d9/d90/coco_8c.html#a3750d7559afe9fbdcc98dfb5383275a7" title="test_coco" alt="" coords="230,5,308,31"/>
<area shape="rect" id="node5" href="../../d5/d37/yolo_8c.html#ac1d1d478258afdb0266722f4a8571587" title="test_yolo" alt="" coords="231,153,306,179"/>
<area shape="rect" id="node7" href="../../d9/d90/coco_8c.html#ac7595c589698e072c1f587df1c9d083f" title="validate_coco" alt="" coords="217,55,320,80"/>
<area shape="rect" id="node8" href="../../d9/d90/coco_8c.html#a75e914b5963bbd97ca7ab9b2d61235e4" title="validate_coco_recall" alt="" coords="198,104,340,129"/>
<area shape="rect" id="node9" href="../../d5/d37/yolo_8c.html#aa370134e19dcbef76ef234c1ab7c6065" title="validate_yolo" alt="" coords="219,203,318,228"/>
<area shape="rect" id="node10" href="../../d5/d37/yolo_8c.html#ac6827c4a08385eddc23249beab6c2893" title="validate_yolo_recall" alt="" coords="200,252,338,277"/>
<area shape="rect" id="node3" href="../../dd/df8/darknet_8c.html#a9a2e98f86cd2b185650f4ec039d38b03" title="run_coco" alt="" coords="388,80,464,105"/>
<area shape="rect" id="node4" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="512,117,562,143"/>
<area shape="rect" id="node6" href="../../d5/d37/yolo_8c.html#ae2af4814947b728e7cfafec8c446050e" title="run_yolo" alt="" coords="390,179,462,204"/>
</map>
</div>

</div>
</div>
<a id="a7e20e8df14e9db1f8dd7f3c0b9aa1bc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e20e8df14e9db1f8dd7f3c0b9aa1bc9">&#9670;&nbsp;</a></span>make_detection_layer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/df7/detection__layer_8h.html#a3a5018a4d1685b278fc2586711a3a976">detection_layer</a> make_detection_layer </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>inputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>side</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>classes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rescore</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/dbd/detection__layer_8c_source.html#l00013">13</a> of file <a class="el" href="../../d7/dbd/detection__layer_8c_source.html">detection_layer.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d3b/layer_8h_source.html#l00050">layer::backward</a>, <a class="el" href="../../d7/dbd/detection__layer_8c_source.html#l00219">backward_detection_layer()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00053">layer::backward_gpu</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00057">layer::batch</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00095">layer::classes</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00096">layer::coords</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00141">layer::cost</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00162">layer::delta</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00020">DETECTION</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00049">layer::forward</a>, <a class="el" href="../../d7/dbd/detection__layer_8c_source.html#l00049">forward_detection_layer()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00052">layer::forward_gpu</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00066">layer::h</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00060">layer::inputs</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00068">layer::n</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00163">layer::output</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00061">layer::outputs</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00098">layer::rescore</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00072">layer::side</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00065">layer::truths</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00046">layer::type</a>, and <a class="el" href="../../d3/d3b/layer_8h_source.html#l00066">layer::w</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d72/parser_8c_source.html#l00313">parse_detection()</a>.</p>
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;{</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <a class="code" href="../../d4/db8/structlayer.html">detection_layer</a> l = {0};</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#af00e36adaf6e404a3e5234843c723714">type</a> = <a class="code" href="../../d3/d3b/layer_8h.html#a5f7e99058765b058df158c099200b154a167a7ee1aabe9f27e010fff93c0ba971">DETECTION</a>;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> = <a class="code" href="../../d1/d09/structload__args.html#a46de5db87a3c8c05130d5b23a2cdea2f">n</a>;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a> = batch;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">inputs</a> = inputs;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a> = <a class="code" href="../../d1/d09/structload__args.html#af12ce52f9bf54ea7985cb0e9b9dfaf55">classes</a>;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a6b8636464bcea5dea2c2235ee133af29">coords</a> = coords;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a662867ba4218e923a302fd215dab2ddd">rescore</a> = rescore;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a> = side;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a> = side;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> = side;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    assert(side*side*((1 + l.<a class="code" href="../../d4/db8/structlayer.html#a6b8636464bcea5dea2c2235ee133af29">coords</a>)*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>) == inputs);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">cost</a> = calloc(1, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a> = l.<a class="code" href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">inputs</a>;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a086d4ebdf69d011ef4c11a487bd5ff60">truths</a> = l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">side</a>*(1+l.<a class="code" href="../../d4/db8/structlayer.html#a6b8636464bcea5dea2c2235ee133af29">coords</a>+l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> = calloc(batch*l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a> = calloc(batch*l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#ad587958fc9c301a5987df7b3d68a09c1">forward</a> = <a class="code" href="../../d7/dbd/detection__layer_8c.html#a9160e6deb288c256697c0b3d3d3a7909">forward_detection_layer</a>;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a97391cfa71ea05cd917a3919f00e14a6">backward</a> = <a class="code" href="../../d7/dbd/detection__layer_8c.html#a46eff38e5007c73bf4de33f2b0adbd61">backward_detection_layer</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#ifdef GPU</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#ae96ac4b6c9470848c52dddc95cb14b6a">forward_gpu</a> = forward_detection_layer_gpu;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#aedf9ba6db46b7291b41f424ff6346784">backward_gpu</a> = backward_detection_layer_gpu;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    l.output_gpu = cuda_make_array(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, batch*l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    l.delta_gpu = cuda_make_array(l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, batch*l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Detection Layer\n&quot;</span>);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    srand(0);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">return</span> l;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div><div class="ttc" id="structlayer_html_a2e00450d79170c48791a1ed5a6f1d0c4"><div class="ttname"><a href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">layer::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00066">layer.h:66</a></div></div>
<div class="ttc" id="structlayer_html_a454b8980d0186eb0095a25aadef41744"><div class="ttname"><a href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">layer::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00068">layer.h:68</a></div></div>
<div class="ttc" id="structlayer_html_a086d4ebdf69d011ef4c11a487bd5ff60"><div class="ttname"><a href="../../d4/db8/structlayer.html#a086d4ebdf69d011ef4c11a487bd5ff60">layer::truths</a></div><div class="ttdeci">int truths</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00065">layer.h:65</a></div></div>
<div class="ttc" id="structlayer_html_a662867ba4218e923a302fd215dab2ddd"><div class="ttname"><a href="../../d4/db8/structlayer.html#a662867ba4218e923a302fd215dab2ddd">layer::rescore</a></div><div class="ttdeci">int rescore</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00098">layer.h:98</a></div></div>
<div class="ttc" id="structlayer_html_ae96ac4b6c9470848c52dddc95cb14b6a"><div class="ttname"><a href="../../d4/db8/structlayer.html#ae96ac4b6c9470848c52dddc95cb14b6a">layer::forward_gpu</a></div><div class="ttdeci">void(* forward_gpu)(struct layer, struct network)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00052">layer.h:52</a></div></div>
<div class="ttc" id="structlayer_html_aedf9ba6db46b7291b41f424ff6346784"><div class="ttname"><a href="../../d4/db8/structlayer.html#aedf9ba6db46b7291b41f424ff6346784">layer::backward_gpu</a></div><div class="ttdeci">void(* backward_gpu)(struct layer, struct network)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00053">layer.h:53</a></div></div>
<div class="ttc" id="detection__layer_8c_html_a46eff38e5007c73bf4de33f2b0adbd61"><div class="ttname"><a href="../../d7/dbd/detection__layer_8c.html#a46eff38e5007c73bf4de33f2b0adbd61">backward_detection_layer</a></div><div class="ttdeci">void backward_detection_layer(const detection_layer l, network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dbd/detection__layer_8c_source.html#l00219">detection_layer.c:219</a></div></div>
<div class="ttc" id="structlayer_html_ad587958fc9c301a5987df7b3d68a09c1"><div class="ttname"><a href="../../d4/db8/structlayer.html#ad587958fc9c301a5987df7b3d68a09c1">layer::forward</a></div><div class="ttdeci">void(* forward)(struct layer, struct network)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00049">layer.h:49</a></div></div>
<div class="ttc" id="detection__layer_8c_html_a9160e6deb288c256697c0b3d3d3a7909"><div class="ttname"><a href="../../d7/dbd/detection__layer_8c.html#a9160e6deb288c256697c0b3d3d3a7909">forward_detection_layer</a></div><div class="ttdeci">void forward_detection_layer(const detection_layer l, network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dbd/detection__layer_8c_source.html#l00049">detection_layer.c:49</a></div></div>
<div class="ttc" id="structlayer_html_a0286d4acb9afd3c080b0158bf6ef3ca1"><div class="ttname"><a href="../../d4/db8/structlayer.html#a0286d4acb9afd3c080b0158bf6ef3ca1">layer::side</a></div><div class="ttdeci">int side</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00072">layer.h:72</a></div></div>
<div class="ttc" id="structlayer_html_a7766d090f7dac8294b7456c1251ab485"><div class="ttname"><a href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">layer::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00066">layer.h:66</a></div></div>
<div class="ttc" id="structlayer_html_a1360cf3c28df067cc6f3af139fa95d3a"><div class="ttname"><a href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">layer::delta</a></div><div class="ttdeci">float * delta</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00162">layer.h:162</a></div></div>
<div class="ttc" id="structlayer_html_a3fac583bf31e18ca679d195b1485b316"><div class="ttname"><a href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">layer::inputs</a></div><div class="ttdeci">int inputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00060">layer.h:60</a></div></div>
<div class="ttc" id="structlayer_html_a97391cfa71ea05cd917a3919f00e14a6"><div class="ttname"><a href="../../d4/db8/structlayer.html#a97391cfa71ea05cd917a3919f00e14a6">layer::backward</a></div><div class="ttdeci">void(* backward)(struct layer, struct network)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00050">layer.h:50</a></div></div>
<div class="ttc" id="structload__args_html_af12ce52f9bf54ea7985cb0e9b9dfaf55"><div class="ttname"><a href="../../d1/d09/structload__args.html#af12ce52f9bf54ea7985cb0e9b9dfaf55">load_args::classes</a></div><div class="ttdeci">int classes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00049">data.h:49</a></div></div>
<div class="ttc" id="structlayer_html_aff6bd99e74d13cccca4c492dd3e8de9c"><div class="ttname"><a href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">layer::batch</a></div><div class="ttdeci">int batch</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00057">layer.h:57</a></div></div>
<div class="ttc" id="structlayer_html_a04d23c71428242b3153eda588f844eb3"><div class="ttname"><a href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">layer::output</a></div><div class="ttdeci">float * output</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00163">layer.h:163</a></div></div>
<div class="ttc" id="structload__args_html_a46de5db87a3c8c05130d5b23a2cdea2f"><div class="ttname"><a href="../../d1/d09/structload__args.html#a46de5db87a3c8c05130d5b23a2cdea2f">load_args::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00038">data.h:38</a></div></div>
<div class="ttc" id="structlayer_html_a6b8636464bcea5dea2c2235ee133af29"><div class="ttname"><a href="../../d4/db8/structlayer.html#a6b8636464bcea5dea2c2235ee133af29">layer::coords</a></div><div class="ttdeci">int coords</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00096">layer.h:96</a></div></div>
<div class="ttc" id="structlayer_html_af8d01e54a44d8682c38d431c32faed45"><div class="ttname"><a href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">layer::classes</a></div><div class="ttdeci">int classes</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00095">layer.h:95</a></div></div>
<div class="ttc" id="structlayer_html_af00e36adaf6e404a3e5234843c723714"><div class="ttname"><a href="../../d4/db8/structlayer.html#af00e36adaf6e404a3e5234843c723714">layer::type</a></div><div class="ttdeci">LAYER_TYPE type</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00046">layer.h:46</a></div></div>
<div class="ttc" id="structlayer_html_a0874fab782ae0e8f1075cc99d776478b"><div class="ttname"><a href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">layer::outputs</a></div><div class="ttdeci">int outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00061">layer.h:61</a></div></div>
<div class="ttc" id="structlayer_html_a9a71dbf0ad70f63a10787d8217633776"><div class="ttname"><a href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">layer::cost</a></div><div class="ttdeci">float * cost</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00141">layer.h:141</a></div></div>
<div class="ttc" id="layer_8h_html_a5f7e99058765b058df158c099200b154a167a7ee1aabe9f27e010fff93c0ba971"><div class="ttname"><a href="../../d3/d3b/layer_8h.html#a5f7e99058765b058df158c099200b154a167a7ee1aabe9f27e010fff93c0ba971">DETECTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00020">layer.h:20</a></div></div>
<div class="ttc" id="structlayer_html"><div class="ttname"><a href="../../d4/db8/structlayer.html">layer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00045">layer.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/dbd/detection__layer_8c_a7e20e8df14e9db1f8dd7f3c0b9aa1bc9_cgraph.png" border="0" usemap="#d7/dbd/detection__layer_8c_a7e20e8df14e9db1f8dd7f3c0b9aa1bc9_cgraph" alt=""/></div>
<map name="d7/dbd/detection__layer_8c_a7e20e8df14e9db1f8dd7f3c0b9aa1bc9_cgraph" id="d7/dbd/detection__layer_8c_a7e20e8df14e9db1f8dd7f3c0b9aa1bc9_cgraph">
<area shape="rect" id="node2" href="../../d7/dbd/detection__layer_8c.html#a46eff38e5007c73bf4de33f2b0adbd61" title="backward_detection\l_layer" alt="" coords="217,45,357,84"/>
<area shape="rect" id="node4" href="../../d7/dbd/detection__layer_8c.html#a9160e6deb288c256697c0b3d3d3a7909" title="forward_detection_layer" alt="" coords="205,153,369,179"/>
<area shape="rect" id="node3" href="../../dc/d50/blas_8c.html#a1af2064b6d091c8bf5565327745534fc" title="axpy_cpu" alt="" coords="425,5,503,31"/>
<area shape="rect" id="node5" href="../../d2/dd1/box_8c.html#ae14a614fc4d26ebb552d23615dfea313" title="box_iou" alt="" coords="430,55,498,80"/>
<area shape="rect" id="node9" href="../../d2/dd1/box_8c.html#a6ac422ecf58a8311afa95c9bbd701ac8" title="box_rmse" alt="" coords="424,104,504,129"/>
<area shape="rect" id="node10" href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35" title="float_to_box" alt="" coords="417,153,511,179"/>
<area shape="rect" id="node11" href="../../d3/d91/utils_8c.html#ab29ce45fa5e3847d0125e2e7f2e2cb44" title="mag_array" alt="" coords="421,203,506,228"/>
<area shape="rect" id="node12" href="../../dc/d50/blas_8c.html#a31c4f0273f3c5639ae7734d24e11274a" title="softmax" alt="" coords="430,252,498,277"/>
<area shape="rect" id="node13" href="../../d3/d91/utils_8c.html#aafc3b7bab809d8bc77b7353fd43f731b" title="top_k" alt="" coords="437,301,491,327"/>
<area shape="rect" id="node6" href="../../d2/dd1/box_8c.html#a306e7943e82df234b6f9d9c70def621c" title="box_intersection" alt="" coords="690,55,808,80"/>
<area shape="rect" id="node8" href="../../d2/dd1/box_8c.html#a6f5e94eb9c925d29647fd649799b8066" title="box_union" alt="" coords="559,80,642,105"/>
<area shape="rect" id="node7" href="../../d2/dd1/box_8c.html#a49bbaf2c74dad0f7bbca22c9e41286ca" title="overlap" alt="" coords="856,55,921,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/dbd/detection__layer_8c_a7e20e8df14e9db1f8dd7f3c0b9aa1bc9_icgraph.png" border="0" usemap="#d7/dbd/detection__layer_8c_a7e20e8df14e9db1f8dd7f3c0b9aa1bc9_icgraph" alt=""/></div>
<map name="d7/dbd/detection__layer_8c_a7e20e8df14e9db1f8dd7f3c0b9aa1bc9_icgraph" id="d7/dbd/detection__layer_8c_a7e20e8df14e9db1f8dd7f3c0b9aa1bc9_icgraph">
<area shape="rect" id="node2" href="../../d2/d72/parser_8c.html#ab5cfcdcccf8d8f3fa5f46d4528a70cab" title="parse_detection" alt="" coords="205,1167,321,1192"/>
<area shape="rect" id="node3" href="../../d5/d36/parser_8h.html#abb6f2aa1c5d5bf340faae09be6538c56" title="parse_network_cfg" alt="" coords="369,1167,503,1192"/>
<area shape="rect" id="node4" href="../../d0/d8d/art_8c.html#a4e3a9eebb42ddebed7f9b187a48a2ffd" title="demo_art" alt="" coords="597,5,675,31"/>
<area shape="rect" id="node5" href="../../d4/d8c/captcha_8c.html#aec7b557b2068b30c22b46051b5057769" title="train_captcha" alt="" coords="585,55,687,80"/>
<area shape="rect" id="node6" href="../../d4/d8c/captcha_8c.html#af9f9a5158ed6aa89db115092fd4f79f0" title="test_captcha" alt="" coords="588,104,685,129"/>
<area shape="rect" id="node7" href="../../d4/d8c/captcha_8c.html#ae7536d1632cea9c3c5cd6198920e1422" title="valid_captcha" alt="" coords="585,153,688,179"/>
<area shape="rect" id="node8" href="../../da/d91/cifar_8c.html#a2bbe2cb4f41dbb42ce2f808f7c173138" title="train_cifar" alt="" coords="596,203,676,228"/>
<area shape="rect" id="node9" href="../../da/d91/cifar_8c.html#a05c4dceae0b08fbc5e9be8dec9da81a4" title="train_cifar_distill" alt="" coords="578,252,695,277"/>
<area shape="rect" id="node10" href="../../da/d91/cifar_8c.html#ae17739385f812a6432492853b42cc113" title="test_cifar_multi" alt="" coords="581,301,692,327"/>
<area shape="rect" id="node11" href="../../da/d91/cifar_8c.html#a957192525193e2b1c2e49623efbf886b" title="test_cifar" alt="" coords="598,351,674,376"/>
<area shape="rect" id="node12" href="../../da/d91/cifar_8c.html#aafb9c1ab47e6aab1e91add0fa8274df2" title="test_cifar_csv" alt="" coords="585,400,688,425"/>
<area shape="rect" id="node13" href="../../da/d91/cifar_8c.html#a9f53222883b68025e04ab97d10308c94" title="test_cifar_csvtrain" alt="" coords="572,449,700,475"/>
<area shape="rect" id="node14" href="../../d0/db9/classifier_8c.html#ad875e8ecf86a386ce16c7142484f3efb" title="train_classifier" alt="" coords="583,499,689,524"/>
<area shape="rect" id="node15" href="../../d0/db9/classifier_8c.html#a636dccf9308a3ae0dbd8660f29db4e02" title="validate_classifier_crop" alt="" coords="556,548,716,573"/>
<area shape="rect" id="node16" href="../../d0/db9/classifier_8c.html#ae6830ebfccd79c255f5cac844aa5454b" title="validate_classifier_10" alt="" coords="562,597,711,623"/>
<area shape="rect" id="node17" href="../../d0/db9/classifier_8c.html#aeae387d13aac40e2eb3aff9584f03a8b" title="validate_classifier_full" alt="" coords="561,647,712,672"/>
<area shape="rect" id="node18" href="../../d0/db9/classifier_8c.html#a654da2bb707e0b4538d2193e6d8f55d1" title="validate_classifier\l_single" alt="" coords="573,696,699,735"/>
<area shape="rect" id="node19" href="../../d0/db9/classifier_8c.html#a4b863efd1e5f3105ed4843963b8d8412" title="validate_classifier\l_multi" alt="" coords="573,759,699,797"/>
<area shape="rect" id="node20" href="../../d0/db9/classifier_8c.html#a894dd692d95f8f8a8da05dae07e60138" title="try_classifier" alt="" coords="588,821,684,847"/>
<area shape="rect" id="node21" href="../../dd/df8/darknet_8c.html#aa8603edf5e9da49cdee89b35d6bc5b42" title="predict_classifier" alt="" coords="576,871,696,896"/>
<area shape="rect" id="node22" href="../../d0/db9/classifier_8c.html#a9ae475089952950f04778d56a5dd0f8e" title="label_classifier" alt="" coords="582,920,690,945"/>
<area shape="rect" id="node23" href="../../d0/db9/classifier_8c.html#aceccf5b6380cf57e56df5655b85fb52e" title="test_classifier" alt="" coords="585,969,687,995"/>
<area shape="rect" id="node24" href="../../d0/db9/classifier_8c.html#ab770e80d03219ab55ec93fdd0237f13b" title="threat_classifier" alt="" coords="579,1019,693,1044"/>
<area shape="rect" id="node25" href="../../d0/db9/classifier_8c.html#a8901a041f50c430e093fddb249d78d2f" title="gun_classifier" alt="" coords="585,1068,688,1093"/>
<area shape="rect" id="node26" href="../../d0/db9/classifier_8c.html#ac5e746c237b87dfa56d2ac1a5db9f3b9" title="demo_classifier" alt="" coords="579,1117,693,1143"/>
<area shape="rect" id="node27" href="../../d9/d90/coco_8c.html#a7d54248e7cab4c15d780458837482861" title="train_coco" alt="" coords="595,1167,678,1192"/>
<area shape="rect" id="node28" href="../../d9/d90/coco_8c.html#ac7595c589698e072c1f587df1c9d083f" title="validate_coco" alt="" coords="585,1216,688,1241"/>
<area shape="rect" id="node29" href="../../d9/d90/coco_8c.html#a75e914b5963bbd97ca7ab9b2d61235e4" title="validate_coco_recall" alt="" coords="565,1265,707,1291"/>
<area shape="rect" id="node30" href="../../d9/d90/coco_8c.html#a3750d7559afe9fbdcc98dfb5383275a7" title="test_coco" alt="" coords="597,1315,675,1340"/>
<area shape="rect" id="node31" href="../../de/da9/compare_8c.html#aa03abf85168fca74fa66b2545bb99131" title="train_compare" alt="" coords="583,1364,689,1389"/>
<area shape="rect" id="node32" href="../../de/da9/compare_8c.html#adb3488c9a05c95cd2a6f750418122506" title="validate_compare" alt="" coords="573,1413,699,1439"/>
<area shape="rect" id="node33" href="../../de/da9/compare_8c.html#acd74ba2c82e46517734c88f503f0c012" title="SortMaster3000" alt="" coords="578,1463,694,1488"/>
<area shape="rect" id="node34" href="../../de/da9/compare_8c.html#a6cd0266d812f6bfc1892f11aa20e1ad9" title="BattleRoyaleWithCheese" alt="" coords="551,1512,721,1537"/>
<area shape="rect" id="node35" href="../../dd/df8/darknet_8c.html#a7dfa7e733fd4cb2475215182772ba1bf" title="average" alt="" coords="601,1561,671,1587"/>
<area shape="rect" id="node36" href="../../dd/df8/darknet_8c.html#a4c45f1bb571fe1f3c52c4f7b7d858f8d" title="speed" alt="" coords="607,1611,665,1636"/>
<area shape="rect" id="node37" href="../../dd/df8/darknet_8c.html#ac61af9d7b12e2d1ac431925614a3b819" title="operations" alt="" coords="594,1660,678,1685"/>
<area shape="rect" id="node38" href="../../dd/df8/darknet_8c.html#ab5a20c1c9997af0dec519e992b9400b9" title="oneoff" alt="" coords="607,1709,665,1735"/>
<area shape="rect" id="node39" href="../../dd/df8/darknet_8c.html#a40cc02a08590681209ce323ff9e22042" title="oneoff2" alt="" coords="603,1759,669,1784"/>
<area shape="rect" id="node40" href="../../dd/df8/darknet_8c.html#a4663de4fa674346c82a366077969fd4b" title="partial" alt="" coords="607,1808,665,1833"/>
<area shape="rect" id="node41" href="../../dd/df8/darknet_8c.html#a83ca859f15e1369a5e569df1a7486ebe" title="rescale_net" alt="" coords="591,1857,681,1883"/>
<area shape="rect" id="node42" href="../../dd/df8/darknet_8c.html#a2bc7b77a09e6cfe48e3511ff39990af4" title="rgbgr_net" alt="" coords="597,1907,675,1932"/>
<area shape="rect" id="node43" href="../../dd/df8/darknet_8c.html#a69898d896e1117395eae539fa27b4eee" title="reset_normalize_net" alt="" coords="565,1956,707,1981"/>
<area shape="rect" id="node44" href="../../dd/df8/darknet_8c.html#a6a824943f20fa1121776a2a4fd6f1b03" title="normalize_net" alt="" coords="584,2005,689,2031"/>
<area shape="rect" id="node45" href="../../dd/df8/darknet_8c.html#ab619dcce0bf0acf8db3db0d86dfa83de" title="statistics_net" alt="" coords="587,2055,685,2080"/>
<area shape="rect" id="node46" href="../../dd/df8/darknet_8c.html#a59310cd440b860b5f21bd6e3ffef65d0" title="denormalize_net" alt="" coords="576,2104,696,2129"/>
<area shape="rect" id="node47" href="../../dd/df8/darknet_8c.html#a2b74a3332b1c442875e900ee9254649c" title="visualize" alt="" coords="600,2153,672,2179"/>
<area shape="rect" id="node48" href="../../df/d09/detector_8c.html#ae007089ceccb49a69ffa696a4f8dd78a" title="train_detector" alt="" coords="585,2203,688,2228"/>
<area shape="rect" id="node49" href="../../df/d09/detector_8c.html#a8e19e1fdfb2b82b5ce3b72bc8580d8e3" title="validate_detector_flip" alt="" coords="562,2252,710,2277"/>
<area shape="rect" id="node50" href="../../df/d09/detector_8c.html#aea37ad211a83b40620a2df0eb6623a66" title="validate_detector" alt="" coords="575,2301,698,2327"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat May 27 2017 01:13:32 for Darknet by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
