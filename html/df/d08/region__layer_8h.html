<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Darknet: region_layer.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Darknet
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">region_layer.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../d3/d3b/layer_8h_source.html">layer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/d94/network_8h_source.html">network.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for region_layer.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d7d/region__layer_8h__incl.png" border="0" usemap="#region__layer_8h" alt=""/></div>
<map name="region__layer_8h" id="region__layer_8h">
<area shape="rect" id="node2" href="../../d3/d3b/layer_8h.html" title="layer.h" alt="" coords="151,152,211,177"/>
<area shape="rect" id="node8" href="../../d9/d94/network_8h.html" title="network.h" alt="" coords="219,79,298,104"/>
<area shape="rect" id="node3" href="../../de/d92/activations_8h.html" title="activations.h" alt="" coords="99,225,194,251"/>
<area shape="rect" id="node7" href="../../d3/d09/tree_8h.html" title="tree.h" alt="" coords="219,225,274,251"/>
<area shape="rect" id="node4" href="../../dc/d57/cuda_8h.html" title="cuda.h" alt="" coords="40,299,101,324"/>
<area shape="rect" id="node9" href="../../d5/db2/image_8h.html" title="image.h" alt="" coords="299,225,367,251"/>
<area shape="rect" id="node15" href="../../d2/dbd/data_8h.html" title="data.h" alt="" coords="392,152,450,177"/>
<area shape="rect" id="node14" href="../../dc/d19/box_8h.html" title="box.h" alt="" coords="466,299,520,324"/>
<area shape="rect" id="node17" href="../../dd/df4/matrix_8h.html" title="matrix.h" alt="" coords="493,225,562,251"/>
<area shape="rect" id="node18" href="../../da/d23/list_8h.html" title="list.h" alt="" coords="586,225,635,251"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/db2/region__layer_8h__dep__incl.png" border="0" usemap="#region__layer_8hdep" alt=""/></div>
<map name="region__layer_8hdep" id="region__layer_8hdep">
<area shape="rect" id="node2" href="../../de/d15/demo_8c.html" title="demo.c" alt="" coords="5,79,70,104"/>
<area shape="rect" id="node3" href="../../df/d09/detector_8c.html" title="detector.c" alt="" coords="94,79,173,104"/>
<area shape="rect" id="node4" href="../../d6/d6e/network_8c.html" title="network.c" alt="" coords="197,79,276,104"/>
<area shape="rect" id="node5" href="../../dd/d03/nightmare_8c.html" title="nightmare.c" alt="" coords="300,79,391,104"/>
<area shape="rect" id="node6" href="../../d2/d72/parser_8c.html" title="parser.c" alt="" coords="415,79,484,104"/>
<area shape="rect" id="node7" href="../../d3/d74/region__layer_8c.html" title="region_layer.c" alt="" coords="508,79,613,104"/>
</map>
</div>
</div>
<p><a href="../../df/d08/region__layer_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab5954d5e5ba84cb866c518c7f6847bf0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/db8/structlayer.html">layer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d08/region__layer_8h.html#ab5954d5e5ba84cb866c518c7f6847bf0">make_region_layer</a> (int batch, int h, int w, int n, int classes, int coords)</td></tr>
<tr class="separator:ab5954d5e5ba84cb866c518c7f6847bf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7df2017786a6b8cc6dc6a15d5024d6b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d08/region__layer_8h.html#a7df2017786a6b8cc6dc6a15d5024d6b1">forward_region_layer</a> (const <a class="el" href="../../d4/db8/structlayer.html">layer</a> l, <a class="el" href="../../de/d45/structnetwork.html">network</a> net)</td></tr>
<tr class="separator:a7df2017786a6b8cc6dc6a15d5024d6b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1823033f070004078252d6c00eb27039"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d08/region__layer_8h.html#a1823033f070004078252d6c00eb27039">backward_region_layer</a> (const <a class="el" href="../../d4/db8/structlayer.html">layer</a> l, <a class="el" href="../../de/d45/structnetwork.html">network</a> net)</td></tr>
<tr class="separator:a1823033f070004078252d6c00eb27039"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07c0e92090deac070be99cd552dfe39f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d08/region__layer_8h.html#a07c0e92090deac070be99cd552dfe39f">get_region_boxes</a> (<a class="el" href="../../d4/db8/structlayer.html">layer</a> l, int w, int h, int netw, int neth, float thresh, float **probs, <a class="el" href="../../d8/dae/structbox.html">box</a> *boxes, int only_objectness, int *map, float tree_thresh, int relative)</td></tr>
<tr class="separator:a07c0e92090deac070be99cd552dfe39f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a882147a796b341f5ec5989f0e71b7797"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d08/region__layer_8h.html#a882147a796b341f5ec5989f0e71b7797">resize_region_layer</a> (<a class="el" href="../../d4/db8/structlayer.html">layer</a> *l, int w, int h)</td></tr>
<tr class="separator:a882147a796b341f5ec5989f0e71b7797"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a482d1347c52a7651d858f842518c705e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d08/region__layer_8h.html#a482d1347c52a7651d858f842518c705e">zero_objectness</a> (<a class="el" href="../../d4/db8/structlayer.html">layer</a> l)</td></tr>
<tr class="separator:a482d1347c52a7651d858f842518c705e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1823033f070004078252d6c00eb27039"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1823033f070004078252d6c00eb27039">&#9670;&nbsp;</a></span>backward_region_layer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void backward_region_layer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/db8/structlayer.html">layer</a>&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d45/structnetwork.html">network</a>&#160;</td>
          <td class="paramname"><em>net</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00305">305</a> of file <a class="el" href="../../d3/d74/region__layer_8c_source.html">region_layer.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00012">make_region_layer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;{</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">       int b;</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">       int size = l.coords + l.classes + 1;</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">       for (b = 0; b &lt; l.batch*l.n; ++b){</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">       int index = (b*size + 4)*l.w*l.h;</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">       gradient_array(l.output + index, l.w*l.h, LOGISTIC, l.delta + index);</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">       }</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">       axpy_cpu(l.batch*l.inputs, 1, l.delta, 1, net.delta, 1);</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d08/region__layer_8h_a1823033f070004078252d6c00eb27039_icgraph.png" border="0" usemap="#df/d08/region__layer_8h_a1823033f070004078252d6c00eb27039_icgraph" alt=""/></div>
<map name="df/d08/region__layer_8h_a1823033f070004078252d6c00eb27039_icgraph" id="df/d08/region__layer_8h_a1823033f070004078252d6c00eb27039_icgraph">
<area shape="rect" id="node2" href="../../df/d08/region__layer_8h.html#ab5954d5e5ba84cb866c518c7f6847bf0" title="make_region_layer" alt="" coords="213,1116,347,1141"/>
<area shape="rect" id="node3" href="../../d2/d72/parser_8c.html#afedfffed817f89349b250c4afe09041c" title="parse_region" alt="" coords="395,1116,494,1141"/>
<area shape="rect" id="node4" href="../../d5/d36/parser_8h.html#abb6f2aa1c5d5bf340faae09be6538c56" title="parse_network_cfg" alt="" coords="542,1116,676,1141"/>
<area shape="rect" id="node5" href="../../dd/df8/darknet_8c.html#a7dfa7e733fd4cb2475215182772ba1bf" title="average" alt="" coords="774,5,844,31"/>
<area shape="rect" id="node6" href="../../de/da9/compare_8c.html#a6cd0266d812f6bfc1892f11aa20e1ad9" title="BattleRoyaleWithCheese" alt="" coords="724,55,894,80"/>
<area shape="rect" id="node7" href="../../d0/d8d/art_8c.html#a4e3a9eebb42ddebed7f9b187a48a2ffd" title="demo_art" alt="" coords="770,104,848,129"/>
<area shape="rect" id="node8" href="../../d0/db9/classifier_8c.html#ac5e746c237b87dfa56d2ac1a5db9f3b9" title="demo_classifier" alt="" coords="752,153,866,179"/>
<area shape="rect" id="node9" href="../../dd/d39/regressor_8c.html#a181855118700a6d23f313581c7adce44" title="demo_regressor" alt="" coords="750,203,868,228"/>
<area shape="rect" id="node10" href="../../dd/df8/darknet_8c.html#a59310cd440b860b5f21bd6e3ffef65d0" title="denormalize_net" alt="" coords="749,252,869,277"/>
<area shape="rect" id="node11" href="../../db/d2a/go_8c.html#a634a03028ba512387aae19012c424818" title="engine_go" alt="" coords="767,301,851,327"/>
<area shape="rect" id="node12" href="../../d0/db9/classifier_8c.html#a8901a041f50c430e093fddb249d78d2f" title="gun_classifier" alt="" coords="758,351,861,376"/>
<area shape="rect" id="node13" href="../../d0/db9/classifier_8c.html#a9ae475089952950f04778d56a5dd0f8e" title="label_classifier" alt="" coords="755,400,864,425"/>
<area shape="rect" id="node14" href="../../d9/d94/network_8h.html#aa06b8ad6a6fb64daed0801ad5d4009a2" title="load_network" alt="" coords="759,449,860,475"/>
<area shape="rect" id="node15" href="../../dd/df8/darknet_8c.html#a6a824943f20fa1121776a2a4fd6f1b03" title="normalize_net" alt="" coords="757,499,862,524"/>
<area shape="rect" id="node16" href="../../dd/df8/darknet_8c.html#ab5a20c1c9997af0dec519e992b9400b9" title="oneoff" alt="" coords="780,548,838,573"/>
<area shape="rect" id="node17" href="../../dd/df8/darknet_8c.html#a40cc02a08590681209ce323ff9e22042" title="oneoff2" alt="" coords="776,597,842,623"/>
<area shape="rect" id="node18" href="../../dd/df8/darknet_8c.html#ac61af9d7b12e2d1ac431925614a3b819" title="operations" alt="" coords="767,647,851,672"/>
<area shape="rect" id="node19" href="../../dd/df8/darknet_8c.html#a4663de4fa674346c82a366077969fd4b" title="partial" alt="" coords="780,696,838,721"/>
<area shape="rect" id="node20" href="../../dd/df8/darknet_8c.html#aa8603edf5e9da49cdee89b35d6bc5b42" title="predict_classifier" alt="" coords="749,745,870,771"/>
<area shape="rect" id="node21" href="../../dd/d39/regressor_8c.html#afbc61c04e3612e9d511bd4a7f599f63a" title="predict_regressor" alt="" coords="747,795,872,820"/>
<area shape="rect" id="node22" href="../../dd/df8/darknet_8c.html#a83ca859f15e1369a5e569df1a7486ebe" title="rescale_net" alt="" coords="764,844,854,869"/>
<area shape="rect" id="node23" href="../../dd/df8/darknet_8c.html#a69898d896e1117395eae539fa27b4eee" title="reset_normalize_net" alt="" coords="738,893,880,919"/>
<area shape="rect" id="node24" href="../../dd/df8/darknet_8c.html#a2bc7b77a09e6cfe48e3511ff39990af4" title="rgbgr_net" alt="" coords="770,943,848,968"/>
<area shape="rect" id="node25" href="../../dd/d03/nightmare_8c.html#aaefb0ed0f5bd621bb9e131e2bc1b4852" title="run_nightmare" alt="" coords="756,992,863,1017"/>
<area shape="rect" id="node26" href="../../db/d2a/go_8c.html#aef3d780fb37b0f0a08f1eb90a807247a" title="self_go" alt="" coords="777,1041,841,1067"/>
<area shape="rect" id="node27" href="../../de/da9/compare_8c.html#acd74ba2c82e46517734c88f503f0c012" title="SortMaster3000" alt="" coords="751,1091,867,1116"/>
<area shape="rect" id="node28" href="../../dd/df8/darknet_8c.html#a4c45f1bb571fe1f3c52c4f7b7d858f8d" title="speed" alt="" coords="780,1140,838,1165"/>
<area shape="rect" id="node29" href="../../dd/df8/darknet_8c.html#ab619dcce0bf0acf8db3db0d86dfa83de" title="statistics_net" alt="" coords="760,1189,858,1215"/>
<area shape="rect" id="node30" href="../../d4/d8c/captcha_8c.html#af9f9a5158ed6aa89db115092fd4f79f0" title="test_captcha" alt="" coords="761,1239,858,1264"/>
<area shape="rect" id="node31" href="../../d6/d8c/rnn_8c.html#a83c8cf9106e2cf81b55677f13f480a68" title="test_char_rnn" alt="" coords="758,1288,861,1313"/>
<area shape="rect" id="node32" href="../../da/d91/cifar_8c.html#a957192525193e2b1c2e49623efbf886b" title="test_cifar" alt="" coords="771,1337,847,1363"/>
<area shape="rect" id="node33" href="../../da/d91/cifar_8c.html#aafb9c1ab47e6aab1e91add0fa8274df2" title="test_cifar_csv" alt="" coords="758,1387,861,1412"/>
<area shape="rect" id="node34" href="../../da/d91/cifar_8c.html#a9f53222883b68025e04ab97d10308c94" title="test_cifar_csvtrain" alt="" coords="745,1436,874,1461"/>
<area shape="rect" id="node35" href="../../da/d91/cifar_8c.html#ae17739385f812a6432492853b42cc113" title="test_cifar_multi" alt="" coords="754,1485,865,1511"/>
<area shape="rect" id="node36" href="../../d0/db9/classifier_8c.html#aceccf5b6380cf57e56df5655b85fb52e" title="test_classifier" alt="" coords="758,1535,860,1560"/>
<area shape="rect" id="node37" href="../../d9/d90/coco_8c.html#a3750d7559afe9fbdcc98dfb5383275a7" title="test_coco" alt="" coords="770,1584,848,1609"/>
<area shape="rect" id="node38" href="../../d2/da6/lsd_8c.html#a0ff5b76eeaf6a6f3ea748d9e7d02de52" title="test_dcgan" alt="" coords="766,1633,852,1659"/>
<area shape="rect" id="node39" href="../../df/d09/detector_8c.html#ad29ded4bbd1d823ecf9a61135e0710cb" title="test_detector" alt="" coords="760,1683,858,1708"/>
<area shape="rect" id="node40" href="../../d1/dec/dice_8c.html#abd03f638bd52a2b4175189748e496ac9" title="test_dice" alt="" coords="772,1732,847,1757"/>
<area shape="rect" id="node41" href="../../db/d2a/go_8c.html#a88ad2f96f9ea8092406bcb8f1873e92d" title="test_go" alt="" coords="777,1781,842,1807"/>
<area shape="rect" id="node42" href="../../d2/da6/lsd_8c.html#abcf2acb0200df9fc8e4d96d998658bdd" title="test_lsd" alt="" coords="776,1831,843,1856"/>
<area shape="rect" id="node43" href="../../d2/d1d/super_8c.html#aad6e292cdad8f47b71375c0e09959863" title="test_super" alt="" coords="767,1880,851,1905"/>
<area shape="rect" id="node44" href="../../d6/d8c/rnn_8c.html#a073f6bb832965a03274a7c44921d19af" title="test_tactic_rnn" alt="" coords="755,1929,863,1955"/>
<area shape="rect" id="node45" href="../../d4/db3/tag_8c.html#a88156b8acbfb7f72b07a839a3f8505bd" title="test_tag" alt="" coords="775,1979,844,2004"/>
<area shape="rect" id="node46" href="../../da/d6c/voxel_8c.html#ae712ed693cfbc02f6869fcccaac711e8" title="test_voxel" alt="" coords="769,2028,850,2053"/>
<area shape="rect" id="node47" href="../../da/d32/writing_8c.html#af7c6f6ae0cf9711426c11a9e7929fe5c" title="test_writing" alt="" coords="765,2077,854,2103"/>
<area shape="rect" id="node48" href="../../d5/d37/yolo_8c.html#ac1d1d478258afdb0266722f4a8571587" title="test_yolo" alt="" coords="772,2127,847,2152"/>
<area shape="rect" id="node49" href="../../d0/db9/classifier_8c.html#ab770e80d03219ab55ec93fdd0237f13b" title="threat_classifier" alt="" coords="752,2176,867,2201"/>
<area shape="rect" id="node50" href="../../d4/d8c/captcha_8c.html#aec7b557b2068b30c22b46051b5057769" title="train_captcha" alt="" coords="758,2225,860,2251"/>
</map>
</div>

</div>
</div>
<a id="a7df2017786a6b8cc6dc6a15d5024d6b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7df2017786a6b8cc6dc6a15d5024d6b1">&#9670;&nbsp;</a></span>forward_region_layer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void forward_region_layer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/db8/structlayer.html">layer</a>&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d45/structnetwork.html">network</a>&#160;</td>
          <td class="paramname"><em>net</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00145">145</a> of file <a class="el" href="../../d3/d74/region__layer_8c_source.html">region_layer.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d2e/activations_8c_source.html#l00095">activate_array()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00057">layer::batch</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00120">layer::bias_match</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00153">layer::biases</a>, <a class="el" href="../../d2/dd1/box_8c_source.html#l00094">box_iou()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00119">layer::class_scale</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00095">layer::classes</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00116">layer::coord_scale</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00141">layer::cost</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00162">layer::delta</a>, <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00085">delta_region_box()</a>, <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00102">delta_region_class()</a>, <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00137">entry_index()</a>, <a class="el" href="../../d2/dd1/box_8c_source.html#l00006">float_to_box()</a>, <a class="el" href="../../de/dc8/tree_8c_source.html#l00027">get_hierarchy_probability()</a>, <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00075">get_region_box()</a>, <a class="el" href="../../d3/d09/tree_8h_source.html#l00013">tree::group_size</a>, <a class="el" href="../../d3/d09/tree_8h_source.html#l00012">tree::groups</a>, <a class="el" href="../../dc/d19/box_8h_source.html#l00005">box::h</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00066">layer::h</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00062">network::input</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00060">layer::inputs</a>, <a class="el" href="../../de/d92/activations_8h_source.html#l00007">LOGISTIC</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00519">mag_array()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00139">layer::map</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00068">layer::n</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00118">layer::noobject_scale</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00117">layer::object_scale</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00163">layer::output</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00061">layer::outputs</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00098">layer::rescore</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00017">network::seen</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00094">layer::softmax</a>, <a class="el" href="../../dc/d50/blas_8c_source.html#l00234">softmax_cpu()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00214">layer::softmax_tree</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00131">layer::temperature</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00122">layer::thresh</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00066">network::train</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00063">network::truth</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00065">layer::truths</a>, <a class="el" href="../../dc/d19/box_8h_source.html#l00005">box::w</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00066">layer::w</a>, <a class="el" href="../../dc/d19/box_8h_source.html#l00005">box::x</a>, and <a class="el" href="../../dc/d19/box_8h_source.html#l00005">box::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00346">get_region_boxes()</a>, and <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00012">make_region_layer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">int</span> i,j,b,t,n;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    memcpy(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, net.<a class="code" href="../../de/d45/structnetwork.html#a8f391155a3ceb60caf07d0ee6c6a93f2">input</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#ifndef GPU</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">for</span> (b = 0; b &lt; l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>; ++b){</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">for</span>(n = 0; n &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>; ++n){</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordtype">int</span> index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, b, n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, 0);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <a class="code" href="../../dd/d2e/activations_8c.html#a9c58c2e7b5e7ea90cf75f18c97e78dc8">activate_array</a>(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> + index, 2*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, <a class="code" href="../../de/d92/activations_8h.html#aea09b678fab8ab931902378cbbd79032a42472611591399e9deba20bd204fd056">LOGISTIC</a>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, b, n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, 4);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <a class="code" href="../../dd/d2e/activations_8c.html#a9c58c2e7b5e7ea90cf75f18c97e78dc8">activate_array</a>(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> + index,   l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, <a class="code" href="../../de/d92/activations_8h.html#aea09b678fab8ab931902378cbbd79032a42472611591399e9deba20bd204fd056">LOGISTIC</a>);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/db8/structlayer.html#ada8540db939d29074a5764ac9ba92f57">softmax_tree</a>){</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordtype">int</span> count = 5;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; l.<a class="code" href="../../d4/db8/structlayer.html#ada8540db939d29074a5764ac9ba92f57">softmax_tree</a>-&gt;<a class="code" href="../../dc/d20/structtree.html#ab4d92fc866330ea5e427d6b5b8075604">groups</a>; ++i) {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordtype">int</span> group_size = l.<a class="code" href="../../d4/db8/structlayer.html#ada8540db939d29074a5764ac9ba92f57">softmax_tree</a>-&gt;<a class="code" href="../../dc/d20/structtree.html#a4b84be443f42bcf6cc16fd9d3fa1f326">group_size</a>[i];</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="../../dc/d50/blas_8c.html#ad328f3d0648b19a98fafc221e43ed73d">softmax_cpu</a>(net.<a class="code" href="../../de/d45/structnetwork.html#a8f391155a3ceb60caf07d0ee6c6a93f2">input</a> + count, group_size, l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">inputs</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, 1, l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a965290dca263c7774c9e9b4272a43c49">temperature</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> + count);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            count += group_size;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/db8/structlayer.html#a7b07ddac3afad25586ff7c18956ba9a9">softmax</a>){</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordtype">int</span> index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, 0, 0, 5);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <a class="code" href="../../dc/d50/blas_8c.html#ad328f3d0648b19a98fafc221e43ed73d">softmax_cpu</a>(net.<a class="code" href="../../de/d45/structnetwork.html#a8f391155a3ceb60caf07d0ee6c6a93f2">input</a> + index, l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>, l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">inputs</a>/l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, 1, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, 1, l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> + index);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    memset(l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, 0, l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a> * l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span>(!net.<a class="code" href="../../de/d45/structnetwork.html#a32e7b55fe8dfa07391b6cdce17b4a2c1">train</a>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">float</span> avg_iou = 0;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">float</span> recall = 0;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">float</span> avg_cat = 0;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">float</span> avg_obj = 0;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">float</span> avg_anyobj = 0;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">int</span> count = 0;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">int</span> class_count = 0;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    *(l.<a class="code" href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">cost</a>) = 0;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">for</span> (b = 0; b &lt; l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>; ++b) {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">if</span>(l.<a class="code" href="../../d4/db8/structlayer.html#ada8540db939d29074a5764ac9ba92f57">softmax_tree</a>){</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keywordtype">int</span> onlyclass = 0;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keywordflow">for</span>(t = 0; t &lt; 30; ++t){</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                <a class="code" href="../../d8/dae/structbox.html">box</a> truth = <a class="code" href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35">float_to_box</a>(net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a> + t*5 + b*l.<a class="code" href="../../d4/db8/structlayer.html#a086d4ebdf69d011ef4c11a487bd5ff60">truths</a>, 1);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                <span class="keywordflow">if</span>(!truth.<a class="code" href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">x</a>) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                <span class="keywordtype">int</span> <span class="keyword">class </span>= net.truth[t*5 + b*l.<a class="code" href="../../d4/db8/structlayer.html#a086d4ebdf69d011ef4c11a487bd5ff60">truths</a> + 4];</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="keywordtype">float</span> maxp = 0;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="keywordtype">int</span> maxi = 0;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <span class="keywordflow">if</span>(truth.<a class="code" href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">x</a> &gt; 100000 &amp;&amp; truth.<a class="code" href="../../d8/dae/structbox.html#ab25e5389fd474ccd83c7dfcf0b1f9957">y</a> &gt; 100000){</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    <span class="keywordflow">for</span>(n = 0; n &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>; ++n){</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                        <span class="keywordtype">int</span> class_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, b, n, 5);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                        <span class="keywordtype">int</span> obj_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, b, n, 4);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                        <span class="keywordtype">float</span> scale =  l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[obj_index];</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[obj_index] = l.<a class="code" href="../../d4/db8/structlayer.html#ad10b4f2f32b1991c3cd8e66d138c5eaa">noobject_scale</a> * (0 - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[obj_index]);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                        <span class="keywordtype">float</span> p = scale*<a class="code" href="../../de/dc8/tree_8c.html#a4f7eed900e89ca83188960a695529f92">get_hierarchy_probability</a>(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> + class_index, l.<a class="code" href="../../d4/db8/structlayer.html#ada8540db939d29074a5764ac9ba92f57">softmax_tree</a>, <span class="keyword">class</span>, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                        <span class="keywordflow">if</span>(p &gt; maxp){</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                            maxp = p;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                            maxi = n;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                        }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    <span class="keywordtype">int</span> class_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, b, maxi, 5);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    <span class="keywordtype">int</span> obj_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, b, maxi, 4);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    <a class="code" href="../../d3/d74/region__layer_8c.html#aa771812f7eca72867188ba440d6d00ac">delta_region_class</a>(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, class_index, <span class="keyword">class</span>, l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>, l.<a class="code" href="../../d4/db8/structlayer.html#ada8540db939d29074a5764ac9ba92f57">softmax_tree</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a7175af778d4be5a066ccc212421617b7">class_scale</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, &amp;avg_cat);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                    <span class="keywordflow">if</span>(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[obj_index] &lt; .3) l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[obj_index] = l.<a class="code" href="../../d4/db8/structlayer.html#a502c7f71d253c01f1724adbe8bc585fc">object_scale</a> * (.3 - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[obj_index]);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                    <span class="keywordflow">else</span>  l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[obj_index] = 0;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                    ++class_count;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                    onlyclass = 1;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="keywordflow">if</span>(onlyclass) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>; ++j) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>; ++i) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <span class="keywordflow">for</span> (n = 0; n &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>; ++n) {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                    <span class="keywordtype">int</span> box_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, b, n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + j*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a> + i, 0);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    <a class="code" href="../../d8/dae/structbox.html">box</a> pred = <a class="code" href="../../d3/d74/region__layer_8c.html#aca90641426af39fb8ed8f9f4ea292e92">get_region_box</a>(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, l.<a class="code" href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">biases</a>, n, box_index, i, j, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    <span class="keywordtype">float</span> best_iou = 0;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    <span class="keywordflow">for</span>(t = 0; t &lt; 30; ++t){</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                        <a class="code" href="../../d8/dae/structbox.html">box</a> truth = <a class="code" href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35">float_to_box</a>(net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a> + t*5 + b*l.<a class="code" href="../../d4/db8/structlayer.html#a086d4ebdf69d011ef4c11a487bd5ff60">truths</a>, 1);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                        <span class="keywordflow">if</span>(!truth.<a class="code" href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">x</a>) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                        <span class="keywordtype">float</span> iou = <a class="code" href="../../d2/dd1/box_8c.html#ae14a614fc4d26ebb552d23615dfea313">box_iou</a>(pred, truth);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                        <span class="keywordflow">if</span> (iou &gt; best_iou) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                            best_iou = iou;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                        }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                    }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    <span class="keywordtype">int</span> obj_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, b, n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + j*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a> + i, 4);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    avg_anyobj += l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[obj_index];</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                    l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[obj_index] = l.<a class="code" href="../../d4/db8/structlayer.html#ad10b4f2f32b1991c3cd8e66d138c5eaa">noobject_scale</a> * (0 - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[obj_index]);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                    <span class="keywordflow">if</span> (best_iou &gt; l.<a class="code" href="../../d4/db8/structlayer.html#a20c059ef419e2b863c67d4df87ec4488">thresh</a>) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                        l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[obj_index] = 0;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                    }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    <span class="keywordflow">if</span>(*(net.<a class="code" href="../../de/d45/structnetwork.html#ad1b060aa7e1bfd54e25448f1783733d6">seen</a>) &lt; 12800){</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                        <a class="code" href="../../d8/dae/structbox.html">box</a> truth = {0};</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                        truth.<a class="code" href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">x</a> = (i + .5)/l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                        truth.<a class="code" href="../../d8/dae/structbox.html#ab25e5389fd474ccd83c7dfcf0b1f9957">y</a> = (j + .5)/l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                        truth.<a class="code" href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">w</a> = l.<a class="code" href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">biases</a>[2*n]/l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                        truth.<a class="code" href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">h</a> = l.<a class="code" href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">biases</a>[2*n+1]/l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                        <a class="code" href="../../d3/d74/region__layer_8c.html#a745171a1090e6f08bd824fb47b764216">delta_region_box</a>(truth, l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, l.<a class="code" href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">biases</a>, n, box_index, i, j, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, .01, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">for</span>(t = 0; t &lt; 30; ++t){</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <a class="code" href="../../d8/dae/structbox.html">box</a> truth = <a class="code" href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35">float_to_box</a>(net.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a> + t*5 + b*l.<a class="code" href="../../d4/db8/structlayer.html#a086d4ebdf69d011ef4c11a487bd5ff60">truths</a>, 1);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keywordflow">if</span>(!truth.<a class="code" href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">x</a>) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keywordtype">float</span> best_iou = 0;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordtype">int</span> best_n = 0;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            i = (truth.<a class="code" href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">x</a> * l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            j = (truth.<a class="code" href="../../d8/dae/structbox.html#ab25e5389fd474ccd83c7dfcf0b1f9957">y</a> * l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="comment">//printf(&quot;%d %f %d %f\n&quot;, i, truth.x*l.w, j, truth.y*l.h);</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <a class="code" href="../../d8/dae/structbox.html">box</a> truth_shift = truth;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            truth_shift.<a class="code" href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">x</a> = 0;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            truth_shift.<a class="code" href="../../d8/dae/structbox.html#ab25e5389fd474ccd83c7dfcf0b1f9957">y</a> = 0;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="comment">//printf(&quot;index %d %d\n&quot;,i, j);</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keywordflow">for</span>(n = 0; n &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>; ++n){</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                <span class="keywordtype">int</span> box_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, b, n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + j*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a> + i, 0);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <a class="code" href="../../d8/dae/structbox.html">box</a> pred = <a class="code" href="../../d3/d74/region__layer_8c.html#aca90641426af39fb8ed8f9f4ea292e92">get_region_box</a>(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, l.<a class="code" href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">biases</a>, n, box_index, i, j, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="keywordflow">if</span>(l.<a class="code" href="../../d4/db8/structlayer.html#a9f5919edff3bdaa0e3f02f13728415c3">bias_match</a>){</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    pred.<a class="code" href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">w</a> = l.<a class="code" href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">biases</a>[2*n]/l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    pred.<a class="code" href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">h</a> = l.<a class="code" href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">biases</a>[2*n+1]/l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                <span class="comment">//printf(&quot;pred: (%f, %f) %f x %f\n&quot;, pred.x, pred.y, pred.w, pred.h);</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                pred.<a class="code" href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">x</a> = 0;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                pred.<a class="code" href="../../d8/dae/structbox.html#ab25e5389fd474ccd83c7dfcf0b1f9957">y</a> = 0;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="keywordtype">float</span> iou = <a class="code" href="../../d2/dd1/box_8c.html#ae14a614fc4d26ebb552d23615dfea313">box_iou</a>(pred, truth_shift);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="keywordflow">if</span> (iou &gt; best_iou){</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    best_iou = iou;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    best_n = n;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="comment">//printf(&quot;%d %f (%f, %f) %f x %f\n&quot;, best_n, best_iou, truth.x, truth.y, truth.w, truth.h);</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="keywordtype">int</span> box_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, b, best_n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + j*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a> + i, 0);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordtype">float</span> iou = <a class="code" href="../../d3/d74/region__layer_8c.html#a745171a1090e6f08bd824fb47b764216">delta_region_box</a>(truth, l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, l.<a class="code" href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">biases</a>, best_n, box_index, i, j, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a4cb681c94203182c328d7818bcb39de8">coord_scale</a> *  (2 - truth.<a class="code" href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">w</a>*truth.<a class="code" href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">h</a>), l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordflow">if</span>(iou &gt; .5) recall += 1;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            avg_iou += iou;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="comment">//l.delta[best_index + 4] = iou - l.output[best_index + 4];</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordtype">int</span> obj_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, b, best_n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + j*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a> + i, 4);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            avg_obj += l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[obj_index];</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[obj_index] = l.<a class="code" href="../../d4/db8/structlayer.html#a502c7f71d253c01f1724adbe8bc585fc">object_scale</a> * (1 - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[obj_index]);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/db8/structlayer.html#a662867ba4218e923a302fd215dab2ddd">rescore</a>) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>[obj_index] = l.<a class="code" href="../../d4/db8/structlayer.html#a502c7f71d253c01f1724adbe8bc585fc">object_scale</a> * (iou - l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[obj_index]);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="keywordtype">int</span> <span class="keyword">class </span>= net.truth[t*5 + b*l.<a class="code" href="../../d4/db8/structlayer.html#a086d4ebdf69d011ef4c11a487bd5ff60">truths</a> + 4];</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/db8/structlayer.html#a9950b1b44120256269e082cb5efbd42e">map</a>) <span class="keyword">class </span>= l.map[class];</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="keywordtype">int</span> class_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, b, best_n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + j*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a> + i, 5);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <a class="code" href="../../d3/d74/region__layer_8c.html#aa771812f7eca72867188ba440d6d00ac">delta_region_class</a>(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, class_index, <span class="keyword">class</span>, l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>, l.<a class="code" href="../../d4/db8/structlayer.html#ada8540db939d29074a5764ac9ba92f57">softmax_tree</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a7175af778d4be5a066ccc212421617b7">class_scale</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, &amp;avg_cat);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            ++count;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            ++class_count;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">//printf(&quot;\n&quot;);</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    *(l.<a class="code" href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">cost</a>) = pow(<a class="code" href="../../d3/d91/utils_8c.html#ab29ce45fa5e3847d0125e2e7f2e2cb44">mag_array</a>(l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a> * l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>), 2);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    printf(<span class="stringliteral">&quot;Region Avg IOU: %f, Class: %f, Obj: %f, No Obj: %f, Avg Recall: %f,  count: %d\n&quot;</span>, avg_iou/count, avg_cat/class_count, avg_obj/count, avg_anyobj/(l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>*l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>), recall/count, count);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div><div class="ttc" id="structnetwork_html_ad1b060aa7e1bfd54e25448f1783733d6"><div class="ttname"><a href="../../de/d45/structnetwork.html#ad1b060aa7e1bfd54e25448f1783733d6">network::seen</a></div><div class="ttdeci">int * seen</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00017">network.h:17</a></div></div>
<div class="ttc" id="structlayer_html_a20c059ef419e2b863c67d4df87ec4488"><div class="ttname"><a href="../../d4/db8/structlayer.html#a20c059ef419e2b863c67d4df87ec4488">layer::thresh</a></div><div class="ttdeci">float thresh</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00122">layer.h:122</a></div></div>
<div class="ttc" id="structlayer_html_a502c7f71d253c01f1724adbe8bc585fc"><div class="ttname"><a href="../../d4/db8/structlayer.html#a502c7f71d253c01f1724adbe8bc585fc">layer::object_scale</a></div><div class="ttdeci">float object_scale</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00117">layer.h:117</a></div></div>
<div class="ttc" id="structlayer_html_aaa7f20cb294d09ee0011d32658675a48"><div class="ttname"><a href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">layer::biases</a></div><div class="ttdeci">float * biases</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00153">layer.h:153</a></div></div>
<div class="ttc" id="structlayer_html_a965290dca263c7774c9e9b4272a43c49"><div class="ttname"><a href="../../d4/db8/structlayer.html#a965290dca263c7774c9e9b4272a43c49">layer::temperature</a></div><div class="ttdeci">float temperature</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00131">layer.h:131</a></div></div>
<div class="ttc" id="structlayer_html_a9950b1b44120256269e082cb5efbd42e"><div class="ttname"><a href="../../d4/db8/structlayer.html#a9950b1b44120256269e082cb5efbd42e">layer::map</a></div><div class="ttdeci">int * map</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00139">layer.h:139</a></div></div>
<div class="ttc" id="box_8c_html_a3a91c383316adfc6dfc023e2168d0f35"><div class="ttname"><a href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35">float_to_box</a></div><div class="ttdeci">box float_to_box(float *f, int stride)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dd1/box_8c_source.html#l00006">box.c:6</a></div></div>
<div class="ttc" id="structlayer_html_a2e00450d79170c48791a1ed5a6f1d0c4"><div class="ttname"><a href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">layer::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00066">layer.h:66</a></div></div>
<div class="ttc" id="structlayer_html_a454b8980d0186eb0095a25aadef41744"><div class="ttname"><a href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">layer::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00068">layer.h:68</a></div></div>
<div class="ttc" id="structlayer_html_a086d4ebdf69d011ef4c11a487bd5ff60"><div class="ttname"><a href="../../d4/db8/structlayer.html#a086d4ebdf69d011ef4c11a487bd5ff60">layer::truths</a></div><div class="ttdeci">int truths</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00065">layer.h:65</a></div></div>
<div class="ttc" id="structlayer_html_a662867ba4218e923a302fd215dab2ddd"><div class="ttname"><a href="../../d4/db8/structlayer.html#a662867ba4218e923a302fd215dab2ddd">layer::rescore</a></div><div class="ttdeci">int rescore</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00098">layer.h:98</a></div></div>
<div class="ttc" id="structbox_html_a56959fa604cfb411d0c001be7c444d05"><div class="ttname"><a href="../../d8/dae/structbox.html#a56959fa604cfb411d0c001be7c444d05">box::h</a></div><div class="ttdeci">float h</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00005">box.h:5</a></div></div>
<div class="ttc" id="structnetwork_html_a1453c2cf9a735bde55a281d698797a05"><div class="ttname"><a href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">network::truth</a></div><div class="ttdeci">float * truth</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00063">network.h:63</a></div></div>
<div class="ttc" id="activations_8h_html_aea09b678fab8ab931902378cbbd79032a42472611591399e9deba20bd204fd056"><div class="ttname"><a href="../../de/d92/activations_8h.html#aea09b678fab8ab931902378cbbd79032a42472611591399e9deba20bd204fd056">LOGISTIC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d92/activations_8h_source.html#l00007">activations.h:7</a></div></div>
<div class="ttc" id="structlayer_html_a7175af778d4be5a066ccc212421617b7"><div class="ttname"><a href="../../d4/db8/structlayer.html#a7175af778d4be5a066ccc212421617b7">layer::class_scale</a></div><div class="ttdeci">float class_scale</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00119">layer.h:119</a></div></div>
<div class="ttc" id="region__layer_8c_html_ac3c785a8f7fdc0d10f1c4330bee08b48"><div class="ttname"><a href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a></div><div class="ttdeci">int entry_index(layer l, int batch, int location, int entry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d74/region__layer_8c_source.html#l00137">region_layer.c:137</a></div></div>
<div class="ttc" id="structbox_html_abd9b0191e52f22befa76bcf37b9e6477"><div class="ttname"><a href="../../d8/dae/structbox.html#abd9b0191e52f22befa76bcf37b9e6477">box::w</a></div><div class="ttdeci">float w</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00005">box.h:5</a></div></div>
<div class="ttc" id="region__layer_8c_html_aca90641426af39fb8ed8f9f4ea292e92"><div class="ttname"><a href="../../d3/d74/region__layer_8c.html#aca90641426af39fb8ed8f9f4ea292e92">get_region_box</a></div><div class="ttdeci">box get_region_box(float *x, float *biases, int n, int index, int i, int j, int w, int h, int stride)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d74/region__layer_8c_source.html#l00075">region_layer.c:75</a></div></div>
<div class="ttc" id="structtree_html_ab4d92fc866330ea5e427d6b5b8075604"><div class="ttname"><a href="../../dc/d20/structtree.html#ab4d92fc866330ea5e427d6b5b8075604">tree::groups</a></div><div class="ttdeci">int groups</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d09/tree_8h_source.html#l00012">tree.h:12</a></div></div>
<div class="ttc" id="blas_8c_html_ad328f3d0648b19a98fafc221e43ed73d"><div class="ttname"><a href="../../dc/d50/blas_8c.html#ad328f3d0648b19a98fafc221e43ed73d">softmax_cpu</a></div><div class="ttdeci">void softmax_cpu(float *input, int n, int batch, int batch_offset, int groups, int group_offset, int stride, float temp, float *output)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/blas_8c_source.html#l00234">blas.c:234</a></div></div>
<div class="ttc" id="structbox_html_a26adb5cfaf492245aba926b2f212b712"><div class="ttname"><a href="../../d8/dae/structbox.html#a26adb5cfaf492245aba926b2f212b712">box::x</a></div><div class="ttdeci">float x</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00005">box.h:5</a></div></div>
<div class="ttc" id="structnetwork_html_a32e7b55fe8dfa07391b6cdce17b4a2c1"><div class="ttname"><a href="../../de/d45/structnetwork.html#a32e7b55fe8dfa07391b6cdce17b4a2c1">network::train</a></div><div class="ttdeci">int train</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00066">network.h:66</a></div></div>
<div class="ttc" id="structlayer_html_a7766d090f7dac8294b7456c1251ab485"><div class="ttname"><a href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">layer::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00066">layer.h:66</a></div></div>
<div class="ttc" id="structlayer_html_a1360cf3c28df067cc6f3af139fa95d3a"><div class="ttname"><a href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">layer::delta</a></div><div class="ttdeci">float * delta</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00162">layer.h:162</a></div></div>
<div class="ttc" id="structlayer_html_a3fac583bf31e18ca679d195b1485b316"><div class="ttname"><a href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">layer::inputs</a></div><div class="ttdeci">int inputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00060">layer.h:60</a></div></div>
<div class="ttc" id="structlayer_html_aff6bd99e74d13cccca4c492dd3e8de9c"><div class="ttname"><a href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">layer::batch</a></div><div class="ttdeci">int batch</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00057">layer.h:57</a></div></div>
<div class="ttc" id="region__layer_8c_html_a745171a1090e6f08bd824fb47b764216"><div class="ttname"><a href="../../d3/d74/region__layer_8c.html#a745171a1090e6f08bd824fb47b764216">delta_region_box</a></div><div class="ttdeci">float delta_region_box(box truth, float *x, float *biases, int n, int index, int i, int j, int w, int h, float *delta, float scale, int stride)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d74/region__layer_8c_source.html#l00085">region_layer.c:85</a></div></div>
<div class="ttc" id="structlayer_html_a04d23c71428242b3153eda588f844eb3"><div class="ttname"><a href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">layer::output</a></div><div class="ttdeci">float * output</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00163">layer.h:163</a></div></div>
<div class="ttc" id="structtree_html_a4b84be443f42bcf6cc16fd9d3fa1f326"><div class="ttname"><a href="../../dc/d20/structtree.html#a4b84be443f42bcf6cc16fd9d3fa1f326">tree::group_size</a></div><div class="ttdeci">int * group_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d09/tree_8h_source.html#l00013">tree.h:13</a></div></div>
<div class="ttc" id="box_8c_html_ae14a614fc4d26ebb552d23615dfea313"><div class="ttname"><a href="../../d2/dd1/box_8c.html#ae14a614fc4d26ebb552d23615dfea313">box_iou</a></div><div class="ttdeci">float box_iou(box a, box b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dd1/box_8c_source.html#l00094">box.c:94</a></div></div>
<div class="ttc" id="activations_8c_html_a9c58c2e7b5e7ea90cf75f18c97e78dc8"><div class="ttname"><a href="../../dd/d2e/activations_8c.html#a9c58c2e7b5e7ea90cf75f18c97e78dc8">activate_array</a></div><div class="ttdeci">void activate_array(float *x, const int n, const ACTIVATION a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2e/activations_8c_source.html#l00095">activations.c:95</a></div></div>
<div class="ttc" id="region__layer_8c_html_aa771812f7eca72867188ba440d6d00ac"><div class="ttname"><a href="../../d3/d74/region__layer_8c.html#aa771812f7eca72867188ba440d6d00ac">delta_region_class</a></div><div class="ttdeci">void delta_region_class(float *output, float *delta, int index, int class, int classes, tree *hier, float scale, int stride, float *avg_cat)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d74/region__layer_8c_source.html#l00102">region_layer.c:102</a></div></div>
<div class="ttc" id="structlayer_html_af8d01e54a44d8682c38d431c32faed45"><div class="ttname"><a href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">layer::classes</a></div><div class="ttdeci">int classes</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00095">layer.h:95</a></div></div>
<div class="ttc" id="structlayer_html_a7b07ddac3afad25586ff7c18956ba9a9"><div class="ttname"><a href="../../d4/db8/structlayer.html#a7b07ddac3afad25586ff7c18956ba9a9">layer::softmax</a></div><div class="ttdeci">int softmax</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00094">layer.h:94</a></div></div>
<div class="ttc" id="structnetwork_html_a8f391155a3ceb60caf07d0ee6c6a93f2"><div class="ttname"><a href="../../de/d45/structnetwork.html#a8f391155a3ceb60caf07d0ee6c6a93f2">network::input</a></div><div class="ttdeci">float * input</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00062">network.h:62</a></div></div>
<div class="ttc" id="structlayer_html_a9f5919edff3bdaa0e3f02f13728415c3"><div class="ttname"><a href="../../d4/db8/structlayer.html#a9f5919edff3bdaa0e3f02f13728415c3">layer::bias_match</a></div><div class="ttdeci">int bias_match</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00120">layer.h:120</a></div></div>
<div class="ttc" id="structbox_html_ab25e5389fd474ccd83c7dfcf0b1f9957"><div class="ttname"><a href="../../d8/dae/structbox.html#ab25e5389fd474ccd83c7dfcf0b1f9957">box::y</a></div><div class="ttdeci">float y</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00005">box.h:5</a></div></div>
<div class="ttc" id="structlayer_html_ada8540db939d29074a5764ac9ba92f57"><div class="ttname"><a href="../../d4/db8/structlayer.html#ada8540db939d29074a5764ac9ba92f57">layer::softmax_tree</a></div><div class="ttdeci">tree * softmax_tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00214">layer.h:214</a></div></div>
<div class="ttc" id="utils_8c_html_ab29ce45fa5e3847d0125e2e7f2e2cb44"><div class="ttname"><a href="../../d3/d91/utils_8c.html#ab29ce45fa5e3847d0125e2e7f2e2cb44">mag_array</a></div><div class="ttdeci">float mag_array(float *a, int n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00519">utils.c:519</a></div></div>
<div class="ttc" id="structlayer_html_a0874fab782ae0e8f1075cc99d776478b"><div class="ttname"><a href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">layer::outputs</a></div><div class="ttdeci">int outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00061">layer.h:61</a></div></div>
<div class="ttc" id="structlayer_html_a4cb681c94203182c328d7818bcb39de8"><div class="ttname"><a href="../../d4/db8/structlayer.html#a4cb681c94203182c328d7818bcb39de8">layer::coord_scale</a></div><div class="ttdeci">float coord_scale</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00116">layer.h:116</a></div></div>
<div class="ttc" id="tree_8c_html_a4f7eed900e89ca83188960a695529f92"><div class="ttname"><a href="../../de/dc8/tree_8c.html#a4f7eed900e89ca83188960a695529f92">get_hierarchy_probability</a></div><div class="ttdeci">float get_hierarchy_probability(float *x, tree *hier, int c, int stride)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc8/tree_8c_source.html#l00027">tree.c:27</a></div></div>
<div class="ttc" id="structlayer_html_a9a71dbf0ad70f63a10787d8217633776"><div class="ttname"><a href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">layer::cost</a></div><div class="ttdeci">float * cost</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00141">layer.h:141</a></div></div>
<div class="ttc" id="structlayer_html_ad10b4f2f32b1991c3cd8e66d138c5eaa"><div class="ttname"><a href="../../d4/db8/structlayer.html#ad10b4f2f32b1991c3cd8e66d138c5eaa">layer::noobject_scale</a></div><div class="ttdeci">float noobject_scale</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00118">layer.h:118</a></div></div>
<div class="ttc" id="structbox_html"><div class="ttname"><a href="../../d8/dae/structbox.html">box</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d19/box_8h_source.html#l00004">box.h:4</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d08/region__layer_8h_a7df2017786a6b8cc6dc6a15d5024d6b1_cgraph.png" border="0" usemap="#df/d08/region__layer_8h_a7df2017786a6b8cc6dc6a15d5024d6b1_cgraph" alt=""/></div>
<map name="df/d08/region__layer_8h_a7df2017786a6b8cc6dc6a15d5024d6b1_cgraph" id="df/d08/region__layer_8h_a7df2017786a6b8cc6dc6a15d5024d6b1_cgraph">
<area shape="rect" id="node2" href="../../dd/d2e/activations_8c.html#a9c58c2e7b5e7ea90cf75f18c97e78dc8" title="activate_array" alt="" coords="233,424,338,449"/>
<area shape="rect" id="node17" href="../../d2/dd1/box_8c.html#ae14a614fc4d26ebb552d23615dfea313" title="box_iou" alt="" coords="441,648,509,673"/>
<area shape="rect" id="node21" href="../../d3/d74/region__layer_8c.html#a745171a1090e6f08bd824fb47b764216" title="delta_region_box" alt="" coords="223,648,347,673"/>
<area shape="rect" id="node22" href="../../d3/d74/region__layer_8c.html#aca90641426af39fb8ed8f9f4ea292e92" title="get_region_box" alt="" coords="418,699,531,724"/>
<area shape="rect" id="node23" href="../../d3/d74/region__layer_8c.html#aa771812f7eca72867188ba440d6d00ac" title="delta_region_class" alt="" coords="219,749,351,775"/>
<area shape="rect" id="node24" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48" title="entry_index" alt="" coords="240,799,330,824"/>
<area shape="rect" id="node25" href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35" title="float_to_box" alt="" coords="238,848,332,873"/>
<area shape="rect" id="node26" href="../../de/dc8/tree_8c.html#a4f7eed900e89ca83188960a695529f92" title="get_hierarchy_probability" alt="" coords="200,897,370,923"/>
<area shape="rect" id="node27" href="../../d3/d91/utils_8c.html#ab29ce45fa5e3847d0125e2e7f2e2cb44" title="mag_array" alt="" coords="243,947,328,972"/>
<area shape="rect" id="node28" href="../../dc/d50/blas_8c.html#ad328f3d0648b19a98fafc221e43ed73d" title="softmax_cpu" alt="" coords="237,996,334,1021"/>
<area shape="rect" id="node3" href="../../dd/d2e/activations_8c.html#a031d574d016f6a31eae5bbddfbac3dc5" title="activate" alt="" coords="441,327,509,352"/>
<area shape="rect" id="node4" href="../../de/d92/activations_8h.html#acce967bf6526bd7994919b94b5b3af14" title="elu_activate" alt="" coords="593,5,686,31"/>
<area shape="rect" id="node5" href="../../de/d92/activations_8h.html#ae2948bccc35ed0c3387f7d3c8ec79787" title="hardtan_activate" alt="" coords="579,55,699,80"/>
<area shape="rect" id="node6" href="../../de/d92/activations_8h.html#a5a6368990806124d3250b333ed565b4a" title="leaky_activate" alt="" coords="587,104,692,129"/>
<area shape="rect" id="node7" href="../../de/d92/activations_8h.html#acc9d7e9215ddc5c6a01dcafb3d796e27" title="lhtan_activate" alt="" coords="588,153,691,179"/>
<area shape="rect" id="node8" href="../../de/d92/activations_8h.html#a1f5850078bfdb4497930848b0f2038e6" title="linear_activate" alt="" coords="586,203,693,228"/>
<area shape="rect" id="node9" href="../../de/d92/activations_8h.html#a44310fdff610a48bdf99bb1c77802660" title="loggy_activate" alt="" coords="586,252,693,277"/>
<area shape="rect" id="node10" href="../../de/d92/activations_8h.html#a851af6d779ff52c59d910f3692565361" title="logistic_activate" alt="" coords="582,301,697,327"/>
<area shape="rect" id="node11" href="../../de/d92/activations_8h.html#a6b8b9d9498305d2ef7000dd6a1f818bc" title="plse_activate" alt="" coords="590,351,689,376"/>
<area shape="rect" id="node12" href="../../de/d92/activations_8h.html#a86e53d56302efa6b39c8728066ceb14a" title="ramp_activate" alt="" coords="587,400,692,425"/>
<area shape="rect" id="node13" href="../../de/d92/activations_8h.html#a4e3cc496939c8e1b87a15de3c87df807" title="relie_activate" alt="" coords="590,449,689,475"/>
<area shape="rect" id="node14" href="../../de/d92/activations_8h.html#a6fb9a058235cf6c731a6eb3ee8616fd7" title="relu_activate" alt="" coords="591,499,688,524"/>
<area shape="rect" id="node15" href="../../de/d92/activations_8h.html#aac25575dac41b794e1f4fff6ad56e6c7" title="stair_activate" alt="" coords="590,548,689,573"/>
<area shape="rect" id="node16" href="../../de/d92/activations_8h.html#abe8175839177b65bd6b33c32200f348c" title="tanh_activate" alt="" coords="589,597,690,623"/>
<area shape="rect" id="node18" href="../../d2/dd1/box_8c.html#a306e7943e82df234b6f9d9c70def621c" title="box_intersection" alt="" coords="747,673,866,699"/>
<area shape="rect" id="node20" href="../../d2/dd1/box_8c.html#a6f5e94eb9c925d29647fd649799b8066" title="box_union" alt="" coords="598,699,681,724"/>
<area shape="rect" id="node19" href="../../d2/dd1/box_8c.html#a49bbaf2c74dad0f7bbca22c9e41286ca" title="overlap" alt="" coords="914,673,979,699"/>
<area shape="rect" id="node29" href="../../dc/d50/blas_8c.html#a31c4f0273f3c5639ae7734d24e11274a" title="softmax" alt="" coords="441,996,509,1021"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d08/region__layer_8h_a7df2017786a6b8cc6dc6a15d5024d6b1_icgraph.png" border="0" usemap="#df/d08/region__layer_8h_a7df2017786a6b8cc6dc6a15d5024d6b1_icgraph" alt=""/></div>
<map name="df/d08/region__layer_8h_a7df2017786a6b8cc6dc6a15d5024d6b1_icgraph" id="df/d08/region__layer_8h_a7df2017786a6b8cc6dc6a15d5024d6b1_icgraph">
<area shape="rect" id="node2" href="../../df/d08/region__layer_8h.html#a07c0e92090deac070be99cd552dfe39f" title="get_region_boxes" alt="" coords="533,104,660,129"/>
<area shape="rect" id="node9" href="../../df/d08/region__layer_8h.html#ab5954d5e5ba84cb866c518c7f6847bf0" title="make_region_layer" alt="" coords="200,713,335,739"/>
<area shape="rect" id="node3" href="../../df/d09/detector_8c.html#a8e19e1fdfb2b82b5ce3b72bc8580d8e3" title="validate_detector_flip" alt="" coords="723,5,870,31"/>
<area shape="rect" id="node6" href="../../df/d09/detector_8c.html#aea37ad211a83b40620a2df0eb6623a66" title="validate_detector" alt="" coords="735,55,858,80"/>
<area shape="rect" id="node7" href="../../df/d09/detector_8c.html#a4f5828b59e5940a47f390c2e430fd3d4" title="validate_detector_recall" alt="" coords="716,104,878,129"/>
<area shape="rect" id="node8" href="../../df/d09/detector_8c.html#ad29ded4bbd1d823ecf9a61135e0710cb" title="test_detector" alt="" coords="747,153,846,179"/>
<area shape="rect" id="node4" href="../../df/d09/detector_8c.html#a677c1747fd7a58c7f7da3314af5d6120" title="run_detector" alt="" coords="952,104,1049,129"/>
<area shape="rect" id="node5" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1120,1075,1170,1100"/>
<area shape="rect" id="node10" href="../../d2/d72/parser_8c.html#afedfffed817f89349b250c4afe09041c" title="parse_region" alt="" coords="383,800,482,825"/>
<area shape="rect" id="node11" href="../../d5/d36/parser_8h.html#abb6f2aa1c5d5bf340faae09be6538c56" title="parse_network_cfg" alt="" coords="530,1024,664,1049"/>
<area shape="rect" id="node12" href="../../dd/df8/darknet_8c.html#a7dfa7e733fd4cb2475215182772ba1bf" title="average" alt="" coords="966,796,1035,821"/>
<area shape="rect" id="node13" href="../../de/da9/compare_8c.html#a6cd0266d812f6bfc1892f11aa20e1ad9" title="BattleRoyaleWithCheese" alt="" coords="712,1505,881,1531"/>
<area shape="rect" id="node14" href="../../d0/d8d/art_8c.html#a4e3a9eebb42ddebed7f9b187a48a2ffd" title="demo_art" alt="" coords="758,1555,835,1580"/>
<area shape="rect" id="node15" href="../../d0/db9/classifier_8c.html#ac5e746c237b87dfa56d2ac1a5db9f3b9" title="demo_classifier" alt="" coords="740,1604,854,1629"/>
<area shape="rect" id="node16" href="../../dd/d39/regressor_8c.html#a181855118700a6d23f313581c7adce44" title="demo_regressor" alt="" coords="737,1653,856,1679"/>
<area shape="rect" id="node17" href="../../dd/df8/darknet_8c.html#a59310cd440b860b5f21bd6e3ffef65d0" title="denormalize_net" alt="" coords="940,847,1060,872"/>
<area shape="rect" id="node18" href="../../db/d2a/go_8c.html#a634a03028ba512387aae19012c424818" title="engine_go" alt="" coords="755,1703,838,1728"/>
<area shape="rect" id="node19" href="../../d0/db9/classifier_8c.html#a8901a041f50c430e093fddb249d78d2f" title="gun_classifier" alt="" coords="745,1752,848,1777"/>
<area shape="rect" id="node20" href="../../d0/db9/classifier_8c.html#a9ae475089952950f04778d56a5dd0f8e" title="label_classifier" alt="" coords="742,1801,851,1827"/>
<area shape="rect" id="node21" href="../../d9/d94/network_8h.html#aa06b8ad6a6fb64daed0801ad5d4009a2" title="load_network" alt="" coords="746,1851,847,1876"/>
<area shape="rect" id="node22" href="../../dd/df8/darknet_8c.html#a6a824943f20fa1121776a2a4fd6f1b03" title="normalize_net" alt="" coords="948,897,1053,923"/>
<area shape="rect" id="node23" href="../../dd/df8/darknet_8c.html#ab5a20c1c9997af0dec519e992b9400b9" title="oneoff" alt="" coords="971,948,1030,973"/>
<area shape="rect" id="node24" href="../../dd/df8/darknet_8c.html#a40cc02a08590681209ce323ff9e22042" title="oneoff2" alt="" coords="968,999,1033,1024"/>
<area shape="rect" id="node25" href="../../dd/df8/darknet_8c.html#ac61af9d7b12e2d1ac431925614a3b819" title="operations" alt="" coords="959,1049,1042,1075"/>
<area shape="rect" id="node26" href="../../dd/df8/darknet_8c.html#a4663de4fa674346c82a366077969fd4b" title="partial" alt="" coords="972,1100,1029,1125"/>
<area shape="rect" id="node27" href="../../dd/df8/darknet_8c.html#aa8603edf5e9da49cdee89b35d6bc5b42" title="predict_classifier" alt="" coords="940,1149,1061,1175"/>
<area shape="rect" id="node28" href="../../dd/d39/regressor_8c.html#afbc61c04e3612e9d511bd4a7f599f63a" title="predict_regressor" alt="" coords="734,1900,859,1925"/>
<area shape="rect" id="node29" href="../../dd/df8/darknet_8c.html#a83ca859f15e1369a5e569df1a7486ebe" title="rescale_net" alt="" coords="955,1199,1046,1224"/>
<area shape="rect" id="node30" href="../../dd/df8/darknet_8c.html#a69898d896e1117395eae539fa27b4eee" title="reset_normalize_net" alt="" coords="929,1248,1072,1273"/>
<area shape="rect" id="node31" href="../../dd/df8/darknet_8c.html#a2bc7b77a09e6cfe48e3511ff39990af4" title="rgbgr_net" alt="" coords="961,1297,1040,1323"/>
<area shape="rect" id="node32" href="../../dd/d03/nightmare_8c.html#aaefb0ed0f5bd621bb9e131e2bc1b4852" title="run_nightmare" alt="" coords="947,1348,1054,1373"/>
<area shape="rect" id="node33" href="../../db/d2a/go_8c.html#aef3d780fb37b0f0a08f1eb90a807247a" title="self_go" alt="" coords="764,1949,829,1975"/>
<area shape="rect" id="node34" href="../../de/da9/compare_8c.html#acd74ba2c82e46517734c88f503f0c012" title="SortMaster3000" alt="" coords="738,1999,855,2024"/>
<area shape="rect" id="node35" href="../../dd/df8/darknet_8c.html#a4c45f1bb571fe1f3c52c4f7b7d858f8d" title="speed" alt="" coords="972,1400,1029,1425"/>
<area shape="rect" id="node36" href="../../dd/df8/darknet_8c.html#ab619dcce0bf0acf8db3db0d86dfa83de" title="statistics_net" alt="" coords="951,1453,1050,1479"/>
<area shape="rect" id="node37" href="../../d4/d8c/captcha_8c.html#af9f9a5158ed6aa89db115092fd4f79f0" title="test_captcha" alt="" coords="748,2048,845,2073"/>
<area shape="rect" id="node38" href="../../d6/d8c/rnn_8c.html#a83c8cf9106e2cf81b55677f13f480a68" title="test_char_rnn" alt="" coords="745,2097,848,2123"/>
<area shape="rect" id="node39" href="../../da/d91/cifar_8c.html#a957192525193e2b1c2e49623efbf886b" title="test_cifar" alt="" coords="759,203,834,228"/>
<area shape="rect" id="node40" href="../../da/d91/cifar_8c.html#aafb9c1ab47e6aab1e91add0fa8274df2" title="test_cifar_csv" alt="" coords="745,252,848,277"/>
<area shape="rect" id="node41" href="../../da/d91/cifar_8c.html#a9f53222883b68025e04ab97d10308c94" title="test_cifar_csvtrain" alt="" coords="732,301,861,327"/>
<area shape="rect" id="node42" href="../../da/d91/cifar_8c.html#ae17739385f812a6432492853b42cc113" title="test_cifar_multi" alt="" coords="741,351,852,376"/>
<area shape="rect" id="node43" href="../../d0/db9/classifier_8c.html#aceccf5b6380cf57e56df5655b85fb52e" title="test_classifier" alt="" coords="746,400,848,425"/>
<area shape="rect" id="node44" href="../../d9/d90/coco_8c.html#a3750d7559afe9fbdcc98dfb5383275a7" title="test_coco" alt="" coords="757,449,836,475"/>
<area shape="rect" id="node45" href="../../d2/da6/lsd_8c.html#a0ff5b76eeaf6a6f3ea748d9e7d02de52" title="test_dcgan" alt="" coords="753,499,840,524"/>
<area shape="rect" id="node46" href="../../d1/dec/dice_8c.html#abd03f638bd52a2b4175189748e496ac9" title="test_dice" alt="" coords="759,548,834,573"/>
<area shape="rect" id="node47" href="../../db/d2a/go_8c.html#a88ad2f96f9ea8092406bcb8f1873e92d" title="test_go" alt="" coords="764,597,829,623"/>
<area shape="rect" id="node48" href="../../d2/da6/lsd_8c.html#abcf2acb0200df9fc8e4d96d998658bdd" title="test_lsd" alt="" coords="763,647,830,672"/>
<area shape="rect" id="node49" href="../../d2/d1d/super_8c.html#aad6e292cdad8f47b71375c0e09959863" title="test_super" alt="" coords="755,696,838,721"/>
<area shape="rect" id="node50" href="../../d6/d8c/rnn_8c.html#a073f6bb832965a03274a7c44921d19af" title="test_tactic_rnn" alt="" coords="743,745,851,771"/>
</map>
</div>

</div>
</div>
<a id="a07c0e92090deac070be99cd552dfe39f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07c0e92090deac070be99cd552dfe39f">&#9670;&nbsp;</a></span>get_region_boxes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_region_boxes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/db8/structlayer.html">layer</a>&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>netw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>neth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>probs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dae/structbox.html">box</a> *&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>only_objectness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>tree_thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>relative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00346">346</a> of file <a class="el" href="../../d3/d74/region__layer_8c_source.html">region_layer.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d3b/layer_8h_source.html#l00057">layer::batch</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00153">layer::biases</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00095">layer::classes</a>, <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00318">correct_region_boxes()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00162">layer::delta</a>, <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00137">entry_index()</a>, <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00145">forward_region_layer()</a>, <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00075">get_region_box()</a>, <a class="el" href="../../d3/d09/tree_8h_source.html#l00013">tree::group_size</a>, <a class="el" href="../../d3/d09/tree_8h_source.html#l00012">tree::groups</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00066">layer::h</a>, <a class="el" href="../../de/dc8/tree_8c_source.html#l00037">hierarchy_predictions()</a>, <a class="el" href="../../de/dc8/tree_8c_source.html#l00053">hierarchy_top_prediction()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00062">network::input</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00060">layer::inputs</a>, <a class="el" href="../../de/d92/activations_8h_source.html#l00007">LOGISTIC</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00068">layer::n</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00126">layer::onlyforward</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00163">layer::output</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00061">layer::outputs</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00094">layer::softmax</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00214">layer::softmax_tree</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00066">network::train</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00065">layer::truths</a>, and <a class="el" href="../../d3/d3b/layer_8h_source.html#l00066">layer::w</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d09/detector_8c_source.html#l00591">test_detector()</a>, <a class="el" href="../../df/d09/detector_8c_source.html#l00383">validate_detector()</a>, <a class="el" href="../../df/d09/detector_8c_source.html#l00247">validate_detector_flip()</a>, and <a class="el" href="../../df/d09/detector_8c_source.html#l00513">validate_detector_recall()</a>.</p>
<div class="fragment"><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;{</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">int</span> i,j,n,z;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordtype">float</span> *predictions = l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a> == 2) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordtype">float</span> *flip = l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> + l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>; ++j) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>/2; ++i) {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <span class="keywordflow">for</span> (n = 0; n &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>; ++n) {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                    <span class="keywordflow">for</span>(z = 0; z &lt; l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a> + 5; ++z){</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                        <span class="keywordtype">int</span> i1 = z*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + j*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a> + i;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                        <span class="keywordtype">int</span> i2 = z*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> + n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + j*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a> + (l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a> - i - 1);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                        <span class="keywordtype">float</span> swap = flip[i1];</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                        flip[i1] = flip[i2];</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                        flip[i2] = swap;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                        <span class="keywordflow">if</span>(z == 0){</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                            flip[i1] = -flip[i1];</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                            flip[i2] = -flip[i2];</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                        }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>; ++i){</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[i] = (l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[i] + flip[i])/2.;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>; ++i){</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordtype">int</span> row = i / l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordtype">int</span> col = i % l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">for</span>(n = 0; n &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>; ++n){</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <span class="keywordtype">int</span> index = n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + i;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keywordflow">for</span>(j = 0; j &lt; l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>; ++j){</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                probs[index][j] = 0;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="keywordtype">int</span> obj_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, 0, n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + i, 4);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <span class="keywordtype">int</span> box_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, 0, n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + i, 0);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keywordtype">float</span> scale = predictions[obj_index];</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            boxes[index] = <a class="code" href="../../d3/d74/region__layer_8c.html#aca90641426af39fb8ed8f9f4ea292e92">get_region_box</a>(predictions, l.<a class="code" href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">biases</a>, n, box_index, col, row, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordtype">int</span> class_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, 0, n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + i, 5);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="keywordflow">if</span>(l.<a class="code" href="../../d4/db8/structlayer.html#ada8540db939d29074a5764ac9ba92f57">softmax_tree</a>){</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <a class="code" href="../../de/dc8/tree_8c.html#ae85a851ba734b49bbb5c13f232dd7f9e">hierarchy_predictions</a>(predictions + class_index, l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>, l.<a class="code" href="../../d4/db8/structlayer.html#ada8540db939d29074a5764ac9ba92f57">softmax_tree</a>, 0, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <span class="keywordflow">if</span>(map){</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    <span class="keywordflow">for</span>(j = 0; j &lt; 200; ++j){</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                        <span class="keywordtype">int</span> class_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, 0, n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + i, 5 + map[j]);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        <span class="keywordtype">float</span> prob = scale*predictions[class_index];</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        probs[index][j] = (prob &gt; thresh) ? prob : 0;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                    }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                    <span class="keywordtype">int</span> j =  <a class="code" href="../../de/dc8/tree_8c.html#a621b0e70c4d9fb119256ccbe1d6b968b">hierarchy_top_prediction</a>(predictions + class_index, l.<a class="code" href="../../d4/db8/structlayer.html#ada8540db939d29074a5764ac9ba92f57">softmax_tree</a>, tree_thresh, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    probs[index][j] = (scale &gt; thresh) ? scale : 0;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                    probs[index][l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>] = scale;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="keywordtype">float</span> max = 0;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">for</span>(j = 0; j &lt; l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>; ++j){</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    <span class="keywordtype">int</span> class_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, 0, n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + i, 5 + j);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                    <span class="keywordtype">float</span> prob = scale*predictions[class_index];</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                    probs[index][j] = (prob &gt; thresh) ? prob : 0;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                    <span class="keywordflow">if</span>(prob &gt; max) max = prob;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    <span class="comment">// TODO REMOVE</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    <span class="comment">// if (j == 56 ) probs[index][j] = 0; </span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    <span class="comment">/*</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">                       if (j != 0) probs[index][j] = 0; </span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">                       int blacklist[] = {121, 497, 482, 504, 122, 518,481, 418, 542, 491, 914, 478, 120, 510,500};</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">                       int bb;</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">                       for (bb = 0; bb &lt; sizeof(blacklist)/sizeof(int); ++bb){</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">                       if(index == blacklist[bb]) probs[index][j] = 0;</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">                       }</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">                     */</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                probs[index][l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a>] = max;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordflow">if</span>(only_objectness){</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                probs[index][0] = scale;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="../../d3/d74/region__layer_8c.html#acb8eecea72f5b9f73b785baa78b6f107">correct_region_boxes</a>(boxes, l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>, w, h, netw, neth, relative);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;}</div><div class="ttc" id="region__layer_8c_html_acb8eecea72f5b9f73b785baa78b6f107"><div class="ttname"><a href="../../d3/d74/region__layer_8c.html#acb8eecea72f5b9f73b785baa78b6f107">correct_region_boxes</a></div><div class="ttdeci">void correct_region_boxes(box *boxes, int n, int w, int h, int netw, int neth, int relative)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d74/region__layer_8c_source.html#l00318">region_layer.c:318</a></div></div>
<div class="ttc" id="tree_8c_html_a621b0e70c4d9fb119256ccbe1d6b968b"><div class="ttname"><a href="../../de/dc8/tree_8c.html#a621b0e70c4d9fb119256ccbe1d6b968b">hierarchy_top_prediction</a></div><div class="ttdeci">int hierarchy_top_prediction(float *predictions, tree *hier, float thresh, int stride)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc8/tree_8c_source.html#l00053">tree.c:53</a></div></div>
<div class="ttc" id="structlayer_html_aaa7f20cb294d09ee0011d32658675a48"><div class="ttname"><a href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">layer::biases</a></div><div class="ttdeci">float * biases</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00153">layer.h:153</a></div></div>
<div class="ttc" id="structlayer_html_a2e00450d79170c48791a1ed5a6f1d0c4"><div class="ttname"><a href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">layer::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00066">layer.h:66</a></div></div>
<div class="ttc" id="structlayer_html_a454b8980d0186eb0095a25aadef41744"><div class="ttname"><a href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">layer::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00068">layer.h:68</a></div></div>
<div class="ttc" id="region__layer_8c_html_ac3c785a8f7fdc0d10f1c4330bee08b48"><div class="ttname"><a href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a></div><div class="ttdeci">int entry_index(layer l, int batch, int location, int entry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d74/region__layer_8c_source.html#l00137">region_layer.c:137</a></div></div>
<div class="ttc" id="tree_8c_html_ae85a851ba734b49bbb5c13f232dd7f9e"><div class="ttname"><a href="../../de/dc8/tree_8c.html#ae85a851ba734b49bbb5c13f232dd7f9e">hierarchy_predictions</a></div><div class="ttdeci">void hierarchy_predictions(float *predictions, int n, tree *hier, int only_leaves, int stride)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc8/tree_8c_source.html#l00037">tree.c:37</a></div></div>
<div class="ttc" id="region__layer_8c_html_aca90641426af39fb8ed8f9f4ea292e92"><div class="ttname"><a href="../../d3/d74/region__layer_8c.html#aca90641426af39fb8ed8f9f4ea292e92">get_region_box</a></div><div class="ttdeci">box get_region_box(float *x, float *biases, int n, int index, int i, int j, int w, int h, int stride)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d74/region__layer_8c_source.html#l00075">region_layer.c:75</a></div></div>
<div class="ttc" id="structlayer_html_a7766d090f7dac8294b7456c1251ab485"><div class="ttname"><a href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">layer::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00066">layer.h:66</a></div></div>
<div class="ttc" id="structlayer_html_aff6bd99e74d13cccca4c492dd3e8de9c"><div class="ttname"><a href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">layer::batch</a></div><div class="ttdeci">int batch</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00057">layer.h:57</a></div></div>
<div class="ttc" id="structlayer_html_a04d23c71428242b3153eda588f844eb3"><div class="ttname"><a href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">layer::output</a></div><div class="ttdeci">float * output</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00163">layer.h:163</a></div></div>
<div class="ttc" id="structlayer_html_af8d01e54a44d8682c38d431c32faed45"><div class="ttname"><a href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">layer::classes</a></div><div class="ttdeci">int classes</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00095">layer.h:95</a></div></div>
<div class="ttc" id="structlayer_html_ada8540db939d29074a5764ac9ba92f57"><div class="ttname"><a href="../../d4/db8/structlayer.html#ada8540db939d29074a5764ac9ba92f57">layer::softmax_tree</a></div><div class="ttdeci">tree * softmax_tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00214">layer.h:214</a></div></div>
<div class="ttc" id="structlayer_html_a0874fab782ae0e8f1075cc99d776478b"><div class="ttname"><a href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">layer::outputs</a></div><div class="ttdeci">int outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00061">layer.h:61</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d08/region__layer_8h_a07c0e92090deac070be99cd552dfe39f_cgraph.png" border="0" usemap="#df/d08/region__layer_8h_a07c0e92090deac070be99cd552dfe39f_cgraph" alt=""/></div>
<map name="df/d08/region__layer_8h_a07c0e92090deac070be99cd552dfe39f_cgraph" id="df/d08/region__layer_8h_a07c0e92090deac070be99cd552dfe39f_cgraph">
<area shape="rect" id="node2" href="../../d3/d74/region__layer_8c.html#acb8eecea72f5b9f73b785baa78b6f107" title="correct_region_boxes" alt="" coords="190,473,339,499"/>
<area shape="rect" id="node3" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48" title="entry_index" alt="" coords="436,300,526,325"/>
<area shape="rect" id="node4" href="../../d3/d74/region__layer_8c.html#a7df2017786a6b8cc6dc6a15d5024d6b1" title="forward_region_layer" alt="" coords="191,575,338,600"/>
<area shape="rect" id="node25" href="../../d3/d74/region__layer_8c.html#aca90641426af39fb8ed8f9f4ea292e92" title="get_region_box" alt="" coords="614,600,728,625"/>
<area shape="rect" id="node32" href="../../de/dc8/tree_8c.html#ae85a851ba734b49bbb5c13f232dd7f9e" title="hierarchy_predictions" alt="" coords="190,851,338,876"/>
<area shape="rect" id="node33" href="../../de/dc8/tree_8c.html#a621b0e70c4d9fb119256ccbe1d6b968b" title="hierarchy_top_prediction" alt="" coords="181,900,348,925"/>
<area shape="rect" id="node5" href="../../dd/d2e/activations_8c.html#a9c58c2e7b5e7ea90cf75f18c97e78dc8" title="activate_array" alt="" coords="429,448,534,473"/>
<area shape="rect" id="node20" href="../../d2/dd1/box_8c.html#ae14a614fc4d26ebb552d23615dfea313" title="box_iou" alt="" coords="637,551,705,576"/>
<area shape="rect" id="node24" href="../../d3/d74/region__layer_8c.html#a745171a1090e6f08bd824fb47b764216" title="delta_region_box" alt="" coords="419,549,543,575"/>
<area shape="rect" id="node26" href="../../d3/d74/region__layer_8c.html#aa771812f7eca72867188ba440d6d00ac" title="delta_region_class" alt="" coords="415,651,547,676"/>
<area shape="rect" id="node27" href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35" title="float_to_box" alt="" coords="434,700,528,725"/>
<area shape="rect" id="node28" href="../../de/dc8/tree_8c.html#a4f7eed900e89ca83188960a695529f92" title="get_hierarchy_probability" alt="" coords="396,749,566,775"/>
<area shape="rect" id="node29" href="../../d3/d91/utils_8c.html#ab29ce45fa5e3847d0125e2e7f2e2cb44" title="mag_array" alt="" coords="439,349,524,375"/>
<area shape="rect" id="node30" href="../../dc/d50/blas_8c.html#ad328f3d0648b19a98fafc221e43ed73d" title="softmax_cpu" alt="" coords="433,399,530,424"/>
<area shape="rect" id="node6" href="../../dd/d2e/activations_8c.html#a031d574d016f6a31eae5bbddfbac3dc5" title="activate" alt="" coords="637,351,705,376"/>
<area shape="rect" id="node7" href="../../de/d92/activations_8h.html#acce967bf6526bd7994919b94b5b3af14" title="elu_activate" alt="" coords="789,104,882,129"/>
<area shape="rect" id="node8" href="../../de/d92/activations_8h.html#ae2948bccc35ed0c3387f7d3c8ec79787" title="hardtan_activate" alt="" coords="776,153,896,179"/>
<area shape="rect" id="node9" href="../../de/d92/activations_8h.html#a5a6368990806124d3250b333ed565b4a" title="leaky_activate" alt="" coords="783,203,888,228"/>
<area shape="rect" id="node10" href="../../de/d92/activations_8h.html#acc9d7e9215ddc5c6a01dcafb3d796e27" title="lhtan_activate" alt="" coords="784,252,887,277"/>
<area shape="rect" id="node11" href="../../de/d92/activations_8h.html#a1f5850078bfdb4497930848b0f2038e6" title="linear_activate" alt="" coords="782,301,889,327"/>
<area shape="rect" id="node12" href="../../de/d92/activations_8h.html#a44310fdff610a48bdf99bb1c77802660" title="loggy_activate" alt="" coords="782,351,889,376"/>
<area shape="rect" id="node13" href="../../de/d92/activations_8h.html#a851af6d779ff52c59d910f3692565361" title="logistic_activate" alt="" coords="778,400,893,425"/>
<area shape="rect" id="node14" href="../../de/d92/activations_8h.html#a6b8b9d9498305d2ef7000dd6a1f818bc" title="plse_activate" alt="" coords="786,449,885,475"/>
<area shape="rect" id="node15" href="../../de/d92/activations_8h.html#a86e53d56302efa6b39c8728066ceb14a" title="ramp_activate" alt="" coords="783,499,888,524"/>
<area shape="rect" id="node16" href="../../de/d92/activations_8h.html#a4e3cc496939c8e1b87a15de3c87df807" title="relie_activate" alt="" coords="786,548,886,573"/>
<area shape="rect" id="node17" href="../../de/d92/activations_8h.html#a6fb9a058235cf6c731a6eb3ee8616fd7" title="relu_activate" alt="" coords="787,597,884,623"/>
<area shape="rect" id="node18" href="../../de/d92/activations_8h.html#aac25575dac41b794e1f4fff6ad56e6c7" title="stair_activate" alt="" coords="786,5,886,31"/>
<area shape="rect" id="node19" href="../../de/d92/activations_8h.html#abe8175839177b65bd6b33c32200f348c" title="tanh_activate" alt="" coords="785,55,886,80"/>
<area shape="rect" id="node21" href="../../d2/dd1/box_8c.html#a306e7943e82df234b6f9d9c70def621c" title="box_intersection" alt="" coords="944,672,1062,697"/>
<area shape="rect" id="node23" href="../../d2/dd1/box_8c.html#a6f5e94eb9c925d29647fd649799b8066" title="box_union" alt="" coords="794,647,877,672"/>
<area shape="rect" id="node22" href="../../d2/dd1/box_8c.html#a49bbaf2c74dad0f7bbca22c9e41286ca" title="overlap" alt="" coords="1110,672,1175,697"/>
<area shape="rect" id="node31" href="../../dc/d50/blas_8c.html#a31c4f0273f3c5639ae7734d24e11274a" title="softmax" alt="" coords="637,301,705,327"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d08/region__layer_8h_a07c0e92090deac070be99cd552dfe39f_icgraph.png" border="0" usemap="#df/d08/region__layer_8h_a07c0e92090deac070be99cd552dfe39f_icgraph" alt=""/></div>
<map name="df/d08/region__layer_8h_a07c0e92090deac070be99cd552dfe39f_icgraph" id="df/d08/region__layer_8h_a07c0e92090deac070be99cd552dfe39f_icgraph">
<area shape="rect" id="node2" href="../../df/d09/detector_8c.html#ad29ded4bbd1d823ecf9a61135e0710cb" title="test_detector" alt="" coords="213,5,311,31"/>
<area shape="rect" id="node5" href="../../df/d09/detector_8c.html#aea37ad211a83b40620a2df0eb6623a66" title="validate_detector" alt="" coords="200,55,323,80"/>
<area shape="rect" id="node6" href="../../df/d09/detector_8c.html#a8e19e1fdfb2b82b5ce3b72bc8580d8e3" title="validate_detector_flip" alt="" coords="188,104,335,129"/>
<area shape="rect" id="node7" href="../../df/d09/detector_8c.html#a4f5828b59e5940a47f390c2e430fd3d4" title="validate_detector_recall" alt="" coords="181,153,343,179"/>
<area shape="rect" id="node3" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="535,31,585,56"/>
<area shape="rect" id="node4" href="../../df/d09/detector_8c.html#a677c1747fd7a58c7f7da3314af5d6120" title="run_detector" alt="" coords="391,56,487,81"/>
</map>
</div>

</div>
</div>
<a id="ab5954d5e5ba84cb866c518c7f6847bf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5954d5e5ba84cb866c518c7f6847bf0">&#9670;&nbsp;</a></span>make_region_layer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/db8/structlayer.html">layer</a> make_region_layer </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>classes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coords</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00012">12</a> of file <a class="el" href="../../d3/d74/region__layer_8c_source.html">region_layer.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d3b/layer_8h_source.html#l00050">layer::backward</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00053">layer::backward_gpu</a>, <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00305">backward_region_layer()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00057">layer::batch</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00154">layer::bias_updates</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00153">layer::biases</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00066">layer::c</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00095">layer::classes</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00096">layer::coords</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00141">layer::cost</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00162">layer::delta</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00049">layer::forward</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00052">layer::forward_gpu</a>, <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00145">forward_region_layer()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00066">layer::h</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00060">layer::inputs</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00068">layer::n</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00067">layer::out_c</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00067">layer::out_h</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00067">layer::out_w</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00163">layer::output</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00061">layer::outputs</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00036">REGION</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00065">layer::truths</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00046">layer::type</a>, and <a class="el" href="../../d3/d3b/layer_8h_source.html#l00066">layer::w</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d72/parser_8c_source.html#l00264">parse_region()</a>.</p>
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <a class="code" href="../../d4/db8/structlayer.html">layer</a> l = {0};</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#af00e36adaf6e404a3e5234843c723714">type</a> = <a class="code" href="../../d3/d3b/layer_8h.html#a5f7e99058765b058df158c099200b154a3bfda0bdc93e66e77b2242a9ce4cd804">REGION</a>;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a> = n;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a> = batch;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> = h;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a> = w;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a6d10d2818541049ff11e94b257077a2d">c</a> = n*(classes + coords + 1);</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a46454d978f2d84f8b8aba918a747c761">out_w</a> = l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a8f8224d0915a9903d93874aefe278f98">out_h</a> = l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a298d150dabc449824204579f4851b926">out_c</a> = l.<a class="code" href="../../d4/db8/structlayer.html#a6d10d2818541049ff11e94b257077a2d">c</a>;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a> = classes;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a6b8636464bcea5dea2c2235ee133af29">coords</a> = coords;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">cost</a> = calloc(1, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">biases</a> = calloc(n*2, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a53f11ac2a72b28b8c3529b799f1662fd">bias_updates</a> = calloc(n*2, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a> = h*w*n*(classes + coords + 1);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">inputs</a> = l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a086d4ebdf69d011ef4c11a487bd5ff60">truths</a> = 30*(5);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a> = calloc(batch*l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> = calloc(batch*l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; n*2; ++i){</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        l.<a class="code" href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">biases</a>[i] = .5;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    }</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#ad587958fc9c301a5987df7b3d68a09c1">forward</a> = <a class="code" href="../../d3/d74/region__layer_8c.html#a7df2017786a6b8cc6dc6a15d5024d6b1">forward_region_layer</a>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#a97391cfa71ea05cd917a3919f00e14a6">backward</a> = <a class="code" href="../../d3/d74/region__layer_8c.html#a1823033f070004078252d6c00eb27039">backward_region_layer</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#ifdef GPU</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#ae96ac4b6c9470848c52dddc95cb14b6a">forward_gpu</a> = forward_region_layer_gpu;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    l.<a class="code" href="../../d4/db8/structlayer.html#aedf9ba6db46b7291b41f424ff6346784">backward_gpu</a> = backward_region_layer_gpu;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    l.output_gpu = cuda_make_array(l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, batch*l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    l.delta_gpu = cuda_make_array(l.<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, batch*l.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;detection\n&quot;</span>);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    srand(0);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">return</span> l;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div><div class="ttc" id="structlayer_html_aaa7f20cb294d09ee0011d32658675a48"><div class="ttname"><a href="../../d4/db8/structlayer.html#aaa7f20cb294d09ee0011d32658675a48">layer::biases</a></div><div class="ttdeci">float * biases</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00153">layer.h:153</a></div></div>
<div class="ttc" id="structlayer_html_a2e00450d79170c48791a1ed5a6f1d0c4"><div class="ttname"><a href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">layer::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00066">layer.h:66</a></div></div>
<div class="ttc" id="structlayer_html_a454b8980d0186eb0095a25aadef41744"><div class="ttname"><a href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">layer::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00068">layer.h:68</a></div></div>
<div class="ttc" id="structlayer_html_a086d4ebdf69d011ef4c11a487bd5ff60"><div class="ttname"><a href="../../d4/db8/structlayer.html#a086d4ebdf69d011ef4c11a487bd5ff60">layer::truths</a></div><div class="ttdeci">int truths</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00065">layer.h:65</a></div></div>
<div class="ttc" id="structlayer_html_ae96ac4b6c9470848c52dddc95cb14b6a"><div class="ttname"><a href="../../d4/db8/structlayer.html#ae96ac4b6c9470848c52dddc95cb14b6a">layer::forward_gpu</a></div><div class="ttdeci">void(* forward_gpu)(struct layer, struct network)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00052">layer.h:52</a></div></div>
<div class="ttc" id="structlayer_html_aedf9ba6db46b7291b41f424ff6346784"><div class="ttname"><a href="../../d4/db8/structlayer.html#aedf9ba6db46b7291b41f424ff6346784">layer::backward_gpu</a></div><div class="ttdeci">void(* backward_gpu)(struct layer, struct network)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00053">layer.h:53</a></div></div>
<div class="ttc" id="structlayer_html_ad587958fc9c301a5987df7b3d68a09c1"><div class="ttname"><a href="../../d4/db8/structlayer.html#ad587958fc9c301a5987df7b3d68a09c1">layer::forward</a></div><div class="ttdeci">void(* forward)(struct layer, struct network)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00049">layer.h:49</a></div></div>
<div class="ttc" id="structlayer_html_a46454d978f2d84f8b8aba918a747c761"><div class="ttname"><a href="../../d4/db8/structlayer.html#a46454d978f2d84f8b8aba918a747c761">layer::out_w</a></div><div class="ttdeci">int out_w</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00067">layer.h:67</a></div></div>
<div class="ttc" id="structlayer_html_a298d150dabc449824204579f4851b926"><div class="ttname"><a href="../../d4/db8/structlayer.html#a298d150dabc449824204579f4851b926">layer::out_c</a></div><div class="ttdeci">int out_c</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00067">layer.h:67</a></div></div>
<div class="ttc" id="layer_8h_html_a5f7e99058765b058df158c099200b154a3bfda0bdc93e66e77b2242a9ce4cd804"><div class="ttname"><a href="../../d3/d3b/layer_8h.html#a5f7e99058765b058df158c099200b154a3bfda0bdc93e66e77b2242a9ce4cd804">REGION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00036">layer.h:36</a></div></div>
<div class="ttc" id="structlayer_html_a7766d090f7dac8294b7456c1251ab485"><div class="ttname"><a href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">layer::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00066">layer.h:66</a></div></div>
<div class="ttc" id="structlayer_html_a1360cf3c28df067cc6f3af139fa95d3a"><div class="ttname"><a href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">layer::delta</a></div><div class="ttdeci">float * delta</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00162">layer.h:162</a></div></div>
<div class="ttc" id="structlayer_html_a8f8224d0915a9903d93874aefe278f98"><div class="ttname"><a href="../../d4/db8/structlayer.html#a8f8224d0915a9903d93874aefe278f98">layer::out_h</a></div><div class="ttdeci">int out_h</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00067">layer.h:67</a></div></div>
<div class="ttc" id="structlayer_html_a3fac583bf31e18ca679d195b1485b316"><div class="ttname"><a href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">layer::inputs</a></div><div class="ttdeci">int inputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00060">layer.h:60</a></div></div>
<div class="ttc" id="structlayer_html_a97391cfa71ea05cd917a3919f00e14a6"><div class="ttname"><a href="../../d4/db8/structlayer.html#a97391cfa71ea05cd917a3919f00e14a6">layer::backward</a></div><div class="ttdeci">void(* backward)(struct layer, struct network)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00050">layer.h:50</a></div></div>
<div class="ttc" id="region__layer_8c_html_a7df2017786a6b8cc6dc6a15d5024d6b1"><div class="ttname"><a href="../../d3/d74/region__layer_8c.html#a7df2017786a6b8cc6dc6a15d5024d6b1">forward_region_layer</a></div><div class="ttdeci">void forward_region_layer(const layer l, network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d74/region__layer_8c_source.html#l00145">region_layer.c:145</a></div></div>
<div class="ttc" id="structlayer_html_aff6bd99e74d13cccca4c492dd3e8de9c"><div class="ttname"><a href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">layer::batch</a></div><div class="ttdeci">int batch</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00057">layer.h:57</a></div></div>
<div class="ttc" id="structlayer_html_a04d23c71428242b3153eda588f844eb3"><div class="ttname"><a href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">layer::output</a></div><div class="ttdeci">float * output</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00163">layer.h:163</a></div></div>
<div class="ttc" id="structlayer_html_a53f11ac2a72b28b8c3529b799f1662fd"><div class="ttname"><a href="../../d4/db8/structlayer.html#a53f11ac2a72b28b8c3529b799f1662fd">layer::bias_updates</a></div><div class="ttdeci">float * bias_updates</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00154">layer.h:154</a></div></div>
<div class="ttc" id="structlayer_html_a6b8636464bcea5dea2c2235ee133af29"><div class="ttname"><a href="../../d4/db8/structlayer.html#a6b8636464bcea5dea2c2235ee133af29">layer::coords</a></div><div class="ttdeci">int coords</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00096">layer.h:96</a></div></div>
<div class="ttc" id="structlayer_html_a6d10d2818541049ff11e94b257077a2d"><div class="ttname"><a href="../../d4/db8/structlayer.html#a6d10d2818541049ff11e94b257077a2d">layer::c</a></div><div class="ttdeci">int c</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00066">layer.h:66</a></div></div>
<div class="ttc" id="structlayer_html_af8d01e54a44d8682c38d431c32faed45"><div class="ttname"><a href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">layer::classes</a></div><div class="ttdeci">int classes</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00095">layer.h:95</a></div></div>
<div class="ttc" id="structlayer_html_af00e36adaf6e404a3e5234843c723714"><div class="ttname"><a href="../../d4/db8/structlayer.html#af00e36adaf6e404a3e5234843c723714">layer::type</a></div><div class="ttdeci">LAYER_TYPE type</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00046">layer.h:46</a></div></div>
<div class="ttc" id="structlayer_html_a0874fab782ae0e8f1075cc99d776478b"><div class="ttname"><a href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">layer::outputs</a></div><div class="ttdeci">int outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00061">layer.h:61</a></div></div>
<div class="ttc" id="region__layer_8c_html_a1823033f070004078252d6c00eb27039"><div class="ttname"><a href="../../d3/d74/region__layer_8c.html#a1823033f070004078252d6c00eb27039">backward_region_layer</a></div><div class="ttdeci">void backward_region_layer(const layer l, network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d74/region__layer_8c_source.html#l00305">region_layer.c:305</a></div></div>
<div class="ttc" id="structlayer_html_a9a71dbf0ad70f63a10787d8217633776"><div class="ttname"><a href="../../d4/db8/structlayer.html#a9a71dbf0ad70f63a10787d8217633776">layer::cost</a></div><div class="ttdeci">float * cost</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00141">layer.h:141</a></div></div>
<div class="ttc" id="structlayer_html"><div class="ttname"><a href="../../d4/db8/structlayer.html">layer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00045">layer.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d08/region__layer_8h_ab5954d5e5ba84cb866c518c7f6847bf0_cgraph.png" border="0" usemap="#df/d08/region__layer_8h_ab5954d5e5ba84cb866c518c7f6847bf0_cgraph" alt=""/></div>
<map name="df/d08/region__layer_8h_ab5954d5e5ba84cb866c518c7f6847bf0_cgraph" id="df/d08/region__layer_8h_ab5954d5e5ba84cb866c518c7f6847bf0_cgraph">
<area shape="rect" id="node2" href="../../d3/d74/region__layer_8c.html#a1823033f070004078252d6c00eb27039" title="backward_region_layer" alt="" coords="188,725,347,751"/>
<area shape="rect" id="node3" href="../../d3/d74/region__layer_8c.html#a7df2017786a6b8cc6dc6a15d5024d6b1" title="forward_region_layer" alt="" coords="194,775,341,800"/>
<area shape="rect" id="node4" href="../../dd/d2e/activations_8c.html#a9c58c2e7b5e7ea90cf75f18c97e78dc8" title="activate_array" alt="" coords="428,424,533,449"/>
<area shape="rect" id="node19" href="../../d2/dd1/box_8c.html#ae14a614fc4d26ebb552d23615dfea313" title="box_iou" alt="" coords="636,648,704,673"/>
<area shape="rect" id="node23" href="../../d3/d74/region__layer_8c.html#a745171a1090e6f08bd824fb47b764216" title="delta_region_box" alt="" coords="419,648,542,673"/>
<area shape="rect" id="node24" href="../../d3/d74/region__layer_8c.html#aca90641426af39fb8ed8f9f4ea292e92" title="get_region_box" alt="" coords="614,699,727,724"/>
<area shape="rect" id="node25" href="../../d3/d74/region__layer_8c.html#aa771812f7eca72867188ba440d6d00ac" title="delta_region_class" alt="" coords="414,749,547,775"/>
<area shape="rect" id="node26" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48" title="entry_index" alt="" coords="435,799,526,824"/>
<area shape="rect" id="node27" href="../../d2/dd1/box_8c.html#a3a91c383316adfc6dfc023e2168d0f35" title="float_to_box" alt="" coords="433,848,527,873"/>
<area shape="rect" id="node28" href="../../de/dc8/tree_8c.html#a4f7eed900e89ca83188960a695529f92" title="get_hierarchy_probability" alt="" coords="395,897,566,923"/>
<area shape="rect" id="node29" href="../../d3/d91/utils_8c.html#ab29ce45fa5e3847d0125e2e7f2e2cb44" title="mag_array" alt="" coords="438,947,523,972"/>
<area shape="rect" id="node30" href="../../dc/d50/blas_8c.html#ad328f3d0648b19a98fafc221e43ed73d" title="softmax_cpu" alt="" coords="432,996,529,1021"/>
<area shape="rect" id="node5" href="../../dd/d2e/activations_8c.html#a031d574d016f6a31eae5bbddfbac3dc5" title="activate" alt="" coords="637,327,704,352"/>
<area shape="rect" id="node6" href="../../de/d92/activations_8h.html#acce967bf6526bd7994919b94b5b3af14" title="elu_activate" alt="" coords="789,5,881,31"/>
<area shape="rect" id="node7" href="../../de/d92/activations_8h.html#ae2948bccc35ed0c3387f7d3c8ec79787" title="hardtan_activate" alt="" coords="775,55,895,80"/>
<area shape="rect" id="node8" href="../../de/d92/activations_8h.html#a5a6368990806124d3250b333ed565b4a" title="leaky_activate" alt="" coords="782,104,888,129"/>
<area shape="rect" id="node9" href="../../de/d92/activations_8h.html#acc9d7e9215ddc5c6a01dcafb3d796e27" title="lhtan_activate" alt="" coords="783,153,887,179"/>
<area shape="rect" id="node10" href="../../de/d92/activations_8h.html#a1f5850078bfdb4497930848b0f2038e6" title="linear_activate" alt="" coords="781,203,888,228"/>
<area shape="rect" id="node11" href="../../de/d92/activations_8h.html#a44310fdff610a48bdf99bb1c77802660" title="loggy_activate" alt="" coords="782,252,888,277"/>
<area shape="rect" id="node12" href="../../de/d92/activations_8h.html#a851af6d779ff52c59d910f3692565361" title="logistic_activate" alt="" coords="777,301,893,327"/>
<area shape="rect" id="node13" href="../../de/d92/activations_8h.html#a6b8b9d9498305d2ef7000dd6a1f818bc" title="plse_activate" alt="" coords="785,351,884,376"/>
<area shape="rect" id="node14" href="../../de/d92/activations_8h.html#a86e53d56302efa6b39c8728066ceb14a" title="ramp_activate" alt="" coords="782,400,887,425"/>
<area shape="rect" id="node15" href="../../de/d92/activations_8h.html#a4e3cc496939c8e1b87a15de3c87df807" title="relie_activate" alt="" coords="785,449,885,475"/>
<area shape="rect" id="node16" href="../../de/d92/activations_8h.html#a6fb9a058235cf6c731a6eb3ee8616fd7" title="relu_activate" alt="" coords="786,499,883,524"/>
<area shape="rect" id="node17" href="../../de/d92/activations_8h.html#aac25575dac41b794e1f4fff6ad56e6c7" title="stair_activate" alt="" coords="785,548,885,573"/>
<area shape="rect" id="node18" href="../../de/d92/activations_8h.html#abe8175839177b65bd6b33c32200f348c" title="tanh_activate" alt="" coords="784,597,885,623"/>
<area shape="rect" id="node20" href="../../d2/dd1/box_8c.html#a306e7943e82df234b6f9d9c70def621c" title="box_intersection" alt="" coords="943,673,1061,699"/>
<area shape="rect" id="node22" href="../../d2/dd1/box_8c.html#a6f5e94eb9c925d29647fd649799b8066" title="box_union" alt="" coords="793,699,876,724"/>
<area shape="rect" id="node21" href="../../d2/dd1/box_8c.html#a49bbaf2c74dad0f7bbca22c9e41286ca" title="overlap" alt="" coords="1109,673,1174,699"/>
<area shape="rect" id="node31" href="../../dc/d50/blas_8c.html#a31c4f0273f3c5639ae7734d24e11274a" title="softmax" alt="" coords="636,996,704,1021"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d08/region__layer_8h_ab5954d5e5ba84cb866c518c7f6847bf0_icgraph.png" border="0" usemap="#df/d08/region__layer_8h_ab5954d5e5ba84cb866c518c7f6847bf0_icgraph" alt=""/></div>
<map name="df/d08/region__layer_8h_ab5954d5e5ba84cb866c518c7f6847bf0_icgraph" id="df/d08/region__layer_8h_ab5954d5e5ba84cb866c518c7f6847bf0_icgraph">
<area shape="rect" id="node2" href="../../d2/d72/parser_8c.html#afedfffed817f89349b250c4afe09041c" title="parse_region" alt="" coords="188,1140,287,1165"/>
<area shape="rect" id="node3" href="../../d5/d36/parser_8h.html#abb6f2aa1c5d5bf340faae09be6538c56" title="parse_network_cfg" alt="" coords="335,1140,469,1165"/>
<area shape="rect" id="node4" href="../../dd/df8/darknet_8c.html#a7dfa7e733fd4cb2475215182772ba1bf" title="average" alt="" coords="567,5,637,31"/>
<area shape="rect" id="node5" href="../../de/da9/compare_8c.html#a6cd0266d812f6bfc1892f11aa20e1ad9" title="BattleRoyaleWithCheese" alt="" coords="517,55,687,80"/>
<area shape="rect" id="node6" href="../../d0/d8d/art_8c.html#a4e3a9eebb42ddebed7f9b187a48a2ffd" title="demo_art" alt="" coords="563,104,641,129"/>
<area shape="rect" id="node7" href="../../d0/db9/classifier_8c.html#ac5e746c237b87dfa56d2ac1a5db9f3b9" title="demo_classifier" alt="" coords="545,153,659,179"/>
<area shape="rect" id="node8" href="../../dd/d39/regressor_8c.html#a181855118700a6d23f313581c7adce44" title="demo_regressor" alt="" coords="543,203,661,228"/>
<area shape="rect" id="node9" href="../../dd/df8/darknet_8c.html#a59310cd440b860b5f21bd6e3ffef65d0" title="denormalize_net" alt="" coords="542,252,662,277"/>
<area shape="rect" id="node10" href="../../db/d2a/go_8c.html#a634a03028ba512387aae19012c424818" title="engine_go" alt="" coords="560,301,644,327"/>
<area shape="rect" id="node11" href="../../d0/db9/classifier_8c.html#a8901a041f50c430e093fddb249d78d2f" title="gun_classifier" alt="" coords="551,351,653,376"/>
<area shape="rect" id="node12" href="../../d0/db9/classifier_8c.html#a9ae475089952950f04778d56a5dd0f8e" title="label_classifier" alt="" coords="548,400,656,425"/>
<area shape="rect" id="node13" href="../../d9/d94/network_8h.html#aa06b8ad6a6fb64daed0801ad5d4009a2" title="load_network" alt="" coords="552,449,652,475"/>
<area shape="rect" id="node14" href="../../dd/df8/darknet_8c.html#a6a824943f20fa1121776a2a4fd6f1b03" title="normalize_net" alt="" coords="549,499,655,524"/>
<area shape="rect" id="node15" href="../../dd/df8/darknet_8c.html#ab5a20c1c9997af0dec519e992b9400b9" title="oneoff" alt="" coords="573,548,631,573"/>
<area shape="rect" id="node16" href="../../dd/df8/darknet_8c.html#a40cc02a08590681209ce323ff9e22042" title="oneoff2" alt="" coords="569,597,635,623"/>
<area shape="rect" id="node17" href="../../dd/df8/darknet_8c.html#ac61af9d7b12e2d1ac431925614a3b819" title="operations" alt="" coords="560,647,644,672"/>
<area shape="rect" id="node18" href="../../dd/df8/darknet_8c.html#a4663de4fa674346c82a366077969fd4b" title="partial" alt="" coords="573,696,631,721"/>
<area shape="rect" id="node19" href="../../dd/df8/darknet_8c.html#aa8603edf5e9da49cdee89b35d6bc5b42" title="predict_classifier" alt="" coords="542,745,662,771"/>
<area shape="rect" id="node20" href="../../dd/d39/regressor_8c.html#afbc61c04e3612e9d511bd4a7f599f63a" title="predict_regressor" alt="" coords="539,795,665,820"/>
<area shape="rect" id="node21" href="../../dd/df8/darknet_8c.html#a83ca859f15e1369a5e569df1a7486ebe" title="rescale_net" alt="" coords="557,844,647,869"/>
<area shape="rect" id="node22" href="../../dd/df8/darknet_8c.html#a69898d896e1117395eae539fa27b4eee" title="reset_normalize_net" alt="" coords="531,893,673,919"/>
<area shape="rect" id="node23" href="../../dd/df8/darknet_8c.html#a2bc7b77a09e6cfe48e3511ff39990af4" title="rgbgr_net" alt="" coords="563,943,641,968"/>
<area shape="rect" id="node24" href="../../dd/d03/nightmare_8c.html#aaefb0ed0f5bd621bb9e131e2bc1b4852" title="run_nightmare" alt="" coords="548,992,656,1017"/>
<area shape="rect" id="node25" href="../../db/d2a/go_8c.html#aef3d780fb37b0f0a08f1eb90a807247a" title="self_go" alt="" coords="570,1041,634,1067"/>
<area shape="rect" id="node26" href="../../de/da9/compare_8c.html#acd74ba2c82e46517734c88f503f0c012" title="SortMaster3000" alt="" coords="544,1091,660,1116"/>
<area shape="rect" id="node27" href="../../dd/df8/darknet_8c.html#a4c45f1bb571fe1f3c52c4f7b7d858f8d" title="speed" alt="" coords="573,1140,631,1165"/>
<area shape="rect" id="node28" href="../../dd/df8/darknet_8c.html#ab619dcce0bf0acf8db3db0d86dfa83de" title="statistics_net" alt="" coords="553,1189,651,1215"/>
<area shape="rect" id="node29" href="../../d4/d8c/captcha_8c.html#af9f9a5158ed6aa89db115092fd4f79f0" title="test_captcha" alt="" coords="554,1239,650,1264"/>
<area shape="rect" id="node30" href="../../d6/d8c/rnn_8c.html#a83c8cf9106e2cf81b55677f13f480a68" title="test_char_rnn" alt="" coords="551,1288,653,1313"/>
<area shape="rect" id="node31" href="../../da/d91/cifar_8c.html#a957192525193e2b1c2e49623efbf886b" title="test_cifar" alt="" coords="564,1337,640,1363"/>
<area shape="rect" id="node32" href="../../da/d91/cifar_8c.html#aafb9c1ab47e6aab1e91add0fa8274df2" title="test_cifar_csv" alt="" coords="551,1387,653,1412"/>
<area shape="rect" id="node33" href="../../da/d91/cifar_8c.html#a9f53222883b68025e04ab97d10308c94" title="test_cifar_csvtrain" alt="" coords="538,1436,666,1461"/>
<area shape="rect" id="node34" href="../../da/d91/cifar_8c.html#ae17739385f812a6432492853b42cc113" title="test_cifar_multi" alt="" coords="547,1485,657,1511"/>
<area shape="rect" id="node35" href="../../d0/db9/classifier_8c.html#aceccf5b6380cf57e56df5655b85fb52e" title="test_classifier" alt="" coords="551,1535,653,1560"/>
<area shape="rect" id="node36" href="../../d9/d90/coco_8c.html#a3750d7559afe9fbdcc98dfb5383275a7" title="test_coco" alt="" coords="563,1584,641,1609"/>
<area shape="rect" id="node37" href="../../d2/da6/lsd_8c.html#a0ff5b76eeaf6a6f3ea748d9e7d02de52" title="test_dcgan" alt="" coords="559,1633,645,1659"/>
<area shape="rect" id="node38" href="../../df/d09/detector_8c.html#ad29ded4bbd1d823ecf9a61135e0710cb" title="test_detector" alt="" coords="553,1683,651,1708"/>
<area shape="rect" id="node39" href="../../d1/dec/dice_8c.html#abd03f638bd52a2b4175189748e496ac9" title="test_dice" alt="" coords="565,1732,639,1757"/>
<area shape="rect" id="node40" href="../../db/d2a/go_8c.html#a88ad2f96f9ea8092406bcb8f1873e92d" title="test_go" alt="" coords="569,1781,635,1807"/>
<area shape="rect" id="node41" href="../../d2/da6/lsd_8c.html#abcf2acb0200df9fc8e4d96d998658bdd" title="test_lsd" alt="" coords="568,1831,636,1856"/>
<area shape="rect" id="node42" href="../../d2/d1d/super_8c.html#aad6e292cdad8f47b71375c0e09959863" title="test_super" alt="" coords="560,1880,644,1905"/>
<area shape="rect" id="node43" href="../../d6/d8c/rnn_8c.html#a073f6bb832965a03274a7c44921d19af" title="test_tactic_rnn" alt="" coords="548,1929,656,1955"/>
<area shape="rect" id="node44" href="../../d4/db3/tag_8c.html#a88156b8acbfb7f72b07a839a3f8505bd" title="test_tag" alt="" coords="568,1979,636,2004"/>
<area shape="rect" id="node45" href="../../da/d6c/voxel_8c.html#ae712ed693cfbc02f6869fcccaac711e8" title="test_voxel" alt="" coords="561,2028,643,2053"/>
<area shape="rect" id="node46" href="../../da/d32/writing_8c.html#af7c6f6ae0cf9711426c11a9e7929fe5c" title="test_writing" alt="" coords="558,2077,646,2103"/>
<area shape="rect" id="node47" href="../../d5/d37/yolo_8c.html#ac1d1d478258afdb0266722f4a8571587" title="test_yolo" alt="" coords="565,2127,639,2152"/>
<area shape="rect" id="node48" href="../../d0/db9/classifier_8c.html#ab770e80d03219ab55ec93fdd0237f13b" title="threat_classifier" alt="" coords="545,2176,659,2201"/>
<area shape="rect" id="node49" href="../../d4/d8c/captcha_8c.html#aec7b557b2068b30c22b46051b5057769" title="train_captcha" alt="" coords="551,2225,653,2251"/>
<area shape="rect" id="node50" href="../../d6/d8c/rnn_8c.html#a29452f6bf562d39cbf38df330b7d036e" title="train_char_rnn" alt="" coords="548,2275,656,2300"/>
</map>
</div>

</div>
</div>
<a id="a882147a796b341f5ec5989f0e71b7797"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a882147a796b341f5ec5989f0e71b7797">&#9670;&nbsp;</a></span>resize_region_layer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void resize_region_layer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/db8/structlayer.html">layer</a> *&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00055">55</a> of file <a class="el" href="../../d3/d74/region__layer_8c_source.html">region_layer.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d3b/layer_8h_source.html#l00057">layer::batch</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00095">layer::classes</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00096">layer::coords</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00162">layer::delta</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00066">layer::h</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00060">layer::inputs</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00068">layer::n</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00163">layer::output</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00061">layer::outputs</a>, and <a class="el" href="../../d3/d3b/layer_8h_source.html#l00066">layer::w</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d6e/network_8c_source.html#l00299">resize_network()</a>.</p>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a> = w;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> = h;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a> = h*w*l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>*(l-&gt;<a class="code" href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">classes</a> + l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a6b8636464bcea5dea2c2235ee133af29">coords</a> + 1);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">inputs</a> = l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> = realloc(l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, l-&gt;<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>*l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a> = realloc(l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, l-&gt;<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>*l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#ifdef GPU</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    cuda_free(l-&gt;delta_gpu);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    cuda_free(l-&gt;output_gpu);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    l-&gt;delta_gpu =     cuda_make_array(l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">delta</a>, l-&gt;<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>*l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    l-&gt;output_gpu =    cuda_make_array(l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>, l-&gt;<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>*l-&gt;<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div><div class="ttc" id="structlayer_html_a2e00450d79170c48791a1ed5a6f1d0c4"><div class="ttname"><a href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">layer::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00066">layer.h:66</a></div></div>
<div class="ttc" id="structlayer_html_a454b8980d0186eb0095a25aadef41744"><div class="ttname"><a href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">layer::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00068">layer.h:68</a></div></div>
<div class="ttc" id="structlayer_html_a7766d090f7dac8294b7456c1251ab485"><div class="ttname"><a href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">layer::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00066">layer.h:66</a></div></div>
<div class="ttc" id="structlayer_html_a1360cf3c28df067cc6f3af139fa95d3a"><div class="ttname"><a href="../../d4/db8/structlayer.html#a1360cf3c28df067cc6f3af139fa95d3a">layer::delta</a></div><div class="ttdeci">float * delta</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00162">layer.h:162</a></div></div>
<div class="ttc" id="structlayer_html_a3fac583bf31e18ca679d195b1485b316"><div class="ttname"><a href="../../d4/db8/structlayer.html#a3fac583bf31e18ca679d195b1485b316">layer::inputs</a></div><div class="ttdeci">int inputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00060">layer.h:60</a></div></div>
<div class="ttc" id="structlayer_html_aff6bd99e74d13cccca4c492dd3e8de9c"><div class="ttname"><a href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">layer::batch</a></div><div class="ttdeci">int batch</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00057">layer.h:57</a></div></div>
<div class="ttc" id="structlayer_html_a04d23c71428242b3153eda588f844eb3"><div class="ttname"><a href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">layer::output</a></div><div class="ttdeci">float * output</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00163">layer.h:163</a></div></div>
<div class="ttc" id="structlayer_html_a6b8636464bcea5dea2c2235ee133af29"><div class="ttname"><a href="../../d4/db8/structlayer.html#a6b8636464bcea5dea2c2235ee133af29">layer::coords</a></div><div class="ttdeci">int coords</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00096">layer.h:96</a></div></div>
<div class="ttc" id="structlayer_html_af8d01e54a44d8682c38d431c32faed45"><div class="ttname"><a href="../../d4/db8/structlayer.html#af8d01e54a44d8682c38d431c32faed45">layer::classes</a></div><div class="ttdeci">int classes</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00095">layer.h:95</a></div></div>
<div class="ttc" id="structlayer_html_a0874fab782ae0e8f1075cc99d776478b"><div class="ttname"><a href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">layer::outputs</a></div><div class="ttdeci">int outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00061">layer.h:61</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d08/region__layer_8h_a882147a796b341f5ec5989f0e71b7797_icgraph.png" border="0" usemap="#df/d08/region__layer_8h_a882147a796b341f5ec5989f0e71b7797_icgraph" alt=""/></div>
<map name="df/d08/region__layer_8h_a882147a796b341f5ec5989f0e71b7797_icgraph" id="df/d08/region__layer_8h_a882147a796b341f5ec5989f0e71b7797_icgraph">
<area shape="rect" id="node2" href="../../d9/d94/network_8h.html#a6ae710d2d9ad32cfdec1f925f48c2b50" title="resize_network" alt="" coords="191,216,302,241"/>
<area shape="rect" id="node3" href="../../dd/d03/nightmare_8c.html#a3fa2a59e61282c0b9a673497b0e5b1f0" title="optimize_picture" alt="" coords="366,5,485,31"/>
<area shape="rect" id="node6" href="../../dd/df8/darknet_8c.html#aa8603edf5e9da49cdee89b35d6bc5b42" title="predict_classifier" alt="" coords="365,55,486,80"/>
<area shape="rect" id="node8" href="../../d2/d1d/super_8c.html#aad6e292cdad8f47b71375c0e09959863" title="test_super" alt="" coords="384,216,467,241"/>
<area shape="rect" id="node10" href="../../d4/db3/tag_8c.html#a88156b8acbfb7f72b07a839a3f8505bd" title="test_tag" alt="" coords="391,265,460,291"/>
<area shape="rect" id="node12" href="../../da/d6c/voxel_8c.html#ae712ed693cfbc02f6869fcccaac711e8" title="test_voxel" alt="" coords="385,315,466,340"/>
<area shape="rect" id="node14" href="../../da/d32/writing_8c.html#af7c6f6ae0cf9711426c11a9e7929fe5c" title="test_writing" alt="" coords="381,364,470,389"/>
<area shape="rect" id="node16" href="../../df/d09/detector_8c.html#ae007089ceccb49a69ffa696a4f8dd78a" title="train_detector" alt="" coords="374,413,477,439"/>
<area shape="rect" id="node18" href="../../d0/db9/classifier_8c.html#aeae387d13aac40e2eb3aff9584f03a8b" title="validate_classifier_full" alt="" coords="350,104,501,129"/>
<area shape="rect" id="node19" href="../../d0/db9/classifier_8c.html#a4b863efd1e5f3105ed4843963b8d8412" title="validate_classifier\l_multi" alt="" coords="362,153,489,192"/>
<area shape="rect" id="node4" href="../../dd/d03/nightmare_8c.html#aaefb0ed0f5bd621bb9e131e2bc1b4852" title="run_nightmare" alt="" coords="549,12,656,37"/>
<area shape="rect" id="node5" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="704,241,755,267"/>
<area shape="rect" id="node7" href="../../dd/df8/darknet_8c.html#a08cb29ba2c4674431352eff4e6274b56" title="run_classifier" alt="" coords="553,153,653,179"/>
<area shape="rect" id="node9" href="../../d2/d1d/super_8c.html#a4bc1230a2d77e86644c4719157fc69cc" title="run_super" alt="" coords="562,216,643,241"/>
<area shape="rect" id="node11" href="../../d4/db3/tag_8c.html#a695072073d4da637e4728d2527422292" title="run_tag" alt="" coords="569,265,636,291"/>
<area shape="rect" id="node13" href="../../da/d6c/voxel_8c.html#a2d502a871e36992b74083d7f81377d9b" title="run_voxel" alt="" coords="563,315,642,340"/>
<area shape="rect" id="node15" href="../../da/d32/writing_8c.html#a95a0514071cfac42ef963ccead9acb49" title="run_writing" alt="" coords="559,364,646,389"/>
<area shape="rect" id="node17" href="../../df/d09/detector_8c.html#a677c1747fd7a58c7f7da3314af5d6120" title="run_detector" alt="" coords="555,413,651,439"/>
</map>
</div>

</div>
</div>
<a id="a482d1347c52a7651d858f842518c705e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a482d1347c52a7651d858f842518c705e">&#9670;&nbsp;</a></span>zero_objectness()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zero_objectness </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/db8/structlayer.html">layer</a>&#160;</td>
          <td class="paramname"><em>l</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00490">490</a> of file <a class="el" href="../../d3/d74/region__layer_8c_source.html">region_layer.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d74/region__layer_8c_source.html#l00137">entry_index()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00066">layer::h</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00068">layer::n</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00163">layer::output</a>, and <a class="el" href="../../d3/d3b/layer_8h_source.html#l00066">layer::w</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d03/nightmare_8c_source.html#l00285">run_nightmare()</a>.</p>
<div class="fragment"><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;{</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordtype">int</span> i, n;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a>; ++i){</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keywordflow">for</span>(n = 0; n &lt; l.<a class="code" href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">n</a>; ++n){</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordtype">int</span> obj_index = <a class="code" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a>(l, 0, n*l.<a class="code" href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">w</a>*l.<a class="code" href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">h</a> + i, 4);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            l.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a>[obj_index] = 0;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        }</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;}</div><div class="ttc" id="structlayer_html_a2e00450d79170c48791a1ed5a6f1d0c4"><div class="ttname"><a href="../../d4/db8/structlayer.html#a2e00450d79170c48791a1ed5a6f1d0c4">layer::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00066">layer.h:66</a></div></div>
<div class="ttc" id="structlayer_html_a454b8980d0186eb0095a25aadef41744"><div class="ttname"><a href="../../d4/db8/structlayer.html#a454b8980d0186eb0095a25aadef41744">layer::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00068">layer.h:68</a></div></div>
<div class="ttc" id="region__layer_8c_html_ac3c785a8f7fdc0d10f1c4330bee08b48"><div class="ttname"><a href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48">entry_index</a></div><div class="ttdeci">int entry_index(layer l, int batch, int location, int entry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d74/region__layer_8c_source.html#l00137">region_layer.c:137</a></div></div>
<div class="ttc" id="structlayer_html_a7766d090f7dac8294b7456c1251ab485"><div class="ttname"><a href="../../d4/db8/structlayer.html#a7766d090f7dac8294b7456c1251ab485">layer::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00066">layer.h:66</a></div></div>
<div class="ttc" id="structlayer_html_a04d23c71428242b3153eda588f844eb3"><div class="ttname"><a href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">layer::output</a></div><div class="ttdeci">float * output</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00163">layer.h:163</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d08/region__layer_8h_a482d1347c52a7651d858f842518c705e_cgraph.png" border="0" usemap="#df/d08/region__layer_8h_a482d1347c52a7651d858f842518c705e_cgraph" alt=""/></div>
<map name="df/d08/region__layer_8h_a482d1347c52a7651d858f842518c705e_cgraph" id="df/d08/region__layer_8h_a482d1347c52a7651d858f842518c705e_cgraph">
<area shape="rect" id="node2" href="../../d3/d74/region__layer_8c.html#ac3c785a8f7fdc0d10f1c4330bee08b48" title="entry_index" alt="" coords="172,5,262,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d08/region__layer_8h_a482d1347c52a7651d858f842518c705e_icgraph.png" border="0" usemap="#df/d08/region__layer_8h_a482d1347c52a7651d858f842518c705e_icgraph" alt=""/></div>
<map name="df/d08/region__layer_8h_a482d1347c52a7651d858f842518c705e_icgraph" id="df/d08/region__layer_8h_a482d1347c52a7651d858f842518c705e_icgraph">
<area shape="rect" id="node2" href="../../dd/d03/nightmare_8c.html#aaefb0ed0f5bd621bb9e131e2bc1b4852" title="run_nightmare" alt="" coords="172,5,279,31"/>
<area shape="rect" id="node3" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="327,5,377,31"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat May 27 2017 01:13:33 for Darknet by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
