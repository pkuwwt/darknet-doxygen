<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Darknet: lsd.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Darknet
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">lsd.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../d9/d94/network_8h_source.html">network.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/dd0/cost__layer_8h_source.html">cost_layer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d36/parser_8h_source.html">parser.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/df1/blas_8h_source.html">blas.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for lsd.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d6c/lsd_8c__incl.png" border="0" usemap="#lsd_8c" alt=""/></div>
<map name="lsd_8c" id="lsd_8c">
<area shape="rect" id="node2" href="../../d9/d94/network_8h.html" title="network.h" alt="" coords="332,152,411,177"/>
<area shape="rect" id="node19" href="../../d5/dd0/cost__layer_8h.html" title="cost_layer.h" alt="" coords="220,79,313,104"/>
<area shape="rect" id="node20" href="../../d5/d60/utils_8h.html" title="utils.h" alt="" coords="621,225,677,251"/>
<area shape="rect" id="node22" href="../../d5/d36/parser_8h.html" title="parser.h" alt="" coords="337,79,406,104"/>
<area shape="rect" id="node23" href="../../d8/df1/blas_8h.html" title="blas.h" alt="" coords="531,79,588,104"/>
<area shape="rect" id="node3" href="../../d5/db2/image_8h.html" title="image.h" alt="" coords="493,299,562,324"/>
<area shape="rect" id="node10" href="../../d3/d3b/layer_8h.html" title="layer.h" alt="" coords="216,225,277,251"/>
<area shape="rect" id="node14" href="../../d3/d09/tree_8h.html" title="tree.h" alt="" coords="219,299,274,324"/>
<area shape="rect" id="node15" href="../../d2/dbd/data_8h.html" title="data.h" alt="" coords="396,225,454,251"/>
<area shape="rect" id="node9" href="../../dc/d19/box_8h.html" title="box.h" alt="" coords="515,372,569,397"/>
<area shape="rect" id="node11" href="../../de/d92/activations_8h.html" title="activations.h" alt="" coords="5,299,101,324"/>
<area shape="rect" id="node12" href="../../dc/d57/cuda_8h.html" title="cuda.h" alt="" coords="22,372,84,397"/>
<area shape="rect" id="node17" href="../../dd/df4/matrix_8h.html" title="matrix.h" alt="" coords="299,299,367,324"/>
<area shape="rect" id="node18" href="../../da/d23/list_8h.html" title="list.h" alt="" coords="586,299,635,324"/>
</map>
</div>
</div>
<p><a href="../../d2/da6/lsd_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0ff5b76eeaf6a6f3ea748d9e7d02de52"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/da6/lsd_8c.html#a0ff5b76eeaf6a6f3ea748d9e7d02de52">test_dcgan</a> (char *cfgfile, char *weightfile)</td></tr>
<tr class="separator:a0ff5b76eeaf6a6f3ea748d9e7d02de52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d817b1ff6b8fa827c3e85b965110afd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/da6/lsd_8c.html#a8d817b1ff6b8fa827c3e85b965110afd">dcgan_batch</a> (<a class="el" href="../../de/d45/structnetwork.html">network</a> gnet, <a class="el" href="../../de/d45/structnetwork.html">network</a> anet)</td></tr>
<tr class="separator:a8d817b1ff6b8fa827c3e85b965110afd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13f25021852f255bb81359944d2e1a24"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/da6/lsd_8c.html#a13f25021852f255bb81359944d2e1a24">train_dcgan</a> (char *cfg, char *weight, char *acfg, char *aweight, int clear, int display, char *train_images)</td></tr>
<tr class="separator:a13f25021852f255bb81359944d2e1a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ae443574ec61dc746fa85f65d6d1cf2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/da6/lsd_8c.html#a2ae443574ec61dc746fa85f65d6d1cf2">train_colorizer</a> (char *cfg, char *weight, char *acfg, char *aweight, int clear, int display)</td></tr>
<tr class="separator:a2ae443574ec61dc746fa85f65d6d1cf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcf2acb0200df9fc8e4d96d998658bdd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/da6/lsd_8c.html#abcf2acb0200df9fc8e4d96d998658bdd">test_lsd</a> (char *cfgfile, char *weightfile, char *filename, int gray)</td></tr>
<tr class="separator:abcf2acb0200df9fc8e4d96d998658bdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab48437873371bf1e3ff2b7714109f178"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/da6/lsd_8c.html#ab48437873371bf1e3ff2b7714109f178">run_lsd</a> (int argc, char **argv)</td></tr>
<tr class="separator:ab48437873371bf1e3ff2b7714109f178"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8d817b1ff6b8fa827c3e85b965110afd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d817b1ff6b8fa827c3e85b965110afd">&#9670;&nbsp;</a></span>dcgan_batch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dcgan_batch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d45/structnetwork.html">network</a>&#160;</td>
          <td class="paramname"><em>gnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d45/structnetwork.html">network</a>&#160;</td>
          <td class="paramname"><em>anet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/lsd_8c_source.html#l00436">436</a> of file <a class="el" href="../../d2/da6/lsd_8c_source.html">lsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;{</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">//float *input = calloc(x_size, sizeof(float));</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="ab48437873371bf1e3ff2b7714109f178"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab48437873371bf1e3ff2b7714109f178">&#9670;&nbsp;</a></span>run_lsd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void run_lsd </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/lsd_8c_source.html#l01111">1111</a> of file <a class="el" href="../../d2/da6/lsd_8c_source.html">lsd.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d91/utils_8c_source.html#l00080">find_arg()</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00123">find_char_arg()</a>, <a class="el" href="../../d2/da6/lsd_8c_source.html#l00390">test_dcgan()</a>, <a class="el" href="../../d2/da6/lsd_8c_source.html#l01052">test_lsd()</a>, <a class="el" href="../../d2/da6/lsd_8c_source.html#l00623">train_colorizer()</a>, and <a class="el" href="../../d2/da6/lsd_8c_source.html#l00442">train_dcgan()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/df8/darknet_8c_source.html#l00389">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;{</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">if</span>(argc &lt; 4){</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;usage: %s %s [train/test/valid] [cfg] [weights (optional)]\n&quot;</span>, argv[0], argv[1]);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    }</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keywordtype">int</span> clear = <a class="code" href="../../d3/d91/utils_8c.html#a845f7b956fcb9711346b8189e18d3846">find_arg</a>(argc, argv, <span class="stringliteral">&quot;-clear&quot;</span>);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordtype">int</span> display = <a class="code" href="../../d3/d91/utils_8c.html#a845f7b956fcb9711346b8189e18d3846">find_arg</a>(argc, argv, <span class="stringliteral">&quot;-display&quot;</span>);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keywordtype">char</span> *file = <a class="code" href="../../d3/d91/utils_8c.html#a22c33a506b0842cadb2a5530a25ca7bf">find_char_arg</a>(argc, argv, <span class="stringliteral">&quot;-file&quot;</span>, <span class="stringliteral">&quot;/home/pjreddie/data/imagenet/imagenet1k.train.list&quot;</span>);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keywordtype">char</span> *cfg = argv[3];</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keywordtype">char</span> *weights = (argc &gt; 4) ? argv[4] : 0;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordtype">char</span> *filename = (argc &gt; 5) ? argv[5] : 0;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordtype">char</span> *acfg = argv[5];</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keywordtype">char</span> *aweights = (argc &gt; 6) ? argv[6] : 0;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="comment">//if(0==strcmp(argv[2], &quot;train&quot;)) train_lsd(cfg, weights, clear);</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="comment">//else if(0==strcmp(argv[2], &quot;train2&quot;)) train_lsd2(cfg, weights, acfg, aweights, clear);</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="comment">//else if(0==strcmp(argv[2], &quot;traincolor&quot;)) train_colorizer(cfg, weights, acfg, aweights, clear);</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="comment">//else if(0==strcmp(argv[2], &quot;train3&quot;)) train_lsd3(argv[3], argv[4], argv[5], argv[6], argv[7], argv[8], clear);</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keywordflow">if</span>(0==strcmp(argv[2], <span class="stringliteral">&quot;traingan&quot;</span>)) <a class="code" href="../../d2/da6/lsd_8c.html#a13f25021852f255bb81359944d2e1a24">train_dcgan</a>(cfg, weights, acfg, aweights, clear, display, file);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0==strcmp(argv[2], <span class="stringliteral">&quot;traincolor&quot;</span>)) <a class="code" href="../../d2/da6/lsd_8c.html#a2ae443574ec61dc746fa85f65d6d1cf2">train_colorizer</a>(cfg, weights, acfg, aweights, clear, display);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0==strcmp(argv[2], <span class="stringliteral">&quot;gan&quot;</span>)) <a class="code" href="../../d2/da6/lsd_8c.html#a0ff5b76eeaf6a6f3ea748d9e7d02de52">test_dcgan</a>(cfg, weights);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0==strcmp(argv[2], <span class="stringliteral">&quot;test&quot;</span>)) <a class="code" href="../../d2/da6/lsd_8c.html#abcf2acb0200df9fc8e4d96d998658bdd">test_lsd</a>(cfg, weights, filename, 0);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0==strcmp(argv[2], <span class="stringliteral">&quot;color&quot;</span>)) <a class="code" href="../../d2/da6/lsd_8c.html#abcf2acb0200df9fc8e4d96d998658bdd">test_lsd</a>(cfg, weights, filename, 1);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">       else if(0==strcmp(argv[2], &quot;valid&quot;)) validate_lsd(cfg, weights);</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;}</div><div class="ttc" id="lsd_8c_html_a0ff5b76eeaf6a6f3ea748d9e7d02de52"><div class="ttname"><a href="../../d2/da6/lsd_8c.html#a0ff5b76eeaf6a6f3ea748d9e7d02de52">test_dcgan</a></div><div class="ttdeci">void test_dcgan(char *cfgfile, char *weightfile)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da6/lsd_8c_source.html#l00390">lsd.c:390</a></div></div>
<div class="ttc" id="utils_8c_html_a22c33a506b0842cadb2a5530a25ca7bf"><div class="ttname"><a href="../../d3/d91/utils_8c.html#a22c33a506b0842cadb2a5530a25ca7bf">find_char_arg</a></div><div class="ttdeci">char * find_char_arg(int argc, char **argv, char *arg, char *def)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00123">utils.c:123</a></div></div>
<div class="ttc" id="lsd_8c_html_a13f25021852f255bb81359944d2e1a24"><div class="ttname"><a href="../../d2/da6/lsd_8c.html#a13f25021852f255bb81359944d2e1a24">train_dcgan</a></div><div class="ttdeci">void train_dcgan(char *cfg, char *weight, char *acfg, char *aweight, int clear, int display, char *train_images)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da6/lsd_8c_source.html#l00442">lsd.c:442</a></div></div>
<div class="ttc" id="lsd_8c_html_a2ae443574ec61dc746fa85f65d6d1cf2"><div class="ttname"><a href="../../d2/da6/lsd_8c.html#a2ae443574ec61dc746fa85f65d6d1cf2">train_colorizer</a></div><div class="ttdeci">void train_colorizer(char *cfg, char *weight, char *acfg, char *aweight, int clear, int display)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da6/lsd_8c_source.html#l00623">lsd.c:623</a></div></div>
<div class="ttc" id="lsd_8c_html_abcf2acb0200df9fc8e4d96d998658bdd"><div class="ttname"><a href="../../d2/da6/lsd_8c.html#abcf2acb0200df9fc8e4d96d998658bdd">test_lsd</a></div><div class="ttdeci">void test_lsd(char *cfgfile, char *weightfile, char *filename, int gray)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da6/lsd_8c_source.html#l01052">lsd.c:1052</a></div></div>
<div class="ttc" id="utils_8c_html_a845f7b956fcb9711346b8189e18d3846"><div class="ttname"><a href="../../d3/d91/utils_8c.html#a845f7b956fcb9711346b8189e18d3846">find_arg</a></div><div class="ttdeci">int find_arg(int argc, char *argv[], char *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00080">utils.c:80</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/lsd_8c_ab48437873371bf1e3ff2b7714109f178_cgraph.png" border="0" usemap="#d2/da6/lsd_8c_ab48437873371bf1e3ff2b7714109f178_cgraph" alt=""/></div>
<map name="d2/da6/lsd_8c_ab48437873371bf1e3ff2b7714109f178_cgraph" id="d2/da6/lsd_8c_ab48437873371bf1e3ff2b7714109f178_cgraph">
<area shape="rect" id="node2" href="../../d3/d91/utils_8c.html#a845f7b956fcb9711346b8189e18d3846" title="find_arg" alt="" coords="136,69,206,95"/>
<area shape="rect" id="node4" href="../../d3/d91/utils_8c.html#a22c33a506b0842cadb2a5530a25ca7bf" title="find_char_arg" alt="" coords="119,183,222,208"/>
<area shape="rect" id="node5" href="../../d2/da6/lsd_8c.html#a0ff5b76eeaf6a6f3ea748d9e7d02de52" title="test_dcgan" alt="" coords="128,360,214,385"/>
<area shape="rect" id="node28" href="../../d2/da6/lsd_8c.html#abcf2acb0200df9fc8e4d96d998658bdd" title="test_lsd" alt="" coords="137,709,205,735"/>
<area shape="rect" id="node33" href="../../d2/da6/lsd_8c.html#a2ae443574ec61dc746fa85f65d6d1cf2" title="train_colorizer" alt="" coords="118,1612,223,1637"/>
<area shape="rect" id="node50" href="../../d2/da6/lsd_8c.html#a13f25021852f255bb81359944d2e1a24" title="train_dcgan" alt="" coords="125,1415,216,1440"/>
<area shape="rect" id="node3" href="../../d3/d91/utils_8c.html#ae8f911d0e43e2013b752049d7fd8aa48" title="del_arg" alt="" coords="326,5,391,31"/>
<area shape="rect" id="node6" href="../../d2/d72/parser_8c.html#abb6f2aa1c5d5bf340faae09be6538c56" title="parse_network_cfg" alt="" coords="493,811,627,836"/>
<area shape="rect" id="node15" href="../../d2/d72/parser_8c.html#a60957f4d236ea8e417999b1778ec3d55" title="load_weights" alt="" coords="511,860,610,885"/>
<area shape="rect" id="node16" href="../../d6/d6e/network_8c.html#a0cf39a1104b8f0415c56796b54a3670a" title="set_batch_network" alt="" coords="292,459,425,484"/>
<area shape="rect" id="node17" href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1" title="make_image" alt="" coords="512,508,609,533"/>
<area shape="rect" id="node18" href="../../d3/d91/utils_8c.html#a5b5b0c77bb2f450bce70777573f7ca90" title="rand_normal" alt="" coords="310,557,407,583"/>
<area shape="rect" id="node19" href="../../d6/d6e/network_8c.html#a40ea1072011345fcf25951b4a5d429a6" title="network_predict" alt="" coords="301,409,416,435"/>
<area shape="rect" id="node20" href="../../d6/d6e/network_8c.html#a5bb83a6363a3ed2358ce290c69be0d06" title="get_network_image_layer" alt="" coords="271,360,445,385"/>
<area shape="rect" id="node22" href="../../d3/d10/image_8c.html#af356da76473c9b9cfc55a5f93960e967" title="normalize_image" alt="" coords="297,157,420,183"/>
<area shape="rect" id="node23" href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e" title="sec" alt="" coords="337,1012,380,1037"/>
<area shape="rect" id="node24" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70" title="show_image" alt="" coords="310,759,407,784"/>
<area shape="rect" id="node26" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160" title="free_image" alt="" coords="516,608,604,633"/>
<area shape="rect" id="node27" href="../../d3/d10/image_8c.html#a0c7a63330d7929a012da0a95694eb363" title="save_image" alt="" coords="514,659,607,684"/>
<area shape="rect" id="node7" href="../../d2/d72/parser_8c.html#a3275ec64d90febff7c0b69c9c5253893" title="read_cfg" alt="" coords="710,761,783,787"/>
<area shape="rect" id="node8" href="../../d3/d91/utils_8c.html#a6c317cffefb9737fb2260da73688f275" title="error" alt="" coords="865,960,914,985"/>
<area shape="rect" id="node9" href="../../d6/d6e/network_8c.html#ad2dcde69603d71857d11484ae99bd8fe" title="make_network" alt="" coords="692,811,800,836"/>
<area shape="rect" id="node10" href="../../d2/d72/parser_8c.html#ad1828ac8171ebfd2b0810efb68a892d8" title="is_network" alt="" coords="704,860,789,885"/>
<area shape="rect" id="node11" href="../../d2/d72/parser_8c.html#a21c6f7046fcd48a8cfd74c23fcf944ca" title="parse_net_options" alt="" coords="681,712,812,737"/>
<area shape="rect" id="node12" href="../../d2/d72/parser_8c.html#a97c3da45ea6b7b689493efb262b35de8" title="free_section" alt="" coords="699,959,793,984"/>
<area shape="rect" id="node13" href="../../d2/d72/parser_8c.html#a990806ef35cd5caa481e2c9bb93442a9" title="string_to_layer_type" alt="" coords="675,663,817,688"/>
<area shape="rect" id="node14" href="../../d2/d72/parser_8c.html#a471db4c53b8d77ab23576fe4c6856d3f" title="parse_convolutional" alt="" coords="676,909,816,935"/>
<area shape="rect" id="node21" href="../../d3/d10/image_8c.html#a30912fff1b55bfe3f46db0dcf74f6024" title="float_to_image" alt="" coords="506,1063,615,1088"/>
<area shape="rect" id="node25" href="../../d3/d10/image_8c.html#ae8ec59e2e5d3166e688d80a0e2869e80" title="constrain_image" alt="" coords="501,911,620,936"/>
<area shape="rect" id="node29" href="../../d3/d10/image_8c.html#a233b57091bac94f82d8aa0d8a5c1f070" title="load_image_color" alt="" coords="683,1124,809,1149"/>
<area shape="rect" id="node30" href="../../d3/d10/image_8c.html#a0fe6118be83ce80a0c5a912219000293" title="resize_min" alt="" coords="316,709,401,735"/>
<area shape="rect" id="node31" href="../../d3/d10/image_8c.html#ad323458860dbdb7a2af97b9b35ad91bf" title="crop_image" alt="" coords="313,508,404,533"/>
<area shape="rect" id="node32" href="../../d3/d10/image_8c.html#a3118a7b2d46587811e9d538cbec7d314" title="grayscale_image_3c" alt="" coords="287,1164,430,1189"/>
<area shape="rect" id="node34" href="../../d3/d91/utils_8c.html#afe996fdc7e45995e94f02d55845e163b" title="basecfg" alt="" coords="324,1513,392,1539"/>
<area shape="rect" id="node35" href="../../d6/d6e/network_8c.html#aa06b8ad6a6fb64daed0801ad5d4009a2" title="load_network" alt="" coords="308,1415,409,1440"/>
<area shape="rect" id="node36" href="../../de/da9/data_8c.html#a3c0e083ce3917bb394ca5708a52f34f5" title="get_paths" alt="" coords="319,1612,398,1637"/>
<area shape="rect" id="node37" href="../../d7/d40/list_8c.html#a29e21d306ccd944370665f439d7ca37d" title="list_to_array" alt="" coords="311,1661,405,1687"/>
<area shape="rect" id="node38" href="../../d6/d6e/network_8c.html#a83fdde9a3ff298cf8066a781319a6ec1" title="get_base_args" alt="" coords="304,1711,413,1736"/>
<area shape="rect" id="node39" href="../../de/da9/data_8c.html#ab5f0db527025988c7478eddea9d97141" title="load_thread" alt="" coords="515,1188,606,1213"/>
<area shape="rect" id="node40" href="../../de/da9/data_8c.html#a887edef560c1d5fe3f395f02c0a00612" title="load_data_in_thread" alt="" coords="287,1464,430,1489"/>
<area shape="rect" id="node41" href="../../d6/d6e/network_8c.html#a95734b6e69a080abf33395707ab56b59" title="get_current_batch" alt="" coords="496,2011,625,2036"/>
<area shape="rect" id="node42" href="../../de/da9/data_8c.html#aa1204f7048d4034131fcb700809087e4" title="copy_data" alt="" coords="317,1859,400,1884"/>
<area shape="rect" id="node43" href="../../de/da9/data_8c.html#a338d58d41be3703ef4ce443e5bb4e52f" title="get_next_batch" alt="" coords="504,1760,617,1785"/>
<area shape="rect" id="node44" href="../../dc/d50/blas_8c.html#a22f6b03dd54e2d4b249e53a0ca14434c" title="copy_cpu" alt="" coords="319,1316,398,1341"/>
<area shape="rect" id="node45" href="../../de/da9/data_8c.html#aa9c8a2657c930195dd492ed99a7a0bb2" title="concat_data" alt="" coords="311,1365,405,1391"/>
<area shape="rect" id="node46" href="../../d6/d6e/network_8c.html#aeb752f771f5cfe8c401fc8dee8f3e439" title="train_network" alt="" coords="308,1760,409,1785"/>
<area shape="rect" id="node47" href="../../de/da9/data_8c.html#a4b0ce36f011ddb4b2ba58f58114d3219" title="free_data" alt="" coords="320,1563,397,1588"/>
<area shape="rect" id="node48" href="../../d6/d6e/network_8c.html#ac997daf700149608de15d93a083c33dc" title="get_current_rate" alt="" coords="299,2011,418,2036"/>
<area shape="rect" id="node49" href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10" title="save_weights" alt="" coords="307,1809,410,1835"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/lsd_8c_ab48437873371bf1e3ff2b7714109f178_icgraph.png" border="0" usemap="#d2/da6/lsd_8c_ab48437873371bf1e3ff2b7714109f178_icgraph" alt=""/></div>
<map name="d2/da6/lsd_8c_ab48437873371bf1e3ff2b7714109f178_icgraph" id="d2/da6/lsd_8c_ab48437873371bf1e3ff2b7714109f178_icgraph">
<area shape="rect" id="node2" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="118,5,169,31"/>
</map>
</div>

</div>
</div>
<a id="a0ff5b76eeaf6a6f3ea748d9e7d02de52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ff5b76eeaf6a6f3ea748d9e7d02de52">&#9670;&nbsp;</a></span>test_dcgan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_dcgan </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>cfgfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>weightfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/lsd_8c_source.html#l00390">390</a> of file <a class="el" href="../../d2/da6/lsd_8c_source.html">lsd.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/db2/image_8h_source.html#l00025">image::c</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00047">network::c</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00026">image::data</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l01523">free_image()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00385">get_network_image_layer()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00023">image::h</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00047">network::h</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00022">network::layers</a>, <a class="el" href="../../d2/d72/parser_8c_source.html#l01127">load_weights()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00636">make_image()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00015">network::n</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00429">network_predict()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00349">normalize_image()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00067">layer::out_c</a>, <a class="el" href="../../d2/d72/parser_8c_source.html#l00618">parse_network_cfg()</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00576">rand_normal()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00597">save_image()</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00192">sec()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00285">set_batch_network()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00459">show_image()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00024">image::w</a>, and <a class="el" href="../../d9/d94/network_8h_source.html#l00047">network::w</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/da6/lsd_8c_source.html#l01111">run_lsd()</a>.</p>
<div class="fragment"><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;{</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="../../de/d45/structnetwork.html">network</a> net = <a class="code" href="../../d2/d72/parser_8c.html#abb6f2aa1c5d5bf340faae09be6538c56">parse_network_cfg</a>(cfgfile);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">if</span>(weightfile){</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <a class="code" href="../../d2/d72/parser_8c.html#a60957f4d236ea8e417999b1778ec3d55">load_weights</a>(&amp;net, weightfile);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a0cf39a1104b8f0415c56796b54a3670a">set_batch_network</a>(&amp;net, 1);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    srand(2222222);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    clock_t time;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordtype">char</span> buff[256];</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordtype">char</span> *input = buff;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordtype">int</span> i, imlayer = 0;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; net.<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a>; ++i) {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">if</span> (net.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[i].<a class="code" href="../../d4/db8/structlayer.html#a298d150dabc449824204579f4851b926">out_c</a> == 3) {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            imlayer = i;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            printf(<span class="stringliteral">&quot;%d\n&quot;</span>, i);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">while</span>(1){</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <a class="code" href="../../de/d68/structimage.html">image</a> im = <a class="code" href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1">make_image</a>(net.<a class="code" href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">w</a>, net.<a class="code" href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">h</a>, net.<a class="code" href="../../de/d45/structnetwork.html#a05014921b926874b8a362aa83d98283a">c</a>);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; im.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a>*im.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a>*im.<a class="code" href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">c</a>; ++i){</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            im.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>[i] = <a class="code" href="../../d3/d91/utils_8c.html#a5b5b0c77bb2f450bce70777573f7ca90">rand_normal</a>();</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordtype">float</span> *X = im.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        time=clock();</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <a class="code" href="../../d6/d6e/network_8c.html#a40ea1072011345fcf25951b4a5d429a6">network_predict</a>(net, X);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="../../de/d68/structimage.html">image</a> out = <a class="code" href="../../d6/d6e/network_8c.html#a5bb83a6363a3ed2358ce290c69be0d06">get_network_image_layer</a>(net, imlayer);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="comment">//yuv_to_rgb(out);</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#af356da76473c9b9cfc55a5f93960e967">normalize_image</a>(out);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        printf(<span class="stringliteral">&quot;%s: Predicted in %f seconds.\n&quot;</span>, input, <a class="code" href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e">sec</a>(clock()-time));</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70">show_image</a>(out, <span class="stringliteral">&quot;out&quot;</span>);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a0c7a63330d7929a012da0a95694eb363">save_image</a>(out, <span class="stringliteral">&quot;out&quot;</span>);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor">#ifdef OPENCV</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        cvWaitKey(0);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(im);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div><div class="ttc" id="image_8c_html_af356da76473c9b9cfc55a5f93960e967"><div class="ttname"><a href="../../d3/d10/image_8c.html#af356da76473c9b9cfc55a5f93960e967">normalize_image</a></div><div class="ttdeci">void normalize_image(image p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00349">image.c:349</a></div></div>
<div class="ttc" id="structimage_html"><div class="ttname"><a href="../../de/d68/structimage.html">image</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00022">image.h:22</a></div></div>
<div class="ttc" id="network_8c_html_a5bb83a6363a3ed2358ce290c69be0d06"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a5bb83a6363a3ed2358ce290c69be0d06">get_network_image_layer</a></div><div class="ttdeci">image get_network_image_layer(network net, int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00385">network.c:385</a></div></div>
<div class="ttc" id="network_8c_html_a40ea1072011345fcf25951b4a5d429a6"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a40ea1072011345fcf25951b4a5d429a6">network_predict</a></div><div class="ttdeci">float * network_predict(network net, float *input)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00429">network.c:429</a></div></div>
<div class="ttc" id="structlayer_html_a298d150dabc449824204579f4851b926"><div class="ttname"><a href="../../d4/db8/structlayer.html#a298d150dabc449824204579f4851b926">layer::out_c</a></div><div class="ttdeci">int out_c</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00067">layer.h:67</a></div></div>
<div class="ttc" id="structimage_html_a30e2caee481a59608823b3bcec8a139f"><div class="ttname"><a href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">image::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00023">image.h:23</a></div></div>
<div class="ttc" id="structnetwork_html"><div class="ttname"><a href="../../de/d45/structnetwork.html">network</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00014">network.h:14</a></div></div>
<div class="ttc" id="image_8c_html_a726c30d7f0779c46f9ba5b8a3c2f94a1"><div class="ttname"><a href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1">make_image</a></div><div class="ttdeci">image make_image(int w, int h, int c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00636">image.c:636</a></div></div>
<div class="ttc" id="structnetwork_html_a9770423f88b722bafc9d1fd3c6091d75"><div class="ttname"><a href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">network::layers</a></div><div class="ttdeci">layer * layers</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00022">network.h:22</a></div></div>
<div class="ttc" id="utils_8c_html_a375f4de29b8973c3e1b63bf49a5eb00e"><div class="ttname"><a href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e">sec</a></div><div class="ttdeci">float sec(clock_t clocks)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00192">utils.c:192</a></div></div>
<div class="ttc" id="image_8c_html_a1b35e408b961d58f7e29ec146be91160"><div class="ttname"><a href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a></div><div class="ttdeci">void free_image(image m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l01523">image.c:1523</a></div></div>
<div class="ttc" id="structimage_html_aa67d2491c4d17dd240453d69dfc99482"><div class="ttname"><a href="../../de/d68/structimage.html#aa67d2491c4d17dd240453d69dfc99482">image::c</a></div><div class="ttdeci">int c</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00025">image.h:25</a></div></div>
<div class="ttc" id="structimage_html_aa6480e4024a0d5ca8d36b4145b3ceb43"><div class="ttname"><a href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">image::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00024">image.h:24</a></div></div>
<div class="ttc" id="parser_8c_html_abb6f2aa1c5d5bf340faae09be6538c56"><div class="ttname"><a href="../../d2/d72/parser_8c.html#abb6f2aa1c5d5bf340faae09be6538c56">parse_network_cfg</a></div><div class="ttdeci">network parse_network_cfg(char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d72/parser_8c_source.html#l00618">parser.c:618</a></div></div>
<div class="ttc" id="network_8c_html_a0cf39a1104b8f0415c56796b54a3670a"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a0cf39a1104b8f0415c56796b54a3670a">set_batch_network</a></div><div class="ttdeci">void set_batch_network(network *net, int b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00285">network.c:285</a></div></div>
<div class="ttc" id="image_8c_html_a0c7a63330d7929a012da0a95694eb363"><div class="ttname"><a href="../../d3/d10/image_8c.html#a0c7a63330d7929a012da0a95694eb363">save_image</a></div><div class="ttdeci">void save_image(image im, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00597">image.c:597</a></div></div>
<div class="ttc" id="image_8c_html_a5807da5b9392f853749db3e7c727bd70"><div class="ttname"><a href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70">show_image</a></div><div class="ttdeci">void show_image(image p, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00459">image.c:459</a></div></div>
<div class="ttc" id="utils_8c_html_a5b5b0c77bb2f450bce70777573f7ca90"><div class="ttname"><a href="../../d3/d91/utils_8c.html#a5b5b0c77bb2f450bce70777573f7ca90">rand_normal</a></div><div class="ttdeci">float rand_normal()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00576">utils.c:576</a></div></div>
<div class="ttc" id="structnetwork_html_a05014921b926874b8a362aa83d98283a"><div class="ttname"><a href="../../de/d45/structnetwork.html#a05014921b926874b8a362aa83d98283a">network::c</a></div><div class="ttdeci">int c</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00047">network.h:47</a></div></div>
<div class="ttc" id="structnetwork_html_a0e57f4230f8ecb07bba0c97cf8f045c7"><div class="ttname"><a href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">network::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00047">network.h:47</a></div></div>
<div class="ttc" id="structnetwork_html_a1c7625720955322d05924a075d013877"><div class="ttname"><a href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">network::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00015">network.h:15</a></div></div>
<div class="ttc" id="structnetwork_html_a944b83cb20da2454c6092e07b9a1d3e9"><div class="ttname"><a href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">network::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00047">network.h:47</a></div></div>
<div class="ttc" id="parser_8c_html_a60957f4d236ea8e417999b1778ec3d55"><div class="ttname"><a href="../../d2/d72/parser_8c.html#a60957f4d236ea8e417999b1778ec3d55">load_weights</a></div><div class="ttdeci">void load_weights(network *net, char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d72/parser_8c_source.html#l01127">parser.c:1127</a></div></div>
<div class="ttc" id="structimage_html_aed7e0704080213b735419d6661251a0a"><div class="ttname"><a href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">image::data</a></div><div class="ttdeci">float * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00026">image.h:26</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/lsd_8c_a0ff5b76eeaf6a6f3ea748d9e7d02de52_cgraph.png" border="0" usemap="#d2/da6/lsd_8c_a0ff5b76eeaf6a6f3ea748d9e7d02de52_cgraph" alt=""/></div>
<map name="d2/da6/lsd_8c_a0ff5b76eeaf6a6f3ea748d9e7d02de52_cgraph" id="d2/da6/lsd_8c_a0ff5b76eeaf6a6f3ea748d9e7d02de52_cgraph">
<area shape="rect" id="node2" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160" title="free_image" alt="" coords="395,56,483,81"/>
<area shape="rect" id="node3" href="../../d6/d6e/network_8c.html#a5bb83a6363a3ed2358ce290c69be0d06" title="get_network_image_layer" alt="" coords="140,5,314,31"/>
<area shape="rect" id="node6" href="../../d2/d72/parser_8c.html#a60957f4d236ea8e417999b1778ec3d55" title="load_weights" alt="" coords="177,259,276,284"/>
<area shape="rect" id="node8" href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1" title="make_image" alt="" coords="390,105,488,131"/>
<area shape="rect" id="node9" href="../../d6/d6e/network_8c.html#a40ea1072011345fcf25951b4a5d429a6" title="network_predict" alt="" coords="169,308,285,333"/>
<area shape="rect" id="node11" href="../../d3/d10/image_8c.html#af356da76473c9b9cfc55a5f93960e967" title="normalize_image" alt="" coords="165,357,288,383"/>
<area shape="rect" id="node12" href="../../d2/d72/parser_8c.html#abb6f2aa1c5d5bf340faae09be6538c56" title="parse_network_cfg" alt="" coords="160,1061,294,1087"/>
<area shape="rect" id="node46" href="../../d3/d91/utils_8c.html#a5b5b0c77bb2f450bce70777573f7ca90" title="rand_normal" alt="" coords="179,1111,275,1136"/>
<area shape="rect" id="node47" href="../../d3/d10/image_8c.html#a0c7a63330d7929a012da0a95694eb363" title="save_image" alt="" coords="393,207,486,232"/>
<area shape="rect" id="node48" href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e" title="sec" alt="" coords="206,1160,248,1185"/>
<area shape="rect" id="node49" href="../../d6/d6e/network_8c.html#a0cf39a1104b8f0415c56796b54a3670a" title="set_batch_network" alt="" coords="160,1209,294,1235"/>
<area shape="rect" id="node50" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70" title="show_image" alt="" coords="179,157,275,183"/>
<area shape="rect" id="node4" href="../../d3/d10/image_8c.html#a30912fff1b55bfe3f46db0dcf74f6024" title="float_to_image" alt="" coords="385,5,494,31"/>
<area shape="rect" id="node5" href="../../d3/d10/image_8c.html#a28bb9f835989b2f7e908386421c52837" title="make_empty_image" alt="" coords="572,105,713,131"/>
<area shape="rect" id="node7" href="../../d2/d72/parser_8c.html#abb17f71fa3838540cc5eff6492cce5e6" title="load_weights_upto" alt="" coords="373,256,506,281"/>
<area shape="rect" id="node10" href="../../d6/d6e/network_8c.html#affc7ba2c94d58f52043a19d4c8151daa" title="forward_network" alt="" coords="379,305,499,331"/>
<area shape="rect" id="node13" href="../../d2/d72/parser_8c.html#a3275ec64d90febff7c0b69c9c5253893" title="read_cfg" alt="" coords="403,1061,476,1087"/>
<area shape="rect" id="node14" href="../../d3/d91/utils_8c.html#a6c317cffefb9737fb2260da73688f275" title="error" alt="" coords="618,1235,667,1260"/>
<area shape="rect" id="node15" href="../../d6/d6e/network_8c.html#ad2dcde69603d71857d11484ae99bd8fe" title="make_network" alt="" coords="385,456,493,481"/>
<area shape="rect" id="node16" href="../../d2/d72/parser_8c.html#ad1828ac8171ebfd2b0810efb68a892d8" title="is_network" alt="" coords="397,505,482,531"/>
<area shape="rect" id="node17" href="../../d2/d72/parser_8c.html#a21c6f7046fcd48a8cfd74c23fcf944ca" title="parse_net_options" alt="" coords="374,1604,505,1629"/>
<area shape="rect" id="node18" href="../../d8/ddc/option__list_8c.html#a8d1e0e1e5d373284b9fccf658239ee35" title="option_find_int_quiet" alt="" coords="570,1531,715,1556"/>
<area shape="rect" id="node19" href="../../d8/ddc/option__list_8c.html#a9288689d608093160368113dbdd8ba34" title="option_find_float_quiet" alt="" coords="565,1853,720,1879"/>
<area shape="rect" id="node20" href="../../d2/d72/parser_8c.html#a97c3da45ea6b7b689493efb262b35de8" title="free_section" alt="" coords="392,555,486,580"/>
<area shape="rect" id="node21" href="../../d2/d72/parser_8c.html#a990806ef35cd5caa481e2c9bb93442a9" title="string_to_layer_type" alt="" coords="369,604,510,629"/>
<area shape="rect" id="node22" href="../../d2/d72/parser_8c.html#a471db4c53b8d77ab23576fe4c6856d3f" title="parse_convolutional" alt="" coords="369,1653,509,1679"/>
<area shape="rect" id="node23" href="../../d2/d72/parser_8c.html#a7ad1750e2fb2e9403fa68f21a2c62c28" title="parse_deconvolutional" alt="" coords="362,1259,517,1284"/>
<area shape="rect" id="node24" href="../../d2/d72/parser_8c.html#ae36102ed30d5b253ec3c58df3192c771" title="parse_local" alt="" coords="395,407,484,432"/>
<area shape="rect" id="node25" href="../../d2/d72/parser_8c.html#aa6d3ed6372d755d53624f85c06da7dbe" title="parse_activation" alt="" coords="380,653,499,679"/>
<area shape="rect" id="node26" href="../../d2/d72/parser_8c.html#a5504899aea1400dbc33dba8eac459460" title="parse_rnn" alt="" coords="399,1407,480,1432"/>
<area shape="rect" id="node27" href="../../d2/d72/parser_8c.html#af8d59a4d921f3c03b0977d39feb14ced" title="parse_gru" alt="" coords="399,1456,480,1481"/>
<area shape="rect" id="node28" href="../../d2/d72/parser_8c.html#a4e1046e1d1d1030ad9f473d9b930f2a0" title="parse_crnn" alt="" coords="395,1505,483,1531"/>
<area shape="rect" id="node29" href="../../d2/d72/parser_8c.html#a0ac5e58f1dd180ce1ae1bddc3bb47596" title="parse_connected" alt="" coords="377,1555,501,1580"/>
<area shape="rect" id="node30" href="../../d2/d72/parser_8c.html#a8d1bd90ea4beb8fc3069999af7f4448f" title="parse_crop" alt="" coords="395,1308,483,1333"/>
<area shape="rect" id="node31" href="../../d2/d72/parser_8c.html#a853d2066af42522c1de3f97d0bc0ff29" title="parse_cost" alt="" coords="396,1955,483,1980"/>
<area shape="rect" id="node32" href="../../d2/d72/parser_8c.html#afedfffed817f89349b250c4afe09041c" title="parse_region" alt="" coords="390,1703,489,1728"/>
<area shape="rect" id="node33" href="../../d2/d72/parser_8c.html#ab5cfcdcccf8d8f3fa5f46d4528a70cab" title="parse_detection" alt="" coords="381,1752,497,1777"/>
<area shape="rect" id="node34" href="../../d2/d72/parser_8c.html#a1f908ce65d9b8a102e754f61f00882b3" title="parse_softmax" alt="" coords="385,1853,494,1879"/>
<area shape="rect" id="node35" href="../../d2/d72/parser_8c.html#a070f2ff614c49ca43151b17082372374" title="parse_normalization" alt="" coords="369,703,510,728"/>
<area shape="rect" id="node36" href="../../d2/d72/parser_8c.html#a912380cd9e2ee925a2e0af57cbde0511" title="parse_batchnorm" alt="" coords="377,752,502,777"/>
<area shape="rect" id="node37" href="../../d2/d72/parser_8c.html#abef6e6b93a1c7ba7aef41bf2b95e9d27" title="parse_maxpool" alt="" coords="383,1357,496,1383"/>
<area shape="rect" id="node38" href="../../d2/d72/parser_8c.html#a934cdac39f052fe5f89407b9c99e729e" title="parse_reorg" alt="" coords="393,1209,486,1235"/>
<area shape="rect" id="node39" href="../../d2/d72/parser_8c.html#ad30661bf80ffee22a45132dbcd53043d" title="parse_avgpool" alt="" coords="385,1111,494,1136"/>
<area shape="rect" id="node40" href="../../d2/d72/parser_8c.html#a6a5c32c49b1a691f4e699760b72aff57" title="parse_route" alt="" coords="393,1160,486,1185"/>
<area shape="rect" id="node41" href="../../d2/d72/parser_8c.html#ab297102c068c53158161d4b13d03a53b" title="parse_shortcut" alt="" coords="385,801,494,827"/>
<area shape="rect" id="node42" href="../../d2/d72/parser_8c.html#acd4507a8980581f176f52500997f32ed" title="parse_dropout" alt="" coords="386,851,493,876"/>
<area shape="rect" id="node43" href="../../d8/ddc/option__list_8c.html#abbe6c95ecd6cf53e02d0e49c2cc6adac" title="option_unused" alt="" coords="385,900,494,925"/>
<area shape="rect" id="node44" href="../../d7/d40/list_8c.html#a919f01c7184ba8e6645264cc06516780" title="free_list" alt="" coords="405,949,473,975"/>
<area shape="rect" id="node45" href="../../d6/d6e/network_8c.html#ae04b6dc422751023fd98b9cca4dce93e" title="get_network_output\l_layer" alt="" coords="370,999,509,1037"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/lsd_8c_a0ff5b76eeaf6a6f3ea748d9e7d02de52_icgraph.png" border="0" usemap="#d2/da6/lsd_8c_a0ff5b76eeaf6a6f3ea748d9e7d02de52_icgraph" alt=""/></div>
<map name="d2/da6/lsd_8c_a0ff5b76eeaf6a6f3ea748d9e7d02de52_icgraph" id="d2/da6/lsd_8c_a0ff5b76eeaf6a6f3ea748d9e7d02de52_icgraph">
<area shape="rect" id="node2" href="../../d2/da6/lsd_8c.html#ab48437873371bf1e3ff2b7714109f178" title="run_lsd" alt="" coords="140,5,205,31"/>
<area shape="rect" id="node3" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="253,5,303,31"/>
</map>
</div>

</div>
</div>
<a id="abcf2acb0200df9fc8e4d96d998658bdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcf2acb0200df9fc8e4d96d998658bdd">&#9670;&nbsp;</a></span>test_lsd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_lsd </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>cfgfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>weightfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gray</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/lsd_8c_source.html#l01052">1052</a> of file <a class="el" href="../../d2/da6/lsd_8c_source.html">lsd.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d10/image_8c_source.html#l00340">constrain_image()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00741">crop_image()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00026">image::data</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l01523">free_image()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00385">get_network_image_layer()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l01061">grayscale_image_3c()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00023">image::h</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00047">network::h</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00022">network::layers</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l01368">load_image_color()</a>, <a class="el" href="../../d2/d72/parser_8c_source.html#l01127">load_weights()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00015">network::n</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00429">network_predict()</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00067">layer::out_c</a>, <a class="el" href="../../d2/d72/parser_8c_source.html#l00618">parse_network_cfg()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00881">resize_min()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00597">save_image()</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00192">sec()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00285">set_batch_network()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00459">show_image()</a>, <a class="el" href="../../d5/db2/image_8h_source.html#l00024">image::w</a>, and <a class="el" href="../../d9/d94/network_8h_source.html#l00047">network::w</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/da6/lsd_8c_source.html#l01111">run_lsd()</a>.</p>
<div class="fragment"><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;{</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <a class="code" href="../../de/d45/structnetwork.html">network</a> net = <a class="code" href="../../d2/d72/parser_8c.html#abb6f2aa1c5d5bf340faae09be6538c56">parse_network_cfg</a>(cfgfile);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordflow">if</span>(weightfile){</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <a class="code" href="../../d2/d72/parser_8c.html#a60957f4d236ea8e417999b1778ec3d55">load_weights</a>(&amp;net, weightfile);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    }</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a0cf39a1104b8f0415c56796b54a3670a">set_batch_network</a>(&amp;net, 1);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    srand(2222222);</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    clock_t time;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="keywordtype">char</span> buff[256];</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordtype">char</span> *input = buff;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordtype">int</span> i, imlayer = 0;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; net.<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a>; ++i) {</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordflow">if</span> (net.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[i].<a class="code" href="../../d4/db8/structlayer.html#a298d150dabc449824204579f4851b926">out_c</a> == 3) {</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            imlayer = i;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            printf(<span class="stringliteral">&quot;%d\n&quot;</span>, i);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        }</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    }</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keywordflow">while</span>(1){</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="keywordflow">if</span>(filename){</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            strncpy(input, filename, 256);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            printf(<span class="stringliteral">&quot;Enter Image Path: &quot;</span>);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            fflush(stdout);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            input = fgets(input, 256, stdin);</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            <span class="keywordflow">if</span>(!input) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            strtok(input, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        }</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        <a class="code" href="../../de/d68/structimage.html">image</a> im = <a class="code" href="../../d3/d10/image_8c.html#a233b57091bac94f82d8aa0d8a5c1f070">load_image_color</a>(input, 0, 0);</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <a class="code" href="../../de/d68/structimage.html">image</a> resized = <a class="code" href="../../d3/d10/image_8c.html#a0fe6118be83ce80a0c5a912219000293">resize_min</a>(im, net.<a class="code" href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">w</a>);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <a class="code" href="../../de/d68/structimage.html">image</a> crop = <a class="code" href="../../d3/d10/image_8c.html#ad323458860dbdb7a2af97b9b35ad91bf">crop_image</a>(resized, (resized.<a class="code" href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">w</a> - net.<a class="code" href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">w</a>)/2, (resized.<a class="code" href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">h</a> - net.<a class="code" href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">h</a>)/2, net.<a class="code" href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">w</a>, net.<a class="code" href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">h</a>);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <span class="keywordflow">if</span>(gray) <a class="code" href="../../d3/d10/image_8c.html#a3118a7b2d46587811e9d538cbec7d314">grayscale_image_3c</a>(crop);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="keywordtype">float</span> *X = crop.<a class="code" href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">data</a>;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        time=clock();</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <a class="code" href="../../d6/d6e/network_8c.html#a40ea1072011345fcf25951b4a5d429a6">network_predict</a>(net, X);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <a class="code" href="../../de/d68/structimage.html">image</a> out = <a class="code" href="../../d6/d6e/network_8c.html#a5bb83a6363a3ed2358ce290c69be0d06">get_network_image_layer</a>(net, imlayer);</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        <span class="comment">//yuv_to_rgb(out);</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#ae8ec59e2e5d3166e688d80a0e2869e80">constrain_image</a>(out);</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        printf(<span class="stringliteral">&quot;%s: Predicted in %f seconds.\n&quot;</span>, input, <a class="code" href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e">sec</a>(clock()-time));</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70">show_image</a>(out, <span class="stringliteral">&quot;out&quot;</span>);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70">show_image</a>(crop, <span class="stringliteral">&quot;crop&quot;</span>);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a0c7a63330d7929a012da0a95694eb363">save_image</a>(out, <span class="stringliteral">&quot;out&quot;</span>);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="preprocessor">#ifdef OPENCV</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        cvWaitKey(0);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(im);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(resized);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <a class="code" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a>(crop);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="keywordflow">if</span> (filename) <span class="keywordflow">break</span>;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;}</div><div class="ttc" id="image_8c_html_a0fe6118be83ce80a0c5a912219000293"><div class="ttname"><a href="../../d3/d10/image_8c.html#a0fe6118be83ce80a0c5a912219000293">resize_min</a></div><div class="ttdeci">image resize_min(image im, int min)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00881">image.c:881</a></div></div>
<div class="ttc" id="image_8c_html_ae8ec59e2e5d3166e688d80a0e2869e80"><div class="ttname"><a href="../../d3/d10/image_8c.html#ae8ec59e2e5d3166e688d80a0e2869e80">constrain_image</a></div><div class="ttdeci">void constrain_image(image im)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00340">image.c:340</a></div></div>
<div class="ttc" id="structimage_html"><div class="ttname"><a href="../../de/d68/structimage.html">image</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00022">image.h:22</a></div></div>
<div class="ttc" id="network_8c_html_a5bb83a6363a3ed2358ce290c69be0d06"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a5bb83a6363a3ed2358ce290c69be0d06">get_network_image_layer</a></div><div class="ttdeci">image get_network_image_layer(network net, int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00385">network.c:385</a></div></div>
<div class="ttc" id="network_8c_html_a40ea1072011345fcf25951b4a5d429a6"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a40ea1072011345fcf25951b4a5d429a6">network_predict</a></div><div class="ttdeci">float * network_predict(network net, float *input)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00429">network.c:429</a></div></div>
<div class="ttc" id="structlayer_html_a298d150dabc449824204579f4851b926"><div class="ttname"><a href="../../d4/db8/structlayer.html#a298d150dabc449824204579f4851b926">layer::out_c</a></div><div class="ttdeci">int out_c</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00067">layer.h:67</a></div></div>
<div class="ttc" id="structimage_html_a30e2caee481a59608823b3bcec8a139f"><div class="ttname"><a href="../../de/d68/structimage.html#a30e2caee481a59608823b3bcec8a139f">image::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00023">image.h:23</a></div></div>
<div class="ttc" id="structnetwork_html"><div class="ttname"><a href="../../de/d45/structnetwork.html">network</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00014">network.h:14</a></div></div>
<div class="ttc" id="structnetwork_html_a9770423f88b722bafc9d1fd3c6091d75"><div class="ttname"><a href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">network::layers</a></div><div class="ttdeci">layer * layers</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00022">network.h:22</a></div></div>
<div class="ttc" id="utils_8c_html_a375f4de29b8973c3e1b63bf49a5eb00e"><div class="ttname"><a href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e">sec</a></div><div class="ttdeci">float sec(clock_t clocks)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00192">utils.c:192</a></div></div>
<div class="ttc" id="image_8c_html_a1b35e408b961d58f7e29ec146be91160"><div class="ttname"><a href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160">free_image</a></div><div class="ttdeci">void free_image(image m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l01523">image.c:1523</a></div></div>
<div class="ttc" id="structimage_html_aa6480e4024a0d5ca8d36b4145b3ceb43"><div class="ttname"><a href="../../de/d68/structimage.html#aa6480e4024a0d5ca8d36b4145b3ceb43">image::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00024">image.h:24</a></div></div>
<div class="ttc" id="image_8c_html_a233b57091bac94f82d8aa0d8a5c1f070"><div class="ttname"><a href="../../d3/d10/image_8c.html#a233b57091bac94f82d8aa0d8a5c1f070">load_image_color</a></div><div class="ttdeci">image load_image_color(char *filename, int w, int h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l01368">image.c:1368</a></div></div>
<div class="ttc" id="parser_8c_html_abb6f2aa1c5d5bf340faae09be6538c56"><div class="ttname"><a href="../../d2/d72/parser_8c.html#abb6f2aa1c5d5bf340faae09be6538c56">parse_network_cfg</a></div><div class="ttdeci">network parse_network_cfg(char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d72/parser_8c_source.html#l00618">parser.c:618</a></div></div>
<div class="ttc" id="network_8c_html_a0cf39a1104b8f0415c56796b54a3670a"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a0cf39a1104b8f0415c56796b54a3670a">set_batch_network</a></div><div class="ttdeci">void set_batch_network(network *net, int b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00285">network.c:285</a></div></div>
<div class="ttc" id="image_8c_html_a0c7a63330d7929a012da0a95694eb363"><div class="ttname"><a href="../../d3/d10/image_8c.html#a0c7a63330d7929a012da0a95694eb363">save_image</a></div><div class="ttdeci">void save_image(image im, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00597">image.c:597</a></div></div>
<div class="ttc" id="image_8c_html_a5807da5b9392f853749db3e7c727bd70"><div class="ttname"><a href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70">show_image</a></div><div class="ttdeci">void show_image(image p, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00459">image.c:459</a></div></div>
<div class="ttc" id="structnetwork_html_a0e57f4230f8ecb07bba0c97cf8f045c7"><div class="ttname"><a href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">network::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00047">network.h:47</a></div></div>
<div class="ttc" id="structnetwork_html_a1c7625720955322d05924a075d013877"><div class="ttname"><a href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">network::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00015">network.h:15</a></div></div>
<div class="ttc" id="image_8c_html_a3118a7b2d46587811e9d538cbec7d314"><div class="ttname"><a href="../../d3/d10/image_8c.html#a3118a7b2d46587811e9d538cbec7d314">grayscale_image_3c</a></div><div class="ttdeci">void grayscale_image_3c(image im)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l01061">image.c:1061</a></div></div>
<div class="ttc" id="image_8c_html_ad323458860dbdb7a2af97b9b35ad91bf"><div class="ttname"><a href="../../d3/d10/image_8c.html#ad323458860dbdb7a2af97b9b35ad91bf">crop_image</a></div><div class="ttdeci">image crop_image(image im, int dx, int dy, int w, int h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00741">image.c:741</a></div></div>
<div class="ttc" id="structnetwork_html_a944b83cb20da2454c6092e07b9a1d3e9"><div class="ttname"><a href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">network::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00047">network.h:47</a></div></div>
<div class="ttc" id="parser_8c_html_a60957f4d236ea8e417999b1778ec3d55"><div class="ttname"><a href="../../d2/d72/parser_8c.html#a60957f4d236ea8e417999b1778ec3d55">load_weights</a></div><div class="ttdeci">void load_weights(network *net, char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d72/parser_8c_source.html#l01127">parser.c:1127</a></div></div>
<div class="ttc" id="structimage_html_aed7e0704080213b735419d6661251a0a"><div class="ttname"><a href="../../de/d68/structimage.html#aed7e0704080213b735419d6661251a0a">image::data</a></div><div class="ttdeci">float * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00026">image.h:26</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/lsd_8c_abcf2acb0200df9fc8e4d96d998658bdd_cgraph.png" border="0" usemap="#d2/da6/lsd_8c_abcf2acb0200df9fc8e4d96d998658bdd_cgraph" alt=""/></div>
<map name="d2/da6/lsd_8c_abcf2acb0200df9fc8e4d96d998658bdd_cgraph" id="d2/da6/lsd_8c_abcf2acb0200df9fc8e4d96d998658bdd_cgraph">
<area shape="rect" id="node2" href="../../d3/d10/image_8c.html#ae8ec59e2e5d3166e688d80a0e2869e80" title="constrain_image" alt="" coords="360,5,480,31"/>
<area shape="rect" id="node3" href="../../d3/d10/image_8c.html#ad323458860dbdb7a2af97b9b35ad91bf" title="crop_image" alt="" coords="162,255,253,280"/>
<area shape="rect" id="node8" href="../../d3/d10/image_8c.html#a1b35e408b961d58f7e29ec146be91160" title="free_image" alt="" coords="545,355,633,380"/>
<area shape="rect" id="node9" href="../../d6/d6e/network_8c.html#a5bb83a6363a3ed2358ce290c69be0d06" title="get_network_image_layer" alt="" coords="121,455,295,480"/>
<area shape="rect" id="node11" href="../../d3/d10/image_8c.html#a3118a7b2d46587811e9d538cbec7d314" title="grayscale_image_3c" alt="" coords="136,205,279,231"/>
<area shape="rect" id="node12" href="../../d3/d10/image_8c.html#a233b57091bac94f82d8aa0d8a5c1f070" title="load_image_color" alt="" coords="144,405,271,431"/>
<area shape="rect" id="node14" href="../../d2/d72/parser_8c.html#a60957f4d236ea8e417999b1778ec3d55" title="load_weights" alt="" coords="158,504,257,529"/>
<area shape="rect" id="node16" href="../../d6/d6e/network_8c.html#a40ea1072011345fcf25951b4a5d429a6" title="network_predict" alt="" coords="150,553,265,579"/>
<area shape="rect" id="node18" href="../../d2/d72/parser_8c.html#abb6f2aa1c5d5bf340faae09be6538c56" title="parse_network_cfg" alt="" coords="141,1145,275,1171"/>
<area shape="rect" id="node46" href="../../d3/d10/image_8c.html#a0fe6118be83ce80a0c5a912219000293" title="resize_min" alt="" coords="165,1195,251,1220"/>
<area shape="rect" id="node47" href="../../d3/d10/image_8c.html#a0c7a63330d7929a012da0a95694eb363" title="save_image" alt="" coords="373,55,467,80"/>
<area shape="rect" id="node48" href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e" title="sec" alt="" coords="187,1244,229,1269"/>
<area shape="rect" id="node49" href="../../d6/d6e/network_8c.html#a0cf39a1104b8f0415c56796b54a3670a" title="set_batch_network" alt="" coords="141,1293,274,1319"/>
<area shape="rect" id="node50" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70" title="show_image" alt="" coords="160,149,256,175"/>
<area shape="rect" id="node4" href="../../d3/d91/utils_8c.html#a5402a85f04198ed74b0ac1172b673a14" title="constrain_int" alt="" coords="372,304,468,329"/>
<area shape="rect" id="node5" href="../../d3/d10/image_8c.html#ab2ddb4ea0bc935f26ce71a731a3241d9" title="get_pixel" alt="" coords="383,205,457,231"/>
<area shape="rect" id="node6" href="../../d3/d10/image_8c.html#a726c30d7f0779c46f9ba5b8a3c2f94a1" title="make_image" alt="" coords="371,156,469,181"/>
<area shape="rect" id="node7" href="../../d3/d10/image_8c.html#a566c2d016eb920d2fee7d3bb055a720b" title="set_pixel" alt="" coords="383,255,457,280"/>
<area shape="rect" id="node10" href="../../d3/d10/image_8c.html#a30912fff1b55bfe3f46db0dcf74f6024" title="float_to_image" alt="" coords="366,455,474,480"/>
<area shape="rect" id="node13" href="../../d3/d10/image_8c.html#a4eec265642aa18081a3e8795c5a78afb" title="load_image" alt="" coords="375,405,465,431"/>
<area shape="rect" id="node15" href="../../d2/d72/parser_8c.html#abb17f71fa3838540cc5eff6492cce5e6" title="load_weights_upto" alt="" coords="354,504,486,529"/>
<area shape="rect" id="node17" href="../../d6/d6e/network_8c.html#affc7ba2c94d58f52043a19d4c8151daa" title="forward_network" alt="" coords="360,553,480,579"/>
<area shape="rect" id="node19" href="../../d2/d72/parser_8c.html#a3275ec64d90febff7c0b69c9c5253893" title="read_cfg" alt="" coords="383,1047,457,1072"/>
<area shape="rect" id="node20" href="../../d3/d91/utils_8c.html#a6c317cffefb9737fb2260da73688f275" title="error" alt="" coords="565,1319,614,1344"/>
<area shape="rect" id="node21" href="../../d6/d6e/network_8c.html#ad2dcde69603d71857d11484ae99bd8fe" title="make_network" alt="" coords="366,1592,474,1617"/>
<area shape="rect" id="node22" href="../../d2/d72/parser_8c.html#ad1828ac8171ebfd2b0810efb68a892d8" title="is_network" alt="" coords="377,1641,463,1667"/>
<area shape="rect" id="node23" href="../../d2/d72/parser_8c.html#a21c6f7046fcd48a8cfd74c23fcf944ca" title="parse_net_options" alt="" coords="354,1493,486,1519"/>
<area shape="rect" id="node24" href="../../d2/d72/parser_8c.html#a97c3da45ea6b7b689493efb262b35de8" title="free_section" alt="" coords="373,1691,467,1716"/>
<area shape="rect" id="node25" href="../../d2/d72/parser_8c.html#a990806ef35cd5caa481e2c9bb93442a9" title="string_to_layer_type" alt="" coords="349,1740,491,1765"/>
<area shape="rect" id="node26" href="../../d2/d72/parser_8c.html#a471db4c53b8d77ab23576fe4c6856d3f" title="parse_convolutional" alt="" coords="350,1543,490,1568"/>
<area shape="rect" id="node27" href="../../d2/d72/parser_8c.html#a7ad1750e2fb2e9403fa68f21a2c62c28" title="parse_deconvolutional" alt="" coords="343,1096,497,1121"/>
<area shape="rect" id="node28" href="../../d2/d72/parser_8c.html#ae36102ed30d5b253ec3c58df3192c771" title="parse_local" alt="" coords="375,1145,465,1171"/>
<area shape="rect" id="node29" href="../../d2/d72/parser_8c.html#aa6d3ed6372d755d53624f85c06da7dbe" title="parse_activation" alt="" coords="361,1789,479,1815"/>
<area shape="rect" id="node30" href="../../d2/d72/parser_8c.html#a5504899aea1400dbc33dba8eac459460" title="parse_rnn" alt="" coords="379,1839,461,1864"/>
<area shape="rect" id="node31" href="../../d2/d72/parser_8c.html#af8d59a4d921f3c03b0977d39feb14ced" title="parse_gru" alt="" coords="379,1888,461,1913"/>
<area shape="rect" id="node32" href="../../d2/d72/parser_8c.html#a4e1046e1d1d1030ad9f473d9b930f2a0" title="parse_crnn" alt="" coords="376,603,464,628"/>
<area shape="rect" id="node33" href="../../d2/d72/parser_8c.html#a0ac5e58f1dd180ce1ae1bddc3bb47596" title="parse_connected" alt="" coords="358,652,482,677"/>
<area shape="rect" id="node34" href="../../d2/d72/parser_8c.html#a8d1bd90ea4beb8fc3069999af7f4448f" title="parse_crop" alt="" coords="376,1195,464,1220"/>
<area shape="rect" id="node35" href="../../d2/d72/parser_8c.html#a853d2066af42522c1de3f97d0bc0ff29" title="parse_cost" alt="" coords="377,701,463,727"/>
<area shape="rect" id="node36" href="../../d2/d72/parser_8c.html#afedfffed817f89349b250c4afe09041c" title="parse_region" alt="" coords="370,751,470,776"/>
<area shape="rect" id="node37" href="../../d2/d72/parser_8c.html#ab5cfcdcccf8d8f3fa5f46d4528a70cab" title="parse_detection" alt="" coords="362,800,478,825"/>
<area shape="rect" id="node38" href="../../d2/d72/parser_8c.html#a1f908ce65d9b8a102e754f61f00882b3" title="parse_softmax" alt="" coords="366,849,474,875"/>
<area shape="rect" id="node39" href="../../d2/d72/parser_8c.html#a070f2ff614c49ca43151b17082372374" title="parse_normalization" alt="" coords="349,899,491,924"/>
<area shape="rect" id="node40" href="../../d2/d72/parser_8c.html#a912380cd9e2ee925a2e0af57cbde0511" title="parse_batchnorm" alt="" coords="357,948,483,973"/>
<area shape="rect" id="node41" href="../../d2/d72/parser_8c.html#abef6e6b93a1c7ba7aef41bf2b95e9d27" title="parse_maxpool" alt="" coords="364,1244,476,1269"/>
<area shape="rect" id="node42" href="../../d2/d72/parser_8c.html#a934cdac39f052fe5f89407b9c99e729e" title="parse_reorg" alt="" coords="373,1293,467,1319"/>
<area shape="rect" id="node43" href="../../d2/d72/parser_8c.html#ad30661bf80ffee22a45132dbcd53043d" title="parse_avgpool" alt="" coords="366,1343,474,1368"/>
<area shape="rect" id="node44" href="../../d2/d72/parser_8c.html#a6a5c32c49b1a691f4e699760b72aff57" title="parse_route" alt="" coords="374,1392,466,1417"/>
<area shape="rect" id="node45" href="../../d2/d72/parser_8c.html#ab297102c068c53158161d4b13d03a53b" title="parse_shortcut" alt="" coords="365,997,475,1023"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/lsd_8c_abcf2acb0200df9fc8e4d96d998658bdd_icgraph.png" border="0" usemap="#d2/da6/lsd_8c_abcf2acb0200df9fc8e4d96d998658bdd_icgraph" alt=""/></div>
<map name="d2/da6/lsd_8c_abcf2acb0200df9fc8e4d96d998658bdd_icgraph" id="d2/da6/lsd_8c_abcf2acb0200df9fc8e4d96d998658bdd_icgraph">
<area shape="rect" id="node2" href="../../d2/da6/lsd_8c.html#ab48437873371bf1e3ff2b7714109f178" title="run_lsd" alt="" coords="121,5,186,31"/>
<area shape="rect" id="node3" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="234,5,284,31"/>
</map>
</div>

</div>
</div>
<a id="a2ae443574ec61dc746fa85f65d6d1cf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ae443574ec61dc746fa85f65d6d1cf2">&#9670;&nbsp;</a></span>train_colorizer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void train_colorizer </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>cfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>acfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>aweight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>clear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>display</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/lsd_8c_source.html#l00623">623</a> of file <a class="el" href="../../d2/da6/lsd_8c_source.html">lsd.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d91/utils_8c_source.html#l00139">basecfg()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00016">network::batch</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00057">layer::batch</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00047">network::c</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00049">load_args::classes</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00031">CLASSIFICATION_DATA</a>, <a class="el" href="../../de/da9/data_8c_source.html#l00944">concat_data()</a>, <a class="el" href="../../dc/d50/blas_8c_source.html#l00164">copy_cpu()</a>, <a class="el" href="../../de/da9/data_8c_source.html#l01152">copy_data()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00068">network::cost</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00059">load_args::d</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00021">network::decay</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00064">network::delta</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00654">float_to_image()</a>, <a class="el" href="../../de/da9/data_8c_source.html#l00503">free_data()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00033">get_base_args()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00061">get_current_batch()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00078">get_current_rate()</a>, <a class="el" href="../../de/da9/data_8c_source.html#l01019">get_next_batch()</a>, <a class="el" href="../../de/da9/data_8c_source.html#l00012">get_paths()</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l01061">grayscale_image_3c()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00047">network::h</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00043">network::inputs</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00040">load_args::labels</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00022">network::layers</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00026">network::learning_rate</a>, <a class="el" href="../../d7/d40/list_8c_source.html#l00082">list_to_array()</a>, <a class="el" href="../../de/da9/data_8c_source.html#l00776">load_data_in_thread()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00051">load_network()</a>, <a class="el" href="../../de/da9/data_8c_source.html#l00737">load_thread()</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00039">load_args::m</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00032">network::max_batches</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00020">network::momentum</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00015">network::n</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00038">load_args::n</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00067">layer::out_c</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00163">layer::output</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00044">network::outputs</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00061">layer::outputs</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00036">load_args::paths</a>, <a class="el" href="../../d2/d72/parser_8c_source.html#l00929">save_weights()</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00192">sec()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00017">network::seen</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00459">show_image()</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00011">list::size</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00019">network::subdivisions</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00066">network::train</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00269">train_network()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00045">network::truths</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00062">load_args::type</a>, <a class="el" href="../../dd/df4/matrix_8h_source.html#l00005">matrix::vals</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00047">network::w</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00023">data::X</a>, and <a class="el" href="../../d2/dbd/data_8h_source.html#l00024">data::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/da6/lsd_8c_source.html#l01111">run_lsd()</a>.</p>
<div class="fragment"><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;{</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="preprocessor">#ifdef GPU</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">//char *train_images = &quot;/home/pjreddie/data/coco/train1.txt&quot;;</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">//char *train_images = &quot;/home/pjreddie/data/coco/trainvalno5k.txt&quot;;</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordtype">char</span> *train_images = <span class="stringliteral">&quot;/home/pjreddie/data/imagenet/imagenet1k.train.list&quot;</span>;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordtype">char</span> *backup_directory = <span class="stringliteral">&quot;/home/pjreddie/backup/&quot;</span>;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    srand(time(0));</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordtype">char</span> *base = <a class="code" href="../../d3/d91/utils_8c.html#afe996fdc7e45995e94f02d55845e163b">basecfg</a>(cfg);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordtype">char</span> *abase = <a class="code" href="../../d3/d91/utils_8c.html#afe996fdc7e45995e94f02d55845e163b">basecfg</a>(acfg);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    printf(<span class="stringliteral">&quot;%s\n&quot;</span>, base);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="../../de/d45/structnetwork.html">network</a> net = <a class="code" href="../../d6/d6e/network_8c.html#aa06b8ad6a6fb64daed0801ad5d4009a2">load_network</a>(cfg, weight, clear);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="../../de/d45/structnetwork.html">network</a> anet = <a class="code" href="../../d6/d6e/network_8c.html#aa06b8ad6a6fb64daed0801ad5d4009a2">load_network</a>(acfg, aweight, clear);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordtype">int</span> i, j, k;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="../../d4/db8/structlayer.html">layer</a> imlayer = {0};</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; net.<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a>; ++i) {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">if</span> (net.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[i].<a class="code" href="../../d4/db8/structlayer.html#a298d150dabc449824204579f4851b926">out_c</a> == 3) {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            imlayer = net.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[i];</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    printf(<span class="stringliteral">&quot;Learning Rate: %g, Momentum: %g, Decay: %g\n&quot;</span>, net.<a class="code" href="../../de/d45/structnetwork.html#a978d3e339536cd6bea2270d49d93c35a">learning_rate</a>, net.<a class="code" href="../../de/d45/structnetwork.html#a495c60ef821ca0ade1c42907c8bc90bf">momentum</a>, net.<a class="code" href="../../de/d45/structnetwork.html#a9afd53b100d35dc162e48118ef4f7eea">decay</a>);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordtype">int</span> imgs = net.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>*net.<a class="code" href="../../de/d45/structnetwork.html#ab30643da07e0f787ee0cd2058cd41a6e">subdivisions</a>;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    i = *net.<a class="code" href="../../de/d45/structnetwork.html#ad1b060aa7e1bfd54e25448f1783733d6">seen</a>/imgs;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="../../df/dea/structdata.html">data</a> train, buffer;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="code" href="../../d8/d10/structlist.html">list</a> *plist = <a class="code" href="../../de/da9/data_8c.html#a3c0e083ce3917bb394ca5708a52f34f5">get_paths</a>(train_images);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="comment">//int N = plist-&gt;size;</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordtype">char</span> **paths = (<span class="keywordtype">char</span> **)<a class="code" href="../../d7/d40/list_8c.html#a29e21d306ccd944370665f439d7ca37d">list_to_array</a>(plist);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <a class="code" href="../../d1/d09/structload__args.html">load_args</a> args= <a class="code" href="../../d6/d6e/network_8c.html#a83fdde9a3ff298cf8066a781319a6ec1">get_base_args</a>(net);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#aadcafc7eb67b2a86a1a7a6ff2ab80a94">paths</a> = paths;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#a46de5db87a3c8c05130d5b23a2cdea2f">n</a> = imgs;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#aca89fa6ea8f11383062a905539477001">m</a> = plist-&gt;<a class="code" href="../../d8/d10/structlist.html#a3b03adad0c0429bae9493667ff366dc2">size</a>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#a0b1c4f762d67a0f0cbcc1241cfa5463d">d</a> = &amp;buffer;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#a281729b932cef85bb4e2a88e1133518d">type</a> = <a class="code" href="../../d2/dbd/data_8h.html#ac2ad7f431e3446fddcd9b6b9f93c4c14a6e94b1b980ce6cf0203483eaea660b08">CLASSIFICATION_DATA</a>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#af12ce52f9bf54ea7985cb0e9b9dfaf55">classes</a> = 1;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordtype">char</span> *ls[2] = {<span class="stringliteral">&quot;imagenet&quot;</span>};</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#a66b04c5770c0b451fa14a4a87258be9d">labels</a> = ls;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    pthread_t <a class="code" href="../../de/da9/data_8c.html#ab5f0db527025988c7478eddea9d97141">load_thread</a> = <a class="code" href="../../de/da9/data_8c.html#a887edef560c1d5fe3f395f02c0a00612">load_data_in_thread</a>(args);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    clock_t time;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordtype">int</span> x_size = net.<a class="code" href="../../de/d45/structnetwork.html#a529a36505548232d049abcb84fdcf389">inputs</a>*net.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordtype">int</span> y_size = x_size;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    net.<a class="code" href="../../de/d45/structnetwork.html#a7787a7dde0eea2d91b208c23cdba6286">delta</a> = 0;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    net.<a class="code" href="../../de/d45/structnetwork.html#a32e7b55fe8dfa07391b6cdce17b4a2c1">train</a> = 1;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordtype">float</span> *pixs = calloc(x_size, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordtype">float</span> *graypixs = calloc(x_size, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordtype">float</span> *y = calloc(y_size, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordtype">int</span> ay_size = anet.<a class="code" href="../../de/d45/structnetwork.html#a5268de11127a02d86e6f517cf3b3acc9">outputs</a>*anet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    anet.<a class="code" href="../../de/d45/structnetwork.html#a7787a7dde0eea2d91b208c23cdba6286">delta</a> = 0;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    anet.<a class="code" href="../../de/d45/structnetwork.html#a32e7b55fe8dfa07391b6cdce17b4a2c1">train</a> = 1;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordtype">float</span> *imerror = cuda_make_array(0, imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*imlayer.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordtype">float</span> aloss_avg = -1;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordtype">float</span> gloss_avg = -1;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">//data generated = copy_data(train);</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../d6/d6e/network_8c.html#a95734b6e69a080abf33395707ab56b59">get_current_batch</a>(net) &lt; net.<a class="code" href="../../de/d45/structnetwork.html#a163b931990a5ac8f456884405de2192b">max_batches</a>) {</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        i += 1;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        time=clock();</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        pthread_join(load_thread, 0);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        train = buffer;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        load_thread = <a class="code" href="../../de/da9/data_8c.html#a887edef560c1d5fe3f395f02c0a00612">load_data_in_thread</a>(args);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        printf(<span class="stringliteral">&quot;Loaded: %lf seconds\n&quot;</span>, <a class="code" href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e">sec</a>(clock()-time));</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <a class="code" href="../../df/dea/structdata.html">data</a> gray = <a class="code" href="../../de/da9/data_8c.html#aa1204f7048d4034131fcb700809087e4">copy_data</a>(train);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="keywordflow">for</span>(j = 0; j &lt; imgs; ++j){</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <a class="code" href="../../de/d68/structimage.html">image</a> gim = <a class="code" href="../../d3/d10/image_8c.html#a30912fff1b55bfe3f46db0dcf74f6024">float_to_image</a>(net.<a class="code" href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">w</a>, net.<a class="code" href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">h</a>, net.<a class="code" href="../../de/d45/structnetwork.html#a05014921b926874b8a362aa83d98283a">c</a>, gray.<a class="code" href="../../df/dea/structdata.html#a1f37ae26b26b12ef5c70a12957826e87">X</a>.<a class="code" href="../../dd/d7b/structmatrix.html#ac06cdc346e87ea5cb4e4ae1a9b91d61f">vals</a>[j]);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <a class="code" href="../../d3/d10/image_8c.html#a3118a7b2d46587811e9d538cbec7d314">grayscale_image_3c</a>(gim);</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            train.<a class="code" href="../../df/dea/structdata.html#a30946bde3a05e40df6fbb49c5dd9b627">y</a>.<a class="code" href="../../dd/d7b/structmatrix.html#ac06cdc346e87ea5cb4e4ae1a9b91d61f">vals</a>[j][0] = .95;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            gray.<a class="code" href="../../df/dea/structdata.html#a30946bde3a05e40df6fbb49c5dd9b627">y</a>.<a class="code" href="../../dd/d7b/structmatrix.html#ac06cdc346e87ea5cb4e4ae1a9b91d61f">vals</a>[j][0] = .05;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        time=clock();</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="keywordtype">float</span> gloss = 0;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">for</span>(j = 0; j &lt; net.<a class="code" href="../../de/d45/structnetwork.html#ab30643da07e0f787ee0cd2058cd41a6e">subdivisions</a>; ++j){</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <a class="code" href="../../de/da9/data_8c.html#a338d58d41be3703ef4ce443e5bb4e52f">get_next_batch</a>(train, net.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>, j*net.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>, pixs, 0);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <a class="code" href="../../de/da9/data_8c.html#a338d58d41be3703ef4ce443e5bb4e52f">get_next_batch</a>(gray, net.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>, j*net.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>, graypixs, 0);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            cuda_push_array(net.input_gpu, graypixs, net.<a class="code" href="../../de/d45/structnetwork.html#a529a36505548232d049abcb84fdcf389">inputs</a>*net.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            cuda_push_array(net.truth_gpu, pixs, net.<a class="code" href="../../de/d45/structnetwork.html#a794927f8c4d44cd8e85ff39e0d4c9939">truths</a>*net.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">               image origi = float_to_image(net.w, net.h, 3, pixs);</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">               image grayi = float_to_image(net.w, net.h, 3, graypixs);</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">               show_image(grayi, &quot;gray&quot;);</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">               show_image(origi, &quot;orig&quot;);</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">               cvWaitKey(0);</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            *net.<a class="code" href="../../de/d45/structnetwork.html#ad1b060aa7e1bfd54e25448f1783733d6">seen</a> += net.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            forward_network_gpu(net);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            fill_ongpu(imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*imlayer.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>, 0, imerror, 1);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            copy_ongpu(anet.<a class="code" href="../../de/d45/structnetwork.html#a529a36505548232d049abcb84fdcf389">inputs</a>*anet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>, imlayer.output_gpu, 1, anet.input_gpu, 1);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            fill_ongpu(anet.<a class="code" href="../../de/d45/structnetwork.html#a529a36505548232d049abcb84fdcf389">inputs</a>*anet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>, .95, anet.truth_gpu, 1);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            anet.delta_gpu = imerror;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            forward_network_gpu(anet);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            backward_network_gpu(anet);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            scal_ongpu(imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*imlayer.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>, 1./100., net.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[net.<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a>-1].delta_gpu, 1);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            scal_ongpu(imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*imlayer.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>, 1, imerror, 1);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            printf(<span class="stringliteral">&quot;realness %f\n&quot;</span>, cuda_mag_array(imerror, imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*imlayer.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>));</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            printf(<span class="stringliteral">&quot;features %f\n&quot;</span>, cuda_mag_array(net.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[net.<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a>-1].delta_gpu, imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*imlayer.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>));</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            axpy_ongpu(imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*imlayer.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>, 1, imerror, 1, net.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[net.<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a>-1].delta_gpu, 1);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            backward_network_gpu(net);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            gloss += *net.<a class="code" href="../../de/d45/structnetwork.html#ac80b4b4eeda5cf4cc4af5c2173d0ad31">cost</a> /(net.<a class="code" href="../../de/d45/structnetwork.html#ab30643da07e0f787ee0cd2058cd41a6e">subdivisions</a>*net.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="keywordflow">for</span>(k = 0; k &lt; net.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>; ++k){</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                <span class="keywordtype">int</span> index = j*net.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a> + k;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                <a class="code" href="../../dc/d50/blas_8c.html#a22f6b03dd54e2d4b249e53a0ca14434c">copy_cpu</a>(imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>, imlayer.<a class="code" href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">output</a> + k*imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>, 1, gray.<a class="code" href="../../df/dea/structdata.html#a1f37ae26b26b12ef5c70a12957826e87">X</a>.<a class="code" href="../../dd/d7b/structmatrix.html#ac06cdc346e87ea5cb4e4ae1a9b91d61f">vals</a>[index], 1);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            }</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        }</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        harmless_update_network_gpu(anet);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <a class="code" href="../../df/dea/structdata.html">data</a> merge = <a class="code" href="../../de/da9/data_8c.html#aa9c8a2657c930195dd492ed99a7a0bb2">concat_data</a>(train, gray);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="comment">//randomize_data(merge);</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordtype">float</span> aloss = <a class="code" href="../../d6/d6e/network_8c.html#aeb752f771f5cfe8c401fc8dee8f3e439">train_network</a>(anet, merge);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        update_network_gpu(net);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="preprocessor">            #ifdef OPENCV</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordflow">if</span>(display){</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <a class="code" href="../../de/d68/structimage.html">image</a> im = <a class="code" href="../../d3/d10/image_8c.html#a30912fff1b55bfe3f46db0dcf74f6024">float_to_image</a>(anet.<a class="code" href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">w</a>, anet.<a class="code" href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">h</a>, anet.<a class="code" href="../../de/d45/structnetwork.html#a05014921b926874b8a362aa83d98283a">c</a>, gray.<a class="code" href="../../df/dea/structdata.html#a1f37ae26b26b12ef5c70a12957826e87">X</a>.<a class="code" href="../../dd/d7b/structmatrix.html#ac06cdc346e87ea5cb4e4ae1a9b91d61f">vals</a>[0]);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <a class="code" href="../../de/d68/structimage.html">image</a> im2 = <a class="code" href="../../d3/d10/image_8c.html#a30912fff1b55bfe3f46db0dcf74f6024">float_to_image</a>(anet.<a class="code" href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">w</a>, anet.<a class="code" href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">h</a>, anet.<a class="code" href="../../de/d45/structnetwork.html#a05014921b926874b8a362aa83d98283a">c</a>, train.<a class="code" href="../../df/dea/structdata.html#a1f37ae26b26b12ef5c70a12957826e87">X</a>.<a class="code" href="../../dd/d7b/structmatrix.html#ac06cdc346e87ea5cb4e4ae1a9b91d61f">vals</a>[0]);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <a class="code" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70">show_image</a>(im, <span class="stringliteral">&quot;gen&quot;</span>);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <a class="code" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70">show_image</a>(im2, <span class="stringliteral">&quot;train&quot;</span>);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            cvWaitKey(50);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <a class="code" href="../../de/da9/data_8c.html#a4b0ce36f011ddb4b2ba58f58114d3219">free_data</a>(merge);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <a class="code" href="../../de/da9/data_8c.html#a4b0ce36f011ddb4b2ba58f58114d3219">free_data</a>(train);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <a class="code" href="../../de/da9/data_8c.html#a4b0ce36f011ddb4b2ba58f58114d3219">free_data</a>(gray);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordflow">if</span> (aloss_avg &lt; 0) aloss_avg = aloss;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        aloss_avg = aloss_avg*.9 + aloss*.1;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        gloss_avg = gloss_avg*.9 + gloss*.1;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        printf(<span class="stringliteral">&quot;%d: gen: %f, adv: %f | gen_avg: %f, adv_avg: %f, %f rate, %lf seconds, %d images\n&quot;</span>, i, gloss, aloss, gloss_avg, aloss_avg, <a class="code" href="../../d6/d6e/network_8c.html#ac997daf700149608de15d93a083c33dc">get_current_rate</a>(net), <a class="code" href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e">sec</a>(clock()-time), i*imgs);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordflow">if</span>(i%1000==0){</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="keywordtype">char</span> buff[256];</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            sprintf(buff, <span class="stringliteral">&quot;%s/%s_%d.weights&quot;</span>, backup_directory, base, i);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <a class="code" href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10">save_weights</a>(net, buff);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            sprintf(buff, <span class="stringliteral">&quot;%s/%s_%d.weights&quot;</span>, backup_directory, abase, i);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <a class="code" href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10">save_weights</a>(anet, buff);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keywordflow">if</span>(i%100==0){</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <span class="keywordtype">char</span> buff[256];</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            sprintf(buff, <span class="stringliteral">&quot;%s/%s.backup&quot;</span>, backup_directory, base);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <a class="code" href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10">save_weights</a>(net, buff);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            sprintf(buff, <span class="stringliteral">&quot;%s/%s.backup&quot;</span>, backup_directory, abase);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <a class="code" href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10">save_weights</a>(anet, buff);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    }</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">char</span> buff[256];</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    sprintf(buff, <span class="stringliteral">&quot;%s/%s_final.weights&quot;</span>, backup_directory, base);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <a class="code" href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10">save_weights</a>(net, buff);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;}</div><div class="ttc" id="structnetwork_html_ad1b060aa7e1bfd54e25448f1783733d6"><div class="ttname"><a href="../../de/d45/structnetwork.html#ad1b060aa7e1bfd54e25448f1783733d6">network::seen</a></div><div class="ttdeci">int * seen</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00017">network.h:17</a></div></div>
<div class="ttc" id="structnetwork_html_a9afd53b100d35dc162e48118ef4f7eea"><div class="ttname"><a href="../../de/d45/structnetwork.html#a9afd53b100d35dc162e48118ef4f7eea">network::decay</a></div><div class="ttdeci">float decay</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00021">network.h:21</a></div></div>
<div class="ttc" id="structload__args_html_aadcafc7eb67b2a86a1a7a6ff2ab80a94"><div class="ttname"><a href="../../d1/d09/structload__args.html#aadcafc7eb67b2a86a1a7a6ff2ab80a94">load_args::paths</a></div><div class="ttdeci">char ** paths</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00036">data.h:36</a></div></div>
<div class="ttc" id="structnetwork_html_a04f448f3f8c3f1314e2b23b429bec827"><div class="ttname"><a href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">network::batch</a></div><div class="ttdeci">int batch</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00016">network.h:16</a></div></div>
<div class="ttc" id="list_8c_html_a29e21d306ccd944370665f439d7ca37d"><div class="ttname"><a href="../../d7/d40/list_8c.html#a29e21d306ccd944370665f439d7ca37d">list_to_array</a></div><div class="ttdeci">void ** list_to_array(list *l)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/list_8c_source.html#l00082">list.c:82</a></div></div>
<div class="ttc" id="structnetwork_html_a978d3e339536cd6bea2270d49d93c35a"><div class="ttname"><a href="../../de/d45/structnetwork.html#a978d3e339536cd6bea2270d49d93c35a">network::learning_rate</a></div><div class="ttdeci">float learning_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00026">network.h:26</a></div></div>
<div class="ttc" id="structnetwork_html_a495c60ef821ca0ade1c42907c8bc90bf"><div class="ttname"><a href="../../de/d45/structnetwork.html#a495c60ef821ca0ade1c42907c8bc90bf">network::momentum</a></div><div class="ttdeci">float momentum</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00020">network.h:20</a></div></div>
<div class="ttc" id="structlist_html_a3b03adad0c0429bae9493667ff366dc2"><div class="ttname"><a href="../../d8/d10/structlist.html#a3b03adad0c0429bae9493667ff366dc2">list::size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d23/list_8h_source.html#l00011">list.h:11</a></div></div>
<div class="ttc" id="data_8c_html_a338d58d41be3703ef4ce443e5bb4e52f"><div class="ttname"><a href="../../de/da9/data_8c.html#a338d58d41be3703ef4ce443e5bb4e52f">get_next_batch</a></div><div class="ttdeci">void get_next_batch(data d, int n, int offset, float *X, float *y)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l01019">data.c:1019</a></div></div>
<div class="ttc" id="structimage_html"><div class="ttname"><a href="../../de/d68/structimage.html">image</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00022">image.h:22</a></div></div>
<div class="ttc" id="structload__args_html_a281729b932cef85bb4e2a88e1133518d"><div class="ttname"><a href="../../d1/d09/structload__args.html#a281729b932cef85bb4e2a88e1133518d">load_args::type</a></div><div class="ttdeci">data_type type</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00062">data.h:62</a></div></div>
<div class="ttc" id="structnetwork_html_a7787a7dde0eea2d91b208c23cdba6286"><div class="ttname"><a href="../../de/d45/structnetwork.html#a7787a7dde0eea2d91b208c23cdba6286">network::delta</a></div><div class="ttdeci">float * delta</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00064">network.h:64</a></div></div>
<div class="ttc" id="data_8h_html_ac2ad7f431e3446fddcd9b6b9f93c4c14a6e94b1b980ce6cf0203483eaea660b08"><div class="ttname"><a href="../../d2/dbd/data_8h.html#ac2ad7f431e3446fddcd9b6b9f93c4c14a6e94b1b980ce6cf0203483eaea660b08">CLASSIFICATION_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00031">data.h:31</a></div></div>
<div class="ttc" id="data_8c_html_aa9c8a2657c930195dd492ed99a7a0bb2"><div class="ttname"><a href="../../de/da9/data_8c.html#aa9c8a2657c930195dd492ed99a7a0bb2">concat_data</a></div><div class="ttdeci">data concat_data(data d1, data d2)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l00944">data.c:944</a></div></div>
<div class="ttc" id="structlayer_html_a298d150dabc449824204579f4851b926"><div class="ttname"><a href="../../d4/db8/structlayer.html#a298d150dabc449824204579f4851b926">layer::out_c</a></div><div class="ttdeci">int out_c</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00067">layer.h:67</a></div></div>
<div class="ttc" id="utils_8c_html_afe996fdc7e45995e94f02d55845e163b"><div class="ttname"><a href="../../d3/d91/utils_8c.html#afe996fdc7e45995e94f02d55845e163b">basecfg</a></div><div class="ttdeci">char * basecfg(char *cfgfile)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00139">utils.c:139</a></div></div>
<div class="ttc" id="structnetwork_html_a163b931990a5ac8f456884405de2192b"><div class="ttname"><a href="../../de/d45/structnetwork.html#a163b931990a5ac8f456884405de2192b">network::max_batches</a></div><div class="ttdeci">int max_batches</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00032">network.h:32</a></div></div>
<div class="ttc" id="structnetwork_html"><div class="ttname"><a href="../../de/d45/structnetwork.html">network</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00014">network.h:14</a></div></div>
<div class="ttc" id="structload__args_html_aca89fa6ea8f11383062a905539477001"><div class="ttname"><a href="../../d1/d09/structload__args.html#aca89fa6ea8f11383062a905539477001">load_args::m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00039">data.h:39</a></div></div>
<div class="ttc" id="structnetwork_html_a9770423f88b722bafc9d1fd3c6091d75"><div class="ttname"><a href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">network::layers</a></div><div class="ttdeci">layer * layers</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00022">network.h:22</a></div></div>
<div class="ttc" id="structnetwork_html_a32e7b55fe8dfa07391b6cdce17b4a2c1"><div class="ttname"><a href="../../de/d45/structnetwork.html#a32e7b55fe8dfa07391b6cdce17b4a2c1">network::train</a></div><div class="ttdeci">int train</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00066">network.h:66</a></div></div>
<div class="ttc" id="structload__args_html_a0b1c4f762d67a0f0cbcc1241cfa5463d"><div class="ttname"><a href="../../d1/d09/structload__args.html#a0b1c4f762d67a0f0cbcc1241cfa5463d">load_args::d</a></div><div class="ttdeci">data * d</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00059">data.h:59</a></div></div>
<div class="ttc" id="structnetwork_html_ac80b4b4eeda5cf4cc4af5c2173d0ad31"><div class="ttname"><a href="../../de/d45/structnetwork.html#ac80b4b4eeda5cf4cc4af5c2173d0ad31">network::cost</a></div><div class="ttdeci">float * cost</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00068">network.h:68</a></div></div>
<div class="ttc" id="structnetwork_html_ab30643da07e0f787ee0cd2058cd41a6e"><div class="ttname"><a href="../../de/d45/structnetwork.html#ab30643da07e0f787ee0cd2058cd41a6e">network::subdivisions</a></div><div class="ttdeci">int subdivisions</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00019">network.h:19</a></div></div>
<div class="ttc" id="utils_8c_html_a375f4de29b8973c3e1b63bf49a5eb00e"><div class="ttname"><a href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e">sec</a></div><div class="ttdeci">float sec(clock_t clocks)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00192">utils.c:192</a></div></div>
<div class="ttc" id="data_8c_html_a3c0e083ce3917bb394ca5708a52f34f5"><div class="ttname"><a href="../../de/da9/data_8c.html#a3c0e083ce3917bb394ca5708a52f34f5">get_paths</a></div><div class="ttdeci">list * get_paths(char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l00012">data.c:12</a></div></div>
<div class="ttc" id="structload__args_html_af12ce52f9bf54ea7985cb0e9b9dfaf55"><div class="ttname"><a href="../../d1/d09/structload__args.html#af12ce52f9bf54ea7985cb0e9b9dfaf55">load_args::classes</a></div><div class="ttdeci">int classes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00049">data.h:49</a></div></div>
<div class="ttc" id="structlayer_html_aff6bd99e74d13cccca4c492dd3e8de9c"><div class="ttname"><a href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">layer::batch</a></div><div class="ttdeci">int batch</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00057">layer.h:57</a></div></div>
<div class="ttc" id="network_8c_html_ac997daf700149608de15d93a083c33dc"><div class="ttname"><a href="../../d6/d6e/network_8c.html#ac997daf700149608de15d93a083c33dc">get_current_rate</a></div><div class="ttdeci">float get_current_rate(network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00078">network.c:78</a></div></div>
<div class="ttc" id="structlayer_html_a04d23c71428242b3153eda588f844eb3"><div class="ttname"><a href="../../d4/db8/structlayer.html#a04d23c71428242b3153eda588f844eb3">layer::output</a></div><div class="ttdeci">float * output</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00163">layer.h:163</a></div></div>
<div class="ttc" id="data_8c_html_aa1204f7048d4034131fcb700809087e4"><div class="ttname"><a href="../../de/da9/data_8c.html#aa1204f7048d4034131fcb700809087e4">copy_data</a></div><div class="ttdeci">data copy_data(data d)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l01152">data.c:1152</a></div></div>
<div class="ttc" id="network_8c_html_a95734b6e69a080abf33395707ab56b59"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a95734b6e69a080abf33395707ab56b59">get_current_batch</a></div><div class="ttdeci">int get_current_batch(network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00061">network.c:61</a></div></div>
<div class="ttc" id="structload__args_html_a46de5db87a3c8c05130d5b23a2cdea2f"><div class="ttname"><a href="../../d1/d09/structload__args.html#a46de5db87a3c8c05130d5b23a2cdea2f">load_args::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00038">data.h:38</a></div></div>
<div class="ttc" id="data_8c_html_ab5f0db527025988c7478eddea9d97141"><div class="ttname"><a href="../../de/da9/data_8c.html#ab5f0db527025988c7478eddea9d97141">load_thread</a></div><div class="ttdeci">void * load_thread(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l00737">data.c:737</a></div></div>
<div class="ttc" id="structnetwork_html_a794927f8c4d44cd8e85ff39e0d4c9939"><div class="ttname"><a href="../../de/d45/structnetwork.html#a794927f8c4d44cd8e85ff39e0d4c9939">network::truths</a></div><div class="ttdeci">int truths</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00045">network.h:45</a></div></div>
<div class="ttc" id="image_8c_html_a30912fff1b55bfe3f46db0dcf74f6024"><div class="ttname"><a href="../../d3/d10/image_8c.html#a30912fff1b55bfe3f46db0dcf74f6024">float_to_image</a></div><div class="ttdeci">image float_to_image(int w, int h, int c, float *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00654">image.c:654</a></div></div>
<div class="ttc" id="structlist_html"><div class="ttname"><a href="../../d8/d10/structlist.html">list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d23/list_8h_source.html#l00010">list.h:10</a></div></div>
<div class="ttc" id="network_8c_html_a83fdde9a3ff298cf8066a781319a6ec1"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a83fdde9a3ff298cf8066a781319a6ec1">get_base_args</a></div><div class="ttdeci">load_args get_base_args(network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00033">network.c:33</a></div></div>
<div class="ttc" id="structload__args_html_a66b04c5770c0b451fa14a4a87258be9d"><div class="ttname"><a href="../../d1/d09/structload__args.html#a66b04c5770c0b451fa14a4a87258be9d">load_args::labels</a></div><div class="ttdeci">char ** labels</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00040">data.h:40</a></div></div>
<div class="ttc" id="structdata_html_a1f37ae26b26b12ef5c70a12957826e87"><div class="ttname"><a href="../../df/dea/structdata.html#a1f37ae26b26b12ef5c70a12957826e87">data::X</a></div><div class="ttdeci">matrix X</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00023">data.h:23</a></div></div>
<div class="ttc" id="image_8c_html_a5807da5b9392f853749db3e7c727bd70"><div class="ttname"><a href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70">show_image</a></div><div class="ttdeci">void show_image(image p, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00459">image.c:459</a></div></div>
<div class="ttc" id="parser_8c_html_a4efdf053d8e310ad956ce80519201a10"><div class="ttname"><a href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10">save_weights</a></div><div class="ttdeci">void save_weights(network net, char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d72/parser_8c_source.html#l00929">parser.c:929</a></div></div>
<div class="ttc" id="data_8c_html_a887edef560c1d5fe3f395f02c0a00612"><div class="ttname"><a href="../../de/da9/data_8c.html#a887edef560c1d5fe3f395f02c0a00612">load_data_in_thread</a></div><div class="ttdeci">pthread_t load_data_in_thread(load_args args)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l00776">data.c:776</a></div></div>
<div class="ttc" id="structnetwork_html_a05014921b926874b8a362aa83d98283a"><div class="ttname"><a href="../../de/d45/structnetwork.html#a05014921b926874b8a362aa83d98283a">network::c</a></div><div class="ttdeci">int c</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00047">network.h:47</a></div></div>
<div class="ttc" id="network_8c_html_aa06b8ad6a6fb64daed0801ad5d4009a2"><div class="ttname"><a href="../../d6/d6e/network_8c.html#aa06b8ad6a6fb64daed0801ad5d4009a2">load_network</a></div><div class="ttdeci">network load_network(char *cfg, char *weights, int clear)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00051">network.c:51</a></div></div>
<div class="ttc" id="structnetwork_html_a5268de11127a02d86e6f517cf3b3acc9"><div class="ttname"><a href="../../de/d45/structnetwork.html#a5268de11127a02d86e6f517cf3b3acc9">network::outputs</a></div><div class="ttdeci">int outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00044">network.h:44</a></div></div>
<div class="ttc" id="structmatrix_html_ac06cdc346e87ea5cb4e4ae1a9b91d61f"><div class="ttname"><a href="../../dd/d7b/structmatrix.html#ac06cdc346e87ea5cb4e4ae1a9b91d61f">matrix::vals</a></div><div class="ttdeci">float ** vals</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df4/matrix_8h_source.html#l00005">matrix.h:5</a></div></div>
<div class="ttc" id="blas_8c_html_a22f6b03dd54e2d4b249e53a0ca14434c"><div class="ttname"><a href="../../dc/d50/blas_8c.html#a22f6b03dd54e2d4b249e53a0ca14434c">copy_cpu</a></div><div class="ttdeci">void copy_cpu(int N, float *X, int INCX, float *Y, int INCY)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/blas_8c_source.html#l00164">blas.c:164</a></div></div>
<div class="ttc" id="structnetwork_html_a0e57f4230f8ecb07bba0c97cf8f045c7"><div class="ttname"><a href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">network::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00047">network.h:47</a></div></div>
<div class="ttc" id="structload__args_html"><div class="ttname"><a href="../../d1/d09/structload__args.html">load_args</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00034">data.h:34</a></div></div>
<div class="ttc" id="structnetwork_html_a1c7625720955322d05924a075d013877"><div class="ttname"><a href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">network::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00015">network.h:15</a></div></div>
<div class="ttc" id="image_8c_html_a3118a7b2d46587811e9d538cbec7d314"><div class="ttname"><a href="../../d3/d10/image_8c.html#a3118a7b2d46587811e9d538cbec7d314">grayscale_image_3c</a></div><div class="ttdeci">void grayscale_image_3c(image im)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l01061">image.c:1061</a></div></div>
<div class="ttc" id="structlayer_html_a0874fab782ae0e8f1075cc99d776478b"><div class="ttname"><a href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">layer::outputs</a></div><div class="ttdeci">int outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00061">layer.h:61</a></div></div>
<div class="ttc" id="data_8c_html_a4b0ce36f011ddb4b2ba58f58114d3219"><div class="ttname"><a href="../../de/da9/data_8c.html#a4b0ce36f011ddb4b2ba58f58114d3219">free_data</a></div><div class="ttdeci">void free_data(data d)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l00503">data.c:503</a></div></div>
<div class="ttc" id="structnetwork_html_a944b83cb20da2454c6092e07b9a1d3e9"><div class="ttname"><a href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">network::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00047">network.h:47</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="../../df/dea/structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00021">data.h:21</a></div></div>
<div class="ttc" id="network_8c_html_aeb752f771f5cfe8c401fc8dee8f3e439"><div class="ttname"><a href="../../d6/d6e/network_8c.html#aeb752f771f5cfe8c401fc8dee8f3e439">train_network</a></div><div class="ttdeci">float train_network(network net, data d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00269">network.c:269</a></div></div>
<div class="ttc" id="structnetwork_html_a529a36505548232d049abcb84fdcf389"><div class="ttname"><a href="../../de/d45/structnetwork.html#a529a36505548232d049abcb84fdcf389">network::inputs</a></div><div class="ttdeci">int inputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00043">network.h:43</a></div></div>
<div class="ttc" id="structlayer_html"><div class="ttname"><a href="../../d4/db8/structlayer.html">layer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00045">layer.h:45</a></div></div>
<div class="ttc" id="structdata_html_a30946bde3a05e40df6fbb49c5dd9b627"><div class="ttname"><a href="../../df/dea/structdata.html#a30946bde3a05e40df6fbb49c5dd9b627">data::y</a></div><div class="ttdeci">matrix y</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00024">data.h:24</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/lsd_8c_a2ae443574ec61dc746fa85f65d6d1cf2_cgraph.png" border="0" usemap="#d2/da6/lsd_8c_a2ae443574ec61dc746fa85f65d6d1cf2_cgraph" alt=""/></div>
<map name="d2/da6/lsd_8c_a2ae443574ec61dc746fa85f65d6d1cf2_cgraph" id="d2/da6/lsd_8c_a2ae443574ec61dc746fa85f65d6d1cf2_cgraph">
<area shape="rect" id="node2" href="../../d3/d91/utils_8c.html#afe996fdc7e45995e94f02d55845e163b" title="basecfg" alt="" coords="196,5,264,31"/>
<area shape="rect" id="node4" href="../../de/da9/data_8c.html#aa9c8a2657c930195dd492ed99a7a0bb2" title="concat_data" alt="" coords="183,55,277,80"/>
<area shape="rect" id="node6" href="../../dc/d50/blas_8c.html#a22f6b03dd54e2d4b249e53a0ca14434c" title="copy_cpu" alt="" coords="574,131,653,156"/>
<area shape="rect" id="node7" href="../../de/da9/data_8c.html#aa1204f7048d4034131fcb700809087e4" title="copy_data" alt="" coords="188,163,271,188"/>
<area shape="rect" id="node9" href="../../d3/d10/image_8c.html#a30912fff1b55bfe3f46db0dcf74f6024" title="float_to_image" alt="" coords="175,224,284,249"/>
<area shape="rect" id="node11" href="../../de/da9/data_8c.html#a4b0ce36f011ddb4b2ba58f58114d3219" title="free_data" alt="" coords="191,931,269,956"/>
<area shape="rect" id="node13" href="../../d6/d6e/network_8c.html#a83fdde9a3ff298cf8066a781319a6ec1" title="get_base_args" alt="" coords="175,980,285,1005"/>
<area shape="rect" id="node14" href="../../d6/d6e/network_8c.html#a95734b6e69a080abf33395707ab56b59" title="get_current_batch" alt="" coords="356,833,484,859"/>
<area shape="rect" id="node15" href="../../d6/d6e/network_8c.html#ac997daf700149608de15d93a083c33dc" title="get_current_rate" alt="" coords="170,780,289,805"/>
<area shape="rect" id="node17" href="../../de/da9/data_8c.html#a338d58d41be3703ef4ce443e5bb4e52f" title="get_next_batch" alt="" coords="364,1032,476,1057"/>
<area shape="rect" id="node18" href="../../de/da9/data_8c.html#a3c0e083ce3917bb394ca5708a52f34f5" title="get_paths" alt="" coords="190,1180,270,1205"/>
<area shape="rect" id="node23" href="../../d3/d10/image_8c.html#a3118a7b2d46587811e9d538cbec7d314" title="grayscale_image_3c" alt="" coords="736,356,880,381"/>
<area shape="rect" id="node25" href="../../d7/d40/list_8c.html#a29e21d306ccd944370665f439d7ca37d" title="list_to_array" alt="" coords="183,1229,277,1255"/>
<area shape="rect" id="node26" href="../../de/da9/data_8c.html#a887edef560c1d5fe3f395f02c0a00612" title="load_data_in_thread" alt="" coords="158,731,301,756"/>
<area shape="rect" id="node28" href="../../de/da9/data_8c.html#ab5f0db527025988c7478eddea9d97141" title="load_thread" alt="" coords="374,681,466,707"/>
<area shape="rect" id="node42" href="../../d6/d6e/network_8c.html#aa06b8ad6a6fb64daed0801ad5d4009a2" title="load_network" alt="" coords="180,881,280,907"/>
<area shape="rect" id="node45" href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10" title="save_weights" alt="" coords="179,1131,281,1156"/>
<area shape="rect" id="node47" href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e" title="sec" alt="" coords="209,1279,251,1304"/>
<area shape="rect" id="node48" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70" title="show_image" alt="" coords="182,299,278,324"/>
<area shape="rect" id="node50" href="../../d6/d6e/network_8c.html#aeb752f771f5cfe8c401fc8dee8f3e439" title="train_network" alt="" coords="179,1081,281,1107"/>
<area shape="rect" id="node3" href="../../d3/d91/utils_8c.html#a4d27da4f6ddad5146c9190badd121a39" title="copy_string" alt="" coords="375,5,465,31"/>
<area shape="rect" id="node5" href="../../de/da9/data_8c.html#a3aa1345254255bef02986f36729547ce" title="concat_matrix" alt="" coords="368,55,472,80"/>
<area shape="rect" id="node8" href="../../dc/dca/matrix_8c.html#a740942b240172fa3517b229f2e471bd2" title="copy_matrix" alt="" coords="373,156,467,181"/>
<area shape="rect" id="node10" href="../../d3/d10/image_8c.html#a28bb9f835989b2f7e908386421c52837" title="make_empty_image" alt="" coords="349,205,491,231"/>
<area shape="rect" id="node12" href="../../dc/dca/matrix_8c.html#ab8962ce6e94daf63d29a9ba6decf6e1e" title="free_matrix" alt="" coords="376,981,464,1007"/>
<area shape="rect" id="node16" href="../../d3/d91/utils_8c.html#a5492196e16ed2d16bae1df8483ef79ed" title="rand_uniform" alt="" coords="758,781,858,807"/>
<area shape="rect" id="node19" href="../../d3/d91/utils_8c.html#a153eabd234972b240608df09cc4975d3" title="fgetl" alt="" coords="397,1180,443,1205"/>
<area shape="rect" id="node20" href="../../d3/d91/utils_8c.html#aecaee51f837bcfd8316ab68164620819" title="file_error" alt="" coords="577,1229,650,1255"/>
<area shape="rect" id="node21" href="../../d7/d40/list_8c.html#a4b177e1b5244311b3b9f5276c7f39946" title="list_insert" alt="" coords="381,1229,459,1255"/>
<area shape="rect" id="node22" href="../../d7/d40/list_8c.html#a2e7ac341a0adc4e02a760a9807ba7db0" title="make_list" alt="" coords="381,1131,459,1156"/>
<area shape="rect" id="node24" href="../../d3/d10/image_8c.html#ab2ddb4ea0bc935f26ce71a731a3241d9" title="get_pixel" alt="" coords="928,356,1003,381"/>
<area shape="rect" id="node27" href="../../d3/d91/utils_8c.html#a6c317cffefb9737fb2260da73688f275" title="error" alt="" coords="589,1052,638,1077"/>
<area shape="rect" id="node29" href="../../d3/d10/image_8c.html#a24b1468a82ce3e5fe9f912bda5507d87" title="letterbox_image" alt="" coords="555,457,672,483"/>
<area shape="rect" id="node30" href="../../d3/d10/image_8c.html#a583d43a007a97bb92fcbac12b8394c72" title="resize_image" alt="" coords="758,481,858,507"/>
<area shape="rect" id="node31" href="../../de/da9/data_8c.html#a43b17bfc80111f0e9a22b5748e8db3e6" title="load_data_augment" alt="" coords="544,657,683,683"/>
<area shape="rect" id="node32" href="../../de/da9/data_8c.html#ab9d8ce6e878b53b6f7c786c1b297e695" title="load_data_compare" alt="" coords="544,556,683,581"/>
<area shape="rect" id="node33" href="../../d3/d10/image_8c.html#a233b57091bac94f82d8aa0d8a5c1f070" title="load_image_color" alt="" coords="745,657,871,683"/>
<area shape="rect" id="node34" href="../../de/da9/data_8c.html#acbd80b4bb77de421ce8f0715f6d2a80a" title="load_data_detection" alt="" coords="543,805,684,831"/>
<area shape="rect" id="node35" href="../../de/da9/data_8c.html#a2d65bb024ba143cf988a3c4b5494a90e" title="load_data_old" alt="" coords="561,855,666,880"/>
<area shape="rect" id="node36" href="../../de/da9/data_8c.html#ab7e1e67d61f872591c5123f9caf396d6" title="load_data_region" alt="" coords="551,756,676,781"/>
<area shape="rect" id="node37" href="../../de/da9/data_8c.html#a3d031c19fccc2c31ec202bbeda1615c3" title="load_data_regression" alt="" coords="539,904,688,929"/>
<area shape="rect" id="node38" href="../../de/da9/data_8c.html#a3994c72c392eae1b1c405d439de76e22" title="load_data_super" alt="" coords="553,507,674,532"/>
<area shape="rect" id="node39" href="../../de/da9/data_8c.html#a89013987873d2ee74fd382c674335fd5" title="load_data_swag" alt="" coords="554,707,673,732"/>
<area shape="rect" id="node40" href="../../de/da9/data_8c.html#a041e51bae1bacd4e84338849783e7d72" title="load_data_tag" alt="" coords="561,953,666,979"/>
<area shape="rect" id="node41" href="../../de/da9/data_8c.html#afe091cc7ae2ab63ee2a2d6e8d89202f8" title="load_data_writing" alt="" coords="551,1003,676,1028"/>
<area shape="rect" id="node43" href="../../d2/d72/parser_8c.html#abb6f2aa1c5d5bf340faae09be6538c56" title="parse_network_cfg" alt="" coords="353,883,487,908"/>
<area shape="rect" id="node44" href="../../d2/d72/parser_8c.html#a60957f4d236ea8e417999b1778ec3d55" title="load_weights" alt="" coords="370,932,470,957"/>
<area shape="rect" id="node46" href="../../d2/d72/parser_8c.html#a6ee95b0b2c847e3bb0480a5a657665a3" title="save_weights_upto" alt="" coords="352,1081,488,1107"/>
<area shape="rect" id="node49" href="../../d3/d10/image_8c.html#ae8ec59e2e5d3166e688d80a0e2869e80" title="constrain_image" alt="" coords="360,255,480,280"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/lsd_8c_a2ae443574ec61dc746fa85f65d6d1cf2_icgraph.png" border="0" usemap="#d2/da6/lsd_8c_a2ae443574ec61dc746fa85f65d6d1cf2_icgraph" alt=""/></div>
<map name="d2/da6/lsd_8c_a2ae443574ec61dc746fa85f65d6d1cf2_icgraph" id="d2/da6/lsd_8c_a2ae443574ec61dc746fa85f65d6d1cf2_icgraph">
<area shape="rect" id="node2" href="../../d2/da6/lsd_8c.html#ab48437873371bf1e3ff2b7714109f178" title="run_lsd" alt="" coords="158,5,223,31"/>
<area shape="rect" id="node3" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="271,5,322,31"/>
</map>
</div>

</div>
</div>
<a id="a13f25021852f255bb81359944d2e1a24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13f25021852f255bb81359944d2e1a24">&#9670;&nbsp;</a></span>train_dcgan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void train_dcgan </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>cfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>acfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>aweight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>clear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>display</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>train_images</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/lsd_8c_source.html#l00442">442</a> of file <a class="el" href="../../d2/da6/lsd_8c_source.html">lsd.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d91/utils_8c_source.html#l00139">basecfg()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00016">network::batch</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00057">layer::batch</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00047">network::c</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00049">load_args::classes</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00031">CLASSIFICATION_DATA</a>, <a class="el" href="../../de/da9/data_8c_source.html#l00944">concat_data()</a>, <a class="el" href="../../dc/d50/blas_8c_source.html#l00164">copy_cpu()</a>, <a class="el" href="../../de/da9/data_8c_source.html#l01152">copy_data()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00068">network::cost</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00059">load_args::d</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00021">network::decay</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00654">float_to_image()</a>, <a class="el" href="../../de/da9/data_8c_source.html#l00503">free_data()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00033">get_base_args()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00061">get_current_batch()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00078">get_current_rate()</a>, <a class="el" href="../../de/da9/data_8c_source.html#l01019">get_next_batch()</a>, <a class="el" href="../../de/da9/data_8c_source.html#l00012">get_paths()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00047">network::h</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00062">network::input</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00043">network::inputs</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00040">load_args::labels</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00022">network::layers</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00026">network::learning_rate</a>, <a class="el" href="../../d7/d40/list_8c_source.html#l00082">list_to_array()</a>, <a class="el" href="../../de/da9/data_8c_source.html#l00776">load_data_in_thread()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00051">load_network()</a>, <a class="el" href="../../de/da9/data_8c_source.html#l00737">load_thread()</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00039">load_args::m</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00032">network::max_batches</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00020">network::momentum</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00015">network::n</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00038">load_args::n</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00067">layer::out_c</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00023">network::output</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00044">network::outputs</a>, <a class="el" href="../../d3/d3b/layer_8h_source.html#l00061">layer::outputs</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00036">load_args::paths</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00576">rand_normal()</a>, <a class="el" href="../../d2/d72/parser_8c_source.html#l00929">save_weights()</a>, <a class="el" href="../../d3/d91/utils_8c_source.html#l00192">sec()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00017">network::seen</a>, <a class="el" href="../../d3/d10/image_8c_source.html#l00459">show_image()</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00011">list::size</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00019">network::subdivisions</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00035">load_args::threads</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00066">network::train</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00269">train_network()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00063">network::truth</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00045">network::truths</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00062">load_args::type</a>, <a class="el" href="../../dd/df4/matrix_8h_source.html#l00005">matrix::vals</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00047">network::w</a>, <a class="el" href="../../d2/dbd/data_8h_source.html#l00023">data::X</a>, and <a class="el" href="../../d2/dbd/data_8h_source.html#l00024">data::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/da6/lsd_8c_source.html#l01111">run_lsd()</a>.</p>
<div class="fragment"><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;{</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="preprocessor">#ifdef GPU</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">//char *train_images = &quot;/home/pjreddie/data/coco/train1.txt&quot;;</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">//char *train_images = &quot;/home/pjreddie/data/coco/trainvalno5k.txt&quot;;</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">//char *train_images = &quot;/home/pjreddie/data/imagenet/imagenet1k.train.list&quot;;</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">//char *train_images = &quot;data/64.txt&quot;;</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">//char *train_images = &quot;data/alp.txt&quot;;</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">//char *train_images = &quot;data/cifar.txt&quot;;</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordtype">char</span> *backup_directory = <span class="stringliteral">&quot;/home/pjreddie/backup/&quot;</span>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    srand(time(0));</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordtype">char</span> *base = <a class="code" href="../../d3/d91/utils_8c.html#afe996fdc7e45995e94f02d55845e163b">basecfg</a>(cfg);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordtype">char</span> *abase = <a class="code" href="../../d3/d91/utils_8c.html#afe996fdc7e45995e94f02d55845e163b">basecfg</a>(acfg);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    printf(<span class="stringliteral">&quot;%s\n&quot;</span>, base);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="../../de/d45/structnetwork.html">network</a> gnet = <a class="code" href="../../d6/d6e/network_8c.html#aa06b8ad6a6fb64daed0801ad5d4009a2">load_network</a>(cfg, weight, clear);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="../../de/d45/structnetwork.html">network</a> anet = <a class="code" href="../../d6/d6e/network_8c.html#aa06b8ad6a6fb64daed0801ad5d4009a2">load_network</a>(acfg, aweight, clear);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordtype">float</span> orig_rate = anet.<a class="code" href="../../de/d45/structnetwork.html#a978d3e339536cd6bea2270d49d93c35a">learning_rate</a>;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordtype">int</span> start = 0;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordtype">int</span> i, j, k;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="../../d4/db8/structlayer.html">layer</a> imlayer = {0};</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; gnet.<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a>; ++i) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">if</span> (gnet.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[i].<a class="code" href="../../d4/db8/structlayer.html#a298d150dabc449824204579f4851b926">out_c</a> == 3) {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            imlayer = gnet.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[i];</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    printf(<span class="stringliteral">&quot;Learning Rate: %g, Momentum: %g, Decay: %g\n&quot;</span>, gnet.<a class="code" href="../../de/d45/structnetwork.html#a978d3e339536cd6bea2270d49d93c35a">learning_rate</a>, gnet.<a class="code" href="../../de/d45/structnetwork.html#a495c60ef821ca0ade1c42907c8bc90bf">momentum</a>, gnet.<a class="code" href="../../de/d45/structnetwork.html#a9afd53b100d35dc162e48118ef4f7eea">decay</a>);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordtype">int</span> imgs = gnet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>*gnet.<a class="code" href="../../de/d45/structnetwork.html#ab30643da07e0f787ee0cd2058cd41a6e">subdivisions</a>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    i = *gnet.<a class="code" href="../../de/d45/structnetwork.html#ad1b060aa7e1bfd54e25448f1783733d6">seen</a>/imgs;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="../../df/dea/structdata.html">data</a> train, buffer;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="../../d8/d10/structlist.html">list</a> *plist = <a class="code" href="../../de/da9/data_8c.html#a3c0e083ce3917bb394ca5708a52f34f5">get_paths</a>(train_images);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">//int N = plist-&gt;size;</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordtype">char</span> **paths = (<span class="keywordtype">char</span> **)<a class="code" href="../../d7/d40/list_8c.html#a29e21d306ccd944370665f439d7ca37d">list_to_array</a>(plist);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="../../d1/d09/structload__args.html">load_args</a> args= <a class="code" href="../../d6/d6e/network_8c.html#a83fdde9a3ff298cf8066a781319a6ec1">get_base_args</a>(anet);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#aadcafc7eb67b2a86a1a7a6ff2ab80a94">paths</a> = paths;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#a46de5db87a3c8c05130d5b23a2cdea2f">n</a> = imgs;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#aca89fa6ea8f11383062a905539477001">m</a> = plist-&gt;<a class="code" href="../../d8/d10/structlist.html#a3b03adad0c0429bae9493667ff366dc2">size</a>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#a0b1c4f762d67a0f0cbcc1241cfa5463d">d</a> = &amp;buffer;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#a281729b932cef85bb4e2a88e1133518d">type</a> = <a class="code" href="../../d2/dbd/data_8h.html#ac2ad7f431e3446fddcd9b6b9f93c4c14a6e94b1b980ce6cf0203483eaea660b08">CLASSIFICATION_DATA</a>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#a3f6b3f3ef9406ab124550bc8166f2dcd">threads</a>=16;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#af12ce52f9bf54ea7985cb0e9b9dfaf55">classes</a> = 1;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordtype">char</span> *ls[2] = {<span class="stringliteral">&quot;imagenet&quot;</span>, <span class="stringliteral">&quot;zzzzzzzz&quot;</span>};</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    args.<a class="code" href="../../d1/d09/structload__args.html#a66b04c5770c0b451fa14a4a87258be9d">labels</a> = ls;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    pthread_t <a class="code" href="../../de/da9/data_8c.html#ab5f0db527025988c7478eddea9d97141">load_thread</a> = <a class="code" href="../../de/da9/data_8c.html#a887edef560c1d5fe3f395f02c0a00612">load_data_in_thread</a>(args);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    clock_t time;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    gnet.<a class="code" href="../../de/d45/structnetwork.html#a32e7b55fe8dfa07391b6cdce17b4a2c1">train</a> = 1;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    anet.<a class="code" href="../../de/d45/structnetwork.html#a32e7b55fe8dfa07391b6cdce17b4a2c1">train</a> = 1;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordtype">int</span> x_size = gnet.<a class="code" href="../../de/d45/structnetwork.html#a529a36505548232d049abcb84fdcf389">inputs</a>*gnet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordtype">int</span> y_size = gnet.<a class="code" href="../../de/d45/structnetwork.html#a794927f8c4d44cd8e85ff39e0d4c9939">truths</a>*gnet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordtype">float</span> *imerror = cuda_make_array(0, y_size);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordtype">int</span> ay_size = anet.<a class="code" href="../../de/d45/structnetwork.html#a794927f8c4d44cd8e85ff39e0d4c9939">truths</a>*anet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordtype">float</span> aloss_avg = -1;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">//data generated = copy_data(train);</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../d6/d6e/network_8c.html#a95734b6e69a080abf33395707ab56b59">get_current_batch</a>(gnet) &lt; gnet.<a class="code" href="../../de/d45/structnetwork.html#a163b931990a5ac8f456884405de2192b">max_batches</a>) {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    start += 1;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        i += 1;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        time=clock();</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        pthread_join(load_thread, 0);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        train = buffer;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="comment">//translate_data_rows(train, -.5);</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="comment">//scale_data_rows(train, 2);</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        load_thread = <a class="code" href="../../de/da9/data_8c.html#a887edef560c1d5fe3f395f02c0a00612">load_data_in_thread</a>(args);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        printf(<span class="stringliteral">&quot;Loaded: %lf seconds\n&quot;</span>, <a class="code" href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e">sec</a>(clock()-time));</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <a class="code" href="../../df/dea/structdata.html">data</a> gen = <a class="code" href="../../de/da9/data_8c.html#aa1204f7048d4034131fcb700809087e4">copy_data</a>(train);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; imgs; ++j) {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            train.<a class="code" href="../../df/dea/structdata.html#a30946bde3a05e40df6fbb49c5dd9b627">y</a>.<a class="code" href="../../dd/d7b/structmatrix.html#ac06cdc346e87ea5cb4e4ae1a9b91d61f">vals</a>[j][0] = .95;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            gen.<a class="code" href="../../df/dea/structdata.html#a30946bde3a05e40df6fbb49c5dd9b627">y</a>.<a class="code" href="../../dd/d7b/structmatrix.html#ac06cdc346e87ea5cb4e4ae1a9b91d61f">vals</a>[j][0] = .05;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        }</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        time=clock();</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">for</span>(j = 0; j &lt; gnet.<a class="code" href="../../de/d45/structnetwork.html#ab30643da07e0f787ee0cd2058cd41a6e">subdivisions</a>; ++j){</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <a class="code" href="../../de/da9/data_8c.html#a338d58d41be3703ef4ce443e5bb4e52f">get_next_batch</a>(train, gnet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>, j*gnet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>, gnet.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a>, 0);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="keywordtype">int</span> z;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <span class="keywordflow">for</span>(z = 0; z &lt; x_size; ++z){</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                gnet.<a class="code" href="../../de/d45/structnetwork.html#a8f391155a3ceb60caf07d0ee6c6a93f2">input</a>[z] = <a class="code" href="../../d3/d91/utils_8c.html#a5b5b0c77bb2f450bce70777573f7ca90">rand_normal</a>();</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            cuda_push_array(gnet.input_gpu, gnet.<a class="code" href="../../de/d45/structnetwork.html#a8f391155a3ceb60caf07d0ee6c6a93f2">input</a>, x_size);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            cuda_push_array(gnet.truth_gpu, gnet.<a class="code" href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">truth</a>, y_size);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            *gnet.<a class="code" href="../../de/d45/structnetwork.html#ad1b060aa7e1bfd54e25448f1783733d6">seen</a> += gnet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            forward_network_gpu(gnet);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            fill_ongpu(imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*imlayer.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>, 0, imerror, 1);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            fill_ongpu(anet.<a class="code" href="../../de/d45/structnetwork.html#a794927f8c4d44cd8e85ff39e0d4c9939">truths</a>*anet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>, .95, anet.truth_gpu, 1);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            copy_ongpu(anet.<a class="code" href="../../de/d45/structnetwork.html#a529a36505548232d049abcb84fdcf389">inputs</a>*anet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>, imlayer.output_gpu, 1, anet.input_gpu, 1);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            anet.delta_gpu = imerror;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            forward_network_gpu(anet);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            backward_network_gpu(anet);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <span class="keywordtype">float</span> genaloss = *anet.<a class="code" href="../../de/d45/structnetwork.html#ac80b4b4eeda5cf4cc4af5c2173d0ad31">cost</a> / anet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            printf(<span class="stringliteral">&quot;%f\n&quot;</span>, genaloss);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            scal_ongpu(imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*imlayer.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>, 1, imerror, 1);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            scal_ongpu(imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*imlayer.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>, .00, gnet.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[gnet.<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a>-1].delta_gpu, 1);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            printf(<span class="stringliteral">&quot;realness %f\n&quot;</span>, cuda_mag_array(imerror, imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*imlayer.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>));</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            printf(<span class="stringliteral">&quot;features %f\n&quot;</span>, cuda_mag_array(gnet.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[gnet.<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a>-1].delta_gpu, imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*imlayer.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>));</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            axpy_ongpu(imlayer.<a class="code" href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">outputs</a>*imlayer.<a class="code" href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">batch</a>, 1, imerror, 1, gnet.<a class="code" href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">layers</a>[gnet.<a class="code" href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">n</a>-1].delta_gpu, 1);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            backward_network_gpu(gnet);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="keywordflow">for</span>(k = 0; k &lt; gnet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a>; ++k){</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                <span class="keywordtype">int</span> index = j*gnet.<a class="code" href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">batch</a> + k;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                <a class="code" href="../../dc/d50/blas_8c.html#a22f6b03dd54e2d4b249e53a0ca14434c">copy_cpu</a>(gnet.<a class="code" href="../../de/d45/structnetwork.html#a5268de11127a02d86e6f517cf3b3acc9">outputs</a>, gnet.<a class="code" href="../../de/d45/structnetwork.html#a274dce0db2d5175992eb3b273ab09df7">output</a> + k*gnet.<a class="code" href="../../de/d45/structnetwork.html#a5268de11127a02d86e6f517cf3b3acc9">outputs</a>, 1, gen.<a class="code" href="../../df/dea/structdata.html#a1f37ae26b26b12ef5c70a12957826e87">X</a>.<a class="code" href="../../dd/d7b/structmatrix.html#ac06cdc346e87ea5cb4e4ae1a9b91d61f">vals</a>[index], 1);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        harmless_update_network_gpu(anet);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <a class="code" href="../../df/dea/structdata.html">data</a> merge = <a class="code" href="../../de/da9/data_8c.html#aa9c8a2657c930195dd492ed99a7a0bb2">concat_data</a>(train, gen);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="comment">//randomize_data(merge);</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordtype">float</span> aloss = <a class="code" href="../../d6/d6e/network_8c.html#aeb752f771f5cfe8c401fc8dee8f3e439">train_network</a>(anet, merge);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">//translate_image(im, 1);</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="comment">//scale_image(im, .5);</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="comment">//translate_image(im2, 1);</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="comment">//scale_image(im2, .5);</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="preprocessor">            #ifdef OPENCV</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">if</span>(display){</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <a class="code" href="../../de/d68/structimage.html">image</a> im = <a class="code" href="../../d3/d10/image_8c.html#a30912fff1b55bfe3f46db0dcf74f6024">float_to_image</a>(anet.<a class="code" href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">w</a>, anet.<a class="code" href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">h</a>, anet.<a class="code" href="../../de/d45/structnetwork.html#a05014921b926874b8a362aa83d98283a">c</a>, gen.<a class="code" href="../../df/dea/structdata.html#a1f37ae26b26b12ef5c70a12957826e87">X</a>.<a class="code" href="../../dd/d7b/structmatrix.html#ac06cdc346e87ea5cb4e4ae1a9b91d61f">vals</a>[0]);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <a class="code" href="../../de/d68/structimage.html">image</a> im2 = <a class="code" href="../../d3/d10/image_8c.html#a30912fff1b55bfe3f46db0dcf74f6024">float_to_image</a>(anet.<a class="code" href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">w</a>, anet.<a class="code" href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">h</a>, anet.<a class="code" href="../../de/d45/structnetwork.html#a05014921b926874b8a362aa83d98283a">c</a>, train.<a class="code" href="../../df/dea/structdata.html#a1f37ae26b26b12ef5c70a12957826e87">X</a>.<a class="code" href="../../dd/d7b/structmatrix.html#ac06cdc346e87ea5cb4e4ae1a9b91d61f">vals</a>[0]);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <a class="code" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70">show_image</a>(im, <span class="stringliteral">&quot;gen&quot;</span>);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <a class="code" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70">show_image</a>(im2, <span class="stringliteral">&quot;train&quot;</span>);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            cvWaitKey(50);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">        if(aloss &lt; .1){</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">            anet.learning_rate = 0;</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">        } else if (aloss &gt; .3){</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">            anet.learning_rate = orig_rate;</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">        }</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        update_network_gpu(gnet);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <a class="code" href="../../de/da9/data_8c.html#a4b0ce36f011ddb4b2ba58f58114d3219">free_data</a>(merge);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <a class="code" href="../../de/da9/data_8c.html#a4b0ce36f011ddb4b2ba58f58114d3219">free_data</a>(train);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <a class="code" href="../../de/da9/data_8c.html#a4b0ce36f011ddb4b2ba58f58114d3219">free_data</a>(gen);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">if</span> (aloss_avg &lt; 0) aloss_avg = aloss;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        aloss_avg = aloss_avg*.9 + aloss*.1;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        printf(<span class="stringliteral">&quot;%d: adv: %f | adv_avg: %f, %f rate, %lf seconds, %d images\n&quot;</span>, i, aloss, aloss_avg, <a class="code" href="../../d6/d6e/network_8c.html#ac997daf700149608de15d93a083c33dc">get_current_rate</a>(gnet), <a class="code" href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e">sec</a>(clock()-time), i*imgs);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordflow">if</span>(i%10000==0){</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="keywordtype">char</span> buff[256];</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            sprintf(buff, <span class="stringliteral">&quot;%s/%s_%d.weights&quot;</span>, backup_directory, base, i);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <a class="code" href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10">save_weights</a>(gnet, buff);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            sprintf(buff, <span class="stringliteral">&quot;%s/%s_%d.weights&quot;</span>, backup_directory, abase, i);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <a class="code" href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10">save_weights</a>(anet, buff);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="keywordflow">if</span>(i%1000==0){</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="keywordtype">char</span> buff[256];</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            sprintf(buff, <span class="stringliteral">&quot;%s/%s.backup&quot;</span>, backup_directory, base);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <a class="code" href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10">save_weights</a>(gnet, buff);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            sprintf(buff, <span class="stringliteral">&quot;%s/%s.backup&quot;</span>, backup_directory, abase);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <a class="code" href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10">save_weights</a>(anet, buff);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordtype">char</span> buff[256];</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    sprintf(buff, <span class="stringliteral">&quot;%s/%s_final.weights&quot;</span>, backup_directory, base);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10">save_weights</a>(gnet, buff);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;}</div><div class="ttc" id="structnetwork_html_ad1b060aa7e1bfd54e25448f1783733d6"><div class="ttname"><a href="../../de/d45/structnetwork.html#ad1b060aa7e1bfd54e25448f1783733d6">network::seen</a></div><div class="ttdeci">int * seen</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00017">network.h:17</a></div></div>
<div class="ttc" id="structnetwork_html_a9afd53b100d35dc162e48118ef4f7eea"><div class="ttname"><a href="../../de/d45/structnetwork.html#a9afd53b100d35dc162e48118ef4f7eea">network::decay</a></div><div class="ttdeci">float decay</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00021">network.h:21</a></div></div>
<div class="ttc" id="structload__args_html_aadcafc7eb67b2a86a1a7a6ff2ab80a94"><div class="ttname"><a href="../../d1/d09/structload__args.html#aadcafc7eb67b2a86a1a7a6ff2ab80a94">load_args::paths</a></div><div class="ttdeci">char ** paths</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00036">data.h:36</a></div></div>
<div class="ttc" id="structnetwork_html_a04f448f3f8c3f1314e2b23b429bec827"><div class="ttname"><a href="../../de/d45/structnetwork.html#a04f448f3f8c3f1314e2b23b429bec827">network::batch</a></div><div class="ttdeci">int batch</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00016">network.h:16</a></div></div>
<div class="ttc" id="list_8c_html_a29e21d306ccd944370665f439d7ca37d"><div class="ttname"><a href="../../d7/d40/list_8c.html#a29e21d306ccd944370665f439d7ca37d">list_to_array</a></div><div class="ttdeci">void ** list_to_array(list *l)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/list_8c_source.html#l00082">list.c:82</a></div></div>
<div class="ttc" id="structnetwork_html_a978d3e339536cd6bea2270d49d93c35a"><div class="ttname"><a href="../../de/d45/structnetwork.html#a978d3e339536cd6bea2270d49d93c35a">network::learning_rate</a></div><div class="ttdeci">float learning_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00026">network.h:26</a></div></div>
<div class="ttc" id="structnetwork_html_a495c60ef821ca0ade1c42907c8bc90bf"><div class="ttname"><a href="../../de/d45/structnetwork.html#a495c60ef821ca0ade1c42907c8bc90bf">network::momentum</a></div><div class="ttdeci">float momentum</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00020">network.h:20</a></div></div>
<div class="ttc" id="structnetwork_html_a1453c2cf9a735bde55a281d698797a05"><div class="ttname"><a href="../../de/d45/structnetwork.html#a1453c2cf9a735bde55a281d698797a05">network::truth</a></div><div class="ttdeci">float * truth</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00063">network.h:63</a></div></div>
<div class="ttc" id="structlist_html_a3b03adad0c0429bae9493667ff366dc2"><div class="ttname"><a href="../../d8/d10/structlist.html#a3b03adad0c0429bae9493667ff366dc2">list::size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d23/list_8h_source.html#l00011">list.h:11</a></div></div>
<div class="ttc" id="data_8c_html_a338d58d41be3703ef4ce443e5bb4e52f"><div class="ttname"><a href="../../de/da9/data_8c.html#a338d58d41be3703ef4ce443e5bb4e52f">get_next_batch</a></div><div class="ttdeci">void get_next_batch(data d, int n, int offset, float *X, float *y)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l01019">data.c:1019</a></div></div>
<div class="ttc" id="structimage_html"><div class="ttname"><a href="../../de/d68/structimage.html">image</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db2/image_8h_source.html#l00022">image.h:22</a></div></div>
<div class="ttc" id="structload__args_html_a281729b932cef85bb4e2a88e1133518d"><div class="ttname"><a href="../../d1/d09/structload__args.html#a281729b932cef85bb4e2a88e1133518d">load_args::type</a></div><div class="ttdeci">data_type type</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00062">data.h:62</a></div></div>
<div class="ttc" id="data_8h_html_ac2ad7f431e3446fddcd9b6b9f93c4c14a6e94b1b980ce6cf0203483eaea660b08"><div class="ttname"><a href="../../d2/dbd/data_8h.html#ac2ad7f431e3446fddcd9b6b9f93c4c14a6e94b1b980ce6cf0203483eaea660b08">CLASSIFICATION_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00031">data.h:31</a></div></div>
<div class="ttc" id="data_8c_html_aa9c8a2657c930195dd492ed99a7a0bb2"><div class="ttname"><a href="../../de/da9/data_8c.html#aa9c8a2657c930195dd492ed99a7a0bb2">concat_data</a></div><div class="ttdeci">data concat_data(data d1, data d2)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l00944">data.c:944</a></div></div>
<div class="ttc" id="structlayer_html_a298d150dabc449824204579f4851b926"><div class="ttname"><a href="../../d4/db8/structlayer.html#a298d150dabc449824204579f4851b926">layer::out_c</a></div><div class="ttdeci">int out_c</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00067">layer.h:67</a></div></div>
<div class="ttc" id="utils_8c_html_afe996fdc7e45995e94f02d55845e163b"><div class="ttname"><a href="../../d3/d91/utils_8c.html#afe996fdc7e45995e94f02d55845e163b">basecfg</a></div><div class="ttdeci">char * basecfg(char *cfgfile)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00139">utils.c:139</a></div></div>
<div class="ttc" id="structnetwork_html_a163b931990a5ac8f456884405de2192b"><div class="ttname"><a href="../../de/d45/structnetwork.html#a163b931990a5ac8f456884405de2192b">network::max_batches</a></div><div class="ttdeci">int max_batches</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00032">network.h:32</a></div></div>
<div class="ttc" id="structnetwork_html"><div class="ttname"><a href="../../de/d45/structnetwork.html">network</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00014">network.h:14</a></div></div>
<div class="ttc" id="structload__args_html_a3f6b3f3ef9406ab124550bc8166f2dcd"><div class="ttname"><a href="../../d1/d09/structload__args.html#a3f6b3f3ef9406ab124550bc8166f2dcd">load_args::threads</a></div><div class="ttdeci">int threads</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00035">data.h:35</a></div></div>
<div class="ttc" id="structload__args_html_aca89fa6ea8f11383062a905539477001"><div class="ttname"><a href="../../d1/d09/structload__args.html#aca89fa6ea8f11383062a905539477001">load_args::m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00039">data.h:39</a></div></div>
<div class="ttc" id="structnetwork_html_a9770423f88b722bafc9d1fd3c6091d75"><div class="ttname"><a href="../../de/d45/structnetwork.html#a9770423f88b722bafc9d1fd3c6091d75">network::layers</a></div><div class="ttdeci">layer * layers</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00022">network.h:22</a></div></div>
<div class="ttc" id="structnetwork_html_a32e7b55fe8dfa07391b6cdce17b4a2c1"><div class="ttname"><a href="../../de/d45/structnetwork.html#a32e7b55fe8dfa07391b6cdce17b4a2c1">network::train</a></div><div class="ttdeci">int train</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00066">network.h:66</a></div></div>
<div class="ttc" id="structload__args_html_a0b1c4f762d67a0f0cbcc1241cfa5463d"><div class="ttname"><a href="../../d1/d09/structload__args.html#a0b1c4f762d67a0f0cbcc1241cfa5463d">load_args::d</a></div><div class="ttdeci">data * d</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00059">data.h:59</a></div></div>
<div class="ttc" id="structnetwork_html_ac80b4b4eeda5cf4cc4af5c2173d0ad31"><div class="ttname"><a href="../../de/d45/structnetwork.html#ac80b4b4eeda5cf4cc4af5c2173d0ad31">network::cost</a></div><div class="ttdeci">float * cost</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00068">network.h:68</a></div></div>
<div class="ttc" id="structnetwork_html_ab30643da07e0f787ee0cd2058cd41a6e"><div class="ttname"><a href="../../de/d45/structnetwork.html#ab30643da07e0f787ee0cd2058cd41a6e">network::subdivisions</a></div><div class="ttdeci">int subdivisions</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00019">network.h:19</a></div></div>
<div class="ttc" id="utils_8c_html_a375f4de29b8973c3e1b63bf49a5eb00e"><div class="ttname"><a href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e">sec</a></div><div class="ttdeci">float sec(clock_t clocks)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00192">utils.c:192</a></div></div>
<div class="ttc" id="data_8c_html_a3c0e083ce3917bb394ca5708a52f34f5"><div class="ttname"><a href="../../de/da9/data_8c.html#a3c0e083ce3917bb394ca5708a52f34f5">get_paths</a></div><div class="ttdeci">list * get_paths(char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l00012">data.c:12</a></div></div>
<div class="ttc" id="structload__args_html_af12ce52f9bf54ea7985cb0e9b9dfaf55"><div class="ttname"><a href="../../d1/d09/structload__args.html#af12ce52f9bf54ea7985cb0e9b9dfaf55">load_args::classes</a></div><div class="ttdeci">int classes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00049">data.h:49</a></div></div>
<div class="ttc" id="structlayer_html_aff6bd99e74d13cccca4c492dd3e8de9c"><div class="ttname"><a href="../../d4/db8/structlayer.html#aff6bd99e74d13cccca4c492dd3e8de9c">layer::batch</a></div><div class="ttdeci">int batch</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00057">layer.h:57</a></div></div>
<div class="ttc" id="network_8c_html_ac997daf700149608de15d93a083c33dc"><div class="ttname"><a href="../../d6/d6e/network_8c.html#ac997daf700149608de15d93a083c33dc">get_current_rate</a></div><div class="ttdeci">float get_current_rate(network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00078">network.c:78</a></div></div>
<div class="ttc" id="data_8c_html_aa1204f7048d4034131fcb700809087e4"><div class="ttname"><a href="../../de/da9/data_8c.html#aa1204f7048d4034131fcb700809087e4">copy_data</a></div><div class="ttdeci">data copy_data(data d)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l01152">data.c:1152</a></div></div>
<div class="ttc" id="network_8c_html_a95734b6e69a080abf33395707ab56b59"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a95734b6e69a080abf33395707ab56b59">get_current_batch</a></div><div class="ttdeci">int get_current_batch(network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00061">network.c:61</a></div></div>
<div class="ttc" id="structload__args_html_a46de5db87a3c8c05130d5b23a2cdea2f"><div class="ttname"><a href="../../d1/d09/structload__args.html#a46de5db87a3c8c05130d5b23a2cdea2f">load_args::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00038">data.h:38</a></div></div>
<div class="ttc" id="data_8c_html_ab5f0db527025988c7478eddea9d97141"><div class="ttname"><a href="../../de/da9/data_8c.html#ab5f0db527025988c7478eddea9d97141">load_thread</a></div><div class="ttdeci">void * load_thread(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l00737">data.c:737</a></div></div>
<div class="ttc" id="structnetwork_html_a794927f8c4d44cd8e85ff39e0d4c9939"><div class="ttname"><a href="../../de/d45/structnetwork.html#a794927f8c4d44cd8e85ff39e0d4c9939">network::truths</a></div><div class="ttdeci">int truths</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00045">network.h:45</a></div></div>
<div class="ttc" id="image_8c_html_a30912fff1b55bfe3f46db0dcf74f6024"><div class="ttname"><a href="../../d3/d10/image_8c.html#a30912fff1b55bfe3f46db0dcf74f6024">float_to_image</a></div><div class="ttdeci">image float_to_image(int w, int h, int c, float *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00654">image.c:654</a></div></div>
<div class="ttc" id="structlist_html"><div class="ttname"><a href="../../d8/d10/structlist.html">list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d23/list_8h_source.html#l00010">list.h:10</a></div></div>
<div class="ttc" id="network_8c_html_a83fdde9a3ff298cf8066a781319a6ec1"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a83fdde9a3ff298cf8066a781319a6ec1">get_base_args</a></div><div class="ttdeci">load_args get_base_args(network net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00033">network.c:33</a></div></div>
<div class="ttc" id="structload__args_html_a66b04c5770c0b451fa14a4a87258be9d"><div class="ttname"><a href="../../d1/d09/structload__args.html#a66b04c5770c0b451fa14a4a87258be9d">load_args::labels</a></div><div class="ttdeci">char ** labels</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00040">data.h:40</a></div></div>
<div class="ttc" id="structdata_html_a1f37ae26b26b12ef5c70a12957826e87"><div class="ttname"><a href="../../df/dea/structdata.html#a1f37ae26b26b12ef5c70a12957826e87">data::X</a></div><div class="ttdeci">matrix X</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00023">data.h:23</a></div></div>
<div class="ttc" id="image_8c_html_a5807da5b9392f853749db3e7c727bd70"><div class="ttname"><a href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70">show_image</a></div><div class="ttdeci">void show_image(image p, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d10/image_8c_source.html#l00459">image.c:459</a></div></div>
<div class="ttc" id="parser_8c_html_a4efdf053d8e310ad956ce80519201a10"><div class="ttname"><a href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10">save_weights</a></div><div class="ttdeci">void save_weights(network net, char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d72/parser_8c_source.html#l00929">parser.c:929</a></div></div>
<div class="ttc" id="utils_8c_html_a5b5b0c77bb2f450bce70777573f7ca90"><div class="ttname"><a href="../../d3/d91/utils_8c.html#a5b5b0c77bb2f450bce70777573f7ca90">rand_normal</a></div><div class="ttdeci">float rand_normal()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d91/utils_8c_source.html#l00576">utils.c:576</a></div></div>
<div class="ttc" id="data_8c_html_a887edef560c1d5fe3f395f02c0a00612"><div class="ttname"><a href="../../de/da9/data_8c.html#a887edef560c1d5fe3f395f02c0a00612">load_data_in_thread</a></div><div class="ttdeci">pthread_t load_data_in_thread(load_args args)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l00776">data.c:776</a></div></div>
<div class="ttc" id="structnetwork_html_a05014921b926874b8a362aa83d98283a"><div class="ttname"><a href="../../de/d45/structnetwork.html#a05014921b926874b8a362aa83d98283a">network::c</a></div><div class="ttdeci">int c</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00047">network.h:47</a></div></div>
<div class="ttc" id="network_8c_html_aa06b8ad6a6fb64daed0801ad5d4009a2"><div class="ttname"><a href="../../d6/d6e/network_8c.html#aa06b8ad6a6fb64daed0801ad5d4009a2">load_network</a></div><div class="ttdeci">network load_network(char *cfg, char *weights, int clear)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00051">network.c:51</a></div></div>
<div class="ttc" id="structnetwork_html_a5268de11127a02d86e6f517cf3b3acc9"><div class="ttname"><a href="../../de/d45/structnetwork.html#a5268de11127a02d86e6f517cf3b3acc9">network::outputs</a></div><div class="ttdeci">int outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00044">network.h:44</a></div></div>
<div class="ttc" id="structnetwork_html_a8f391155a3ceb60caf07d0ee6c6a93f2"><div class="ttname"><a href="../../de/d45/structnetwork.html#a8f391155a3ceb60caf07d0ee6c6a93f2">network::input</a></div><div class="ttdeci">float * input</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00062">network.h:62</a></div></div>
<div class="ttc" id="structmatrix_html_ac06cdc346e87ea5cb4e4ae1a9b91d61f"><div class="ttname"><a href="../../dd/d7b/structmatrix.html#ac06cdc346e87ea5cb4e4ae1a9b91d61f">matrix::vals</a></div><div class="ttdeci">float ** vals</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df4/matrix_8h_source.html#l00005">matrix.h:5</a></div></div>
<div class="ttc" id="blas_8c_html_a22f6b03dd54e2d4b249e53a0ca14434c"><div class="ttname"><a href="../../dc/d50/blas_8c.html#a22f6b03dd54e2d4b249e53a0ca14434c">copy_cpu</a></div><div class="ttdeci">void copy_cpu(int N, float *X, int INCX, float *Y, int INCY)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/blas_8c_source.html#l00164">blas.c:164</a></div></div>
<div class="ttc" id="structnetwork_html_a0e57f4230f8ecb07bba0c97cf8f045c7"><div class="ttname"><a href="../../de/d45/structnetwork.html#a0e57f4230f8ecb07bba0c97cf8f045c7">network::h</a></div><div class="ttdeci">int h</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00047">network.h:47</a></div></div>
<div class="ttc" id="structload__args_html"><div class="ttname"><a href="../../d1/d09/structload__args.html">load_args</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00034">data.h:34</a></div></div>
<div class="ttc" id="structnetwork_html_a1c7625720955322d05924a075d013877"><div class="ttname"><a href="../../de/d45/structnetwork.html#a1c7625720955322d05924a075d013877">network::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00015">network.h:15</a></div></div>
<div class="ttc" id="structnetwork_html_a274dce0db2d5175992eb3b273ab09df7"><div class="ttname"><a href="../../de/d45/structnetwork.html#a274dce0db2d5175992eb3b273ab09df7">network::output</a></div><div class="ttdeci">float * output</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00023">network.h:23</a></div></div>
<div class="ttc" id="structlayer_html_a0874fab782ae0e8f1075cc99d776478b"><div class="ttname"><a href="../../d4/db8/structlayer.html#a0874fab782ae0e8f1075cc99d776478b">layer::outputs</a></div><div class="ttdeci">int outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00061">layer.h:61</a></div></div>
<div class="ttc" id="data_8c_html_a4b0ce36f011ddb4b2ba58f58114d3219"><div class="ttname"><a href="../../de/da9/data_8c.html#a4b0ce36f011ddb4b2ba58f58114d3219">free_data</a></div><div class="ttdeci">void free_data(data d)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da9/data_8c_source.html#l00503">data.c:503</a></div></div>
<div class="ttc" id="structnetwork_html_a944b83cb20da2454c6092e07b9a1d3e9"><div class="ttname"><a href="../../de/d45/structnetwork.html#a944b83cb20da2454c6092e07b9a1d3e9">network::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00047">network.h:47</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="../../df/dea/structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00021">data.h:21</a></div></div>
<div class="ttc" id="network_8c_html_aeb752f771f5cfe8c401fc8dee8f3e439"><div class="ttname"><a href="../../d6/d6e/network_8c.html#aeb752f771f5cfe8c401fc8dee8f3e439">train_network</a></div><div class="ttdeci">float train_network(network net, data d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00269">network.c:269</a></div></div>
<div class="ttc" id="structnetwork_html_a529a36505548232d049abcb84fdcf389"><div class="ttname"><a href="../../de/d45/structnetwork.html#a529a36505548232d049abcb84fdcf389">network::inputs</a></div><div class="ttdeci">int inputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00043">network.h:43</a></div></div>
<div class="ttc" id="structlayer_html"><div class="ttname"><a href="../../d4/db8/structlayer.html">layer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3b/layer_8h_source.html#l00045">layer.h:45</a></div></div>
<div class="ttc" id="structdata_html_a30946bde3a05e40df6fbb49c5dd9b627"><div class="ttname"><a href="../../df/dea/structdata.html#a30946bde3a05e40df6fbb49c5dd9b627">data::y</a></div><div class="ttdeci">matrix y</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/data_8h_source.html#l00024">data.h:24</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/lsd_8c_a13f25021852f255bb81359944d2e1a24_cgraph.png" border="0" usemap="#d2/da6/lsd_8c_a13f25021852f255bb81359944d2e1a24_cgraph" alt=""/></div>
<map name="d2/da6/lsd_8c_a13f25021852f255bb81359944d2e1a24_cgraph" id="d2/da6/lsd_8c_a13f25021852f255bb81359944d2e1a24_cgraph">
<area shape="rect" id="node2" href="../../d3/d91/utils_8c.html#afe996fdc7e45995e94f02d55845e163b" title="basecfg" alt="" coords="182,5,250,31"/>
<area shape="rect" id="node4" href="../../de/da9/data_8c.html#aa9c8a2657c930195dd492ed99a7a0bb2" title="concat_data" alt="" coords="169,55,263,80"/>
<area shape="rect" id="node6" href="../../dc/d50/blas_8c.html#a22f6b03dd54e2d4b249e53a0ca14434c" title="copy_cpu" alt="" coords="560,131,639,156"/>
<area shape="rect" id="node7" href="../../de/da9/data_8c.html#aa1204f7048d4034131fcb700809087e4" title="copy_data" alt="" coords="174,156,257,181"/>
<area shape="rect" id="node9" href="../../d3/d10/image_8c.html#a30912fff1b55bfe3f46db0dcf74f6024" title="float_to_image" alt="" coords="161,205,270,231"/>
<area shape="rect" id="node11" href="../../de/da9/data_8c.html#a4b0ce36f011ddb4b2ba58f58114d3219" title="free_data" alt="" coords="177,304,255,329"/>
<area shape="rect" id="node13" href="../../d6/d6e/network_8c.html#a83fdde9a3ff298cf8066a781319a6ec1" title="get_base_args" alt="" coords="161,353,271,379"/>
<area shape="rect" id="node14" href="../../d6/d6e/network_8c.html#a95734b6e69a080abf33395707ab56b59" title="get_current_batch" alt="" coords="342,403,470,428"/>
<area shape="rect" id="node15" href="../../d6/d6e/network_8c.html#ac997daf700149608de15d93a083c33dc" title="get_current_rate" alt="" coords="156,455,275,480"/>
<area shape="rect" id="node17" href="../../de/da9/data_8c.html#a338d58d41be3703ef4ce443e5bb4e52f" title="get_next_batch" alt="" coords="350,705,462,731"/>
<area shape="rect" id="node18" href="../../de/da9/data_8c.html#a3c0e083ce3917bb394ca5708a52f34f5" title="get_paths" alt="" coords="176,756,256,781"/>
<area shape="rect" id="node23" href="../../d7/d40/list_8c.html#a29e21d306ccd944370665f439d7ca37d" title="list_to_array" alt="" coords="169,855,263,880"/>
<area shape="rect" id="node24" href="../../de/da9/data_8c.html#a887edef560c1d5fe3f395f02c0a00612" title="load_data_in_thread" alt="" coords="144,556,287,581"/>
<area shape="rect" id="node26" href="../../de/da9/data_8c.html#ab5f0db527025988c7478eddea9d97141" title="load_thread" alt="" coords="360,505,452,531"/>
<area shape="rect" id="node40" href="../../d6/d6e/network_8c.html#aa06b8ad6a6fb64daed0801ad5d4009a2" title="load_network" alt="" coords="165,605,266,631"/>
<area shape="rect" id="node43" href="../../d3/d91/utils_8c.html#a5b5b0c77bb2f450bce70777573f7ca90" title="rand_normal" alt="" coords="168,904,264,929"/>
<area shape="rect" id="node44" href="../../d2/d72/parser_8c.html#a4efdf053d8e310ad956ce80519201a10" title="save_weights" alt="" coords="165,805,267,831"/>
<area shape="rect" id="node46" href="../../d3/d91/utils_8c.html#a375f4de29b8973c3e1b63bf49a5eb00e" title="sec" alt="" coords="195,953,237,979"/>
<area shape="rect" id="node47" href="../../d3/d10/image_8c.html#a5807da5b9392f853749db3e7c727bd70" title="show_image" alt="" coords="168,255,264,280"/>
<area shape="rect" id="node50" href="../../d6/d6e/network_8c.html#aeb752f771f5cfe8c401fc8dee8f3e439" title="train_network" alt="" coords="165,707,266,732"/>
<area shape="rect" id="node3" href="../../d3/d91/utils_8c.html#a4d27da4f6ddad5146c9190badd121a39" title="copy_string" alt="" coords="361,5,451,31"/>
<area shape="rect" id="node5" href="../../de/da9/data_8c.html#a3aa1345254255bef02986f36729547ce" title="concat_matrix" alt="" coords="354,55,458,80"/>
<area shape="rect" id="node8" href="../../dc/dca/matrix_8c.html#a740942b240172fa3517b229f2e471bd2" title="copy_matrix" alt="" coords="359,156,453,181"/>
<area shape="rect" id="node10" href="../../d3/d10/image_8c.html#a28bb9f835989b2f7e908386421c52837" title="make_empty_image" alt="" coords="335,205,477,231"/>
<area shape="rect" id="node12" href="../../dc/dca/matrix_8c.html#ab8962ce6e94daf63d29a9ba6decf6e1e" title="free_matrix" alt="" coords="362,353,450,379"/>
<area shape="rect" id="node16" href="../../d3/d91/utils_8c.html#a5492196e16ed2d16bae1df8483ef79ed" title="rand_uniform" alt="" coords="736,281,835,307"/>
<area shape="rect" id="node19" href="../../d3/d91/utils_8c.html#a153eabd234972b240608df09cc4975d3" title="fgetl" alt="" coords="383,755,429,780"/>
<area shape="rect" id="node20" href="../../d3/d91/utils_8c.html#aecaee51f837bcfd8316ab68164620819" title="file_error" alt="" coords="562,953,636,979"/>
<area shape="rect" id="node21" href="../../d7/d40/list_8c.html#a4b177e1b5244311b3b9f5276c7f39946" title="list_insert" alt="" coords="367,856,445,881"/>
<area shape="rect" id="node22" href="../../d7/d40/list_8c.html#a2e7ac341a0adc4e02a760a9807ba7db0" title="make_list" alt="" coords="367,905,445,931"/>
<area shape="rect" id="node25" href="../../d3/d91/utils_8c.html#a6c317cffefb9737fb2260da73688f275" title="error" alt="" coords="575,903,624,928"/>
<area shape="rect" id="node27" href="../../d3/d10/image_8c.html#a24b1468a82ce3e5fe9f912bda5507d87" title="letterbox_image" alt="" coords="541,555,658,580"/>
<area shape="rect" id="node28" href="../../d3/d10/image_8c.html#a583d43a007a97bb92fcbac12b8394c72" title="resize_image" alt="" coords="735,505,836,531"/>
<area shape="rect" id="node29" href="../../de/da9/data_8c.html#a43b17bfc80111f0e9a22b5748e8db3e6" title="load_data_augment" alt="" coords="530,656,669,681"/>
<area shape="rect" id="node30" href="../../de/da9/data_8c.html#ab9d8ce6e878b53b6f7c786c1b297e695" title="load_data_compare" alt="" coords="530,355,669,380"/>
<area shape="rect" id="node31" href="../../d3/d10/image_8c.html#a233b57091bac94f82d8aa0d8a5c1f070" title="load_image_color" alt="" coords="722,380,849,405"/>
<area shape="rect" id="node32" href="../../de/da9/data_8c.html#acbd80b4bb77de421ce8f0715f6d2a80a" title="load_data_detection" alt="" coords="529,256,670,281"/>
<area shape="rect" id="node33" href="../../de/da9/data_8c.html#a2d65bb024ba143cf988a3c4b5494a90e" title="load_data_old" alt="" coords="547,705,652,731"/>
<area shape="rect" id="node34" href="../../de/da9/data_8c.html#ab7e1e67d61f872591c5123f9caf396d6" title="load_data_region" alt="" coords="537,305,662,331"/>
<area shape="rect" id="node35" href="../../de/da9/data_8c.html#a3d031c19fccc2c31ec202bbeda1615c3" title="load_data_regression" alt="" coords="525,755,674,780"/>
<area shape="rect" id="node36" href="../../de/da9/data_8c.html#a3994c72c392eae1b1c405d439de76e22" title="load_data_super" alt="" coords="539,505,660,531"/>
<area shape="rect" id="node37" href="../../de/da9/data_8c.html#a89013987873d2ee74fd382c674335fd5" title="load_data_swag" alt="" coords="540,456,659,481"/>
<area shape="rect" id="node38" href="../../de/da9/data_8c.html#a041e51bae1bacd4e84338849783e7d72" title="load_data_tag" alt="" coords="547,804,652,829"/>
<area shape="rect" id="node39" href="../../de/da9/data_8c.html#afe091cc7ae2ab63ee2a2d6e8d89202f8" title="load_data_writing" alt="" coords="537,853,662,879"/>
<area shape="rect" id="node41" href="../../d2/d72/parser_8c.html#abb6f2aa1c5d5bf340faae09be6538c56" title="parse_network_cfg" alt="" coords="339,607,473,632"/>
<area shape="rect" id="node42" href="../../d2/d72/parser_8c.html#a60957f4d236ea8e417999b1778ec3d55" title="load_weights" alt="" coords="356,656,456,681"/>
<area shape="rect" id="node45" href="../../d2/d72/parser_8c.html#a6ee95b0b2c847e3bb0480a5a657665a3" title="save_weights_upto" alt="" coords="338,955,474,980"/>
<area shape="rect" id="node48" href="../../d3/d10/image_8c.html#ae8ec59e2e5d3166e688d80a0e2869e80" title="constrain_image" alt="" coords="346,255,466,280"/>
<area shape="rect" id="node49" href="../../d3/d10/image_8c.html#a26b84c1b61a038d1a010b8495eaa2a6d" title="copy_image" alt="" coords="359,304,453,329"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/lsd_8c_a13f25021852f255bb81359944d2e1a24_icgraph.png" border="0" usemap="#d2/da6/lsd_8c_a13f25021852f255bb81359944d2e1a24_icgraph" alt=""/></div>
<map name="d2/da6/lsd_8c_a13f25021852f255bb81359944d2e1a24_icgraph" id="d2/da6/lsd_8c_a13f25021852f255bb81359944d2e1a24_icgraph">
<area shape="rect" id="node2" href="../../d2/da6/lsd_8c.html#ab48437873371bf1e3ff2b7714109f178" title="run_lsd" alt="" coords="144,5,209,31"/>
<area shape="rect" id="node3" href="../../dd/df8/darknet_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="257,5,308,31"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat May 27 2017 01:13:33 for Darknet by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
